{"ast":null,"code":"/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nimport dialog from '../modules/dialog';\nimport anchor from '../modules/_anchor';\nimport component from '../modules/component';\nimport resizing from '../modules/resizing';\nimport fileManager from '../modules/fileManager';\nexport default {\n  name: 'image',\n  display: 'dialog',\n  add: function (core) {\n    core.addModule([dialog, anchor, component, resizing, fileManager]);\n    const options = core.options;\n    const context = core.context;\n    const contextImage = context.image = {\n      _infoList: [],\n      // @Override fileManager\n      _infoIndex: 0,\n      // @Override fileManager\n      _uploadFileLength: 0,\n      // @Override fileManager\n      focusElement: null,\n      // @Override dialog // This element has focus when the dialog is opened.\n      sizeUnit: options._imageSizeUnit,\n      _linkElement: '',\n      _altText: '',\n      _align: 'none',\n      _floatClassRegExp: '__se__float\\\\-[a-z]+',\n      _v_src: {\n        _linkValue: ''\n      },\n      svgDefaultSize: '30%',\n      base64RenderIndex: 0,\n      // @require @Override component\n      _element: null,\n      _cover: null,\n      _container: null,\n      // @Override resizing properties\n      inputX: null,\n      inputY: null,\n      _element_w: 1,\n      _element_h: 1,\n      _element_l: 0,\n      _element_t: 0,\n      _defaultSizeX: 'auto',\n      _defaultSizeY: 'auto',\n      _origin_w: options.imageWidth === 'auto' ? '' : options.imageWidth,\n      _origin_h: options.imageHeight === 'auto' ? '' : options.imageHeight,\n      _proportionChecked: true,\n      _resizing: options.imageResizing,\n      _resizeDotHide: !options.imageHeightShow,\n      _rotation: options.imageRotation,\n      _alignHide: !options.imageAlignShow,\n      _onlyPercentage: options.imageSizeOnlyPercentage,\n      _ratio: false,\n      _ratioX: 1,\n      _ratioY: 1,\n      _captionShow: true,\n      _captionChecked: false,\n      _caption: null,\n      captionCheckEl: null\n    };\n\n    /** image dialog */\n    let image_dialog = this.setDialog(core);\n    contextImage.modal = image_dialog;\n    contextImage.imgInputFile = image_dialog.querySelector('._se_image_file');\n    contextImage.imgUrlFile = image_dialog.querySelector('._se_image_url');\n    contextImage.focusElement = contextImage.imgInputFile || contextImage.imgUrlFile;\n    contextImage.altText = image_dialog.querySelector('._se_image_alt');\n    contextImage.captionCheckEl = image_dialog.querySelector('._se_image_check_caption');\n    contextImage.previewSrc = image_dialog.querySelector('._se_tab_content_image .se-link-preview');\n\n    /** add event listeners */\n    image_dialog.querySelector('.se-dialog-tabs').addEventListener('click', this.openTab.bind(core));\n    image_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core));\n    if (contextImage.imgInputFile) image_dialog.querySelector('.se-file-remove').addEventListener('click', this._removeSelectedFiles.bind(contextImage.imgInputFile, contextImage.imgUrlFile, contextImage.previewSrc));\n    if (contextImage.imgUrlFile) contextImage.imgUrlFile.addEventListener('input', this._onLinkPreview.bind(contextImage.previewSrc, contextImage._v_src, options.linkProtocol));\n    if (contextImage.imgInputFile && contextImage.imgUrlFile) contextImage.imgInputFile.addEventListener('change', this._fileInputChange.bind(contextImage));\n    const imageGalleryButton = image_dialog.querySelector('.__se__gallery');\n    if (imageGalleryButton) imageGalleryButton.addEventListener('click', this._openGallery.bind(core));\n    contextImage.proportion = {};\n    contextImage.inputX = {};\n    contextImage.inputY = {};\n    if (options.imageResizing) {\n      contextImage.proportion = image_dialog.querySelector('._se_image_check_proportion');\n      contextImage.inputX = image_dialog.querySelector('._se_image_size_x');\n      contextImage.inputY = image_dialog.querySelector('._se_image_size_y');\n      contextImage.inputX.value = options.imageWidth;\n      contextImage.inputY.value = options.imageHeight;\n      contextImage.inputX.addEventListener('keyup', this.setInputSize.bind(core, 'x'));\n      contextImage.inputY.addEventListener('keyup', this.setInputSize.bind(core, 'y'));\n      contextImage.inputX.addEventListener('change', this.setRatio.bind(core));\n      contextImage.inputY.addEventListener('change', this.setRatio.bind(core));\n      contextImage.proportion.addEventListener('change', this.setRatio.bind(core));\n      image_dialog.querySelector('.se-dialog-btn-revert').addEventListener('click', this.sizeRevert.bind(core));\n    }\n\n    /** append html */\n    context.dialog.modal.appendChild(image_dialog);\n\n    /** link event */\n    core.plugins.anchor.initEvent.call(core, 'image', image_dialog.querySelector('._se_tab_content_url'));\n    contextImage.anchorCtx = core.context.anchor.caller.image;\n\n    /** empty memory */\n    image_dialog = null;\n  },\n  /** dialog */\n  setDialog: function (core) {\n    const option = core.options;\n    const lang = core.lang;\n    const dialog = core.util.createElement('DIV');\n    dialog.className = 'se-dialog-content se-dialog-image';\n    dialog.style.display = 'none';\n    let html = '' + '<div class=\"se-dialog-header\">' + '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" class=\"close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' + core.icons.cancel + '</button>' + '<span class=\"se-modal-title\">' + lang.dialogBox.imageBox.title + '</span>' + '</div>' + '<div class=\"se-dialog-tabs\">' + '<button type=\"button\" class=\"_se_tab_link active\" data-tab-link=\"image\">' + lang.toolbar.image + '</button>' + '<button type=\"button\" class=\"_se_tab_link\" data-tab-link=\"url\">' + lang.toolbar.link + '</button>' + '</div>' + '<form method=\"post\" enctype=\"multipart/form-data\">' + '<div class=\"_se_tab_content _se_tab_content_image\">' + '<div class=\"se-dialog-body\"><div style=\"border-bottom: 1px dashed #ccc;\">';\n    if (option.imageFileInput) {\n      html += '' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.imageBox.file + '</label>' + '<div class=\"se-dialog-form-files\">' + '<input class=\"se-input-form _se_image_file\" type=\"file\" accept=\"' + option.imageAccept + '\"' + (option.imageMultipleFile ? ' multiple=\"multiple\"' : '') + '/>' + '<button type=\"button\" class=\"se-btn se-dialog-files-edge-button se-file-remove\" title=\"' + lang.controller.remove + '\" aria-label=\"' + lang.controller.remove + '\">' + core.icons.cancel + '</button>' + '</div>' + '</div>';\n    }\n    if (option.imageUrlInput) {\n      html += '' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.imageBox.url + '</label>' + '<div class=\"se-dialog-form-files\">' + '<input class=\"se-input-form se-input-url _se_image_url\" type=\"text\" />' + (option.imageGalleryUrl && core.plugins.imageGallery ? '<button type=\"button\" class=\"se-btn se-dialog-files-edge-button __se__gallery\" title=\"' + lang.toolbar.imageGallery + '\" aria-label=\"' + lang.toolbar.imageGallery + '\">' + core.icons.image_gallery + '</button>' : '') + '</div>' + '<pre class=\"se-link-preview\"></pre>' + '</div>';\n    }\n    html += '</div>' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.imageBox.altText + '</label><input class=\"se-input-form _se_image_alt\" type=\"text\" />' + '</div>';\n    if (option.imageResizing) {\n      const onlyPercentage = option.imageSizeOnlyPercentage;\n      const onlyPercentDisplay = onlyPercentage ? ' style=\"display: none !important;\"' : '';\n      const heightDisplay = !option.imageHeightShow ? ' style=\"display: none !important;\"' : '';\n      html += '<div class=\"se-dialog-form\">';\n      if (onlyPercentage || !option.imageHeightShow) {\n        html += '' + '<div class=\"se-dialog-size-text\">' + '<label class=\"size-w\">' + lang.dialogBox.size + '</label>' + '</div>';\n      } else {\n        html += '' + '<div class=\"se-dialog-size-text\">' + '<label class=\"size-w\">' + lang.dialogBox.width + '</label>' + '<label class=\"se-dialog-size-x\">&nbsp;</label>' + '<label class=\"size-h\">' + lang.dialogBox.height + '</label>' + '</div>';\n      }\n      html += '' + '<input class=\"se-input-control _se_image_size_x\" placeholder=\"auto\"' + (onlyPercentage ? ' type=\"number\" min=\"1\"' : 'type=\"text\"') + (onlyPercentage ? ' max=\"100\"' : '') + ' />' + '<label class=\"se-dialog-size-x\"' + heightDisplay + '>' + (onlyPercentage ? '%' : 'x') + '</label>' + '<input type=\"text\" class=\"se-input-control _se_image_size_y\" placeholder=\"auto\"' + onlyPercentDisplay + (onlyPercentage ? ' max=\"100\"' : '') + heightDisplay + '/>' + '<label' + onlyPercentDisplay + heightDisplay + '><input type=\"checkbox\" class=\"se-dialog-btn-check _se_image_check_proportion\" checked/>&nbsp;' + lang.dialogBox.proportion + '</label>' + '<button type=\"button\" title=\"' + lang.dialogBox.revertButton + '\" aria-label=\"' + lang.dialogBox.revertButton + '\" class=\"se-btn se-dialog-btn-revert\" style=\"float: right;\">' + core.icons.revert + '</button>' + '</div>';\n    }\n    html += '' + '<div class=\"se-dialog-form se-dialog-form-footer\">' + '<label><input type=\"checkbox\" class=\"se-dialog-btn-check _se_image_check_caption\" />&nbsp;' + lang.dialogBox.caption + '</label>' + '</div>' + '</div>' + '</div>' + '<div class=\"_se_tab_content _se_tab_content_url\" style=\"display: none\">' + core.context.anchor.forms.innerHTML + '</div>' + '<div class=\"se-dialog-footer\">' + '<div' + (option.imageAlignShow ? '' : ' style=\"display: none\"') + '>' + '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"none\" checked>' + lang.dialogBox.basic + '</label>' + '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"left\">' + lang.dialogBox.left + '</label>' + '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"center\">' + lang.dialogBox.center + '</label>' + '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"right\">' + lang.dialogBox.right + '</label>' + '</div>' + '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' + '</div>' + '</form>';\n    dialog.innerHTML = html;\n    return dialog;\n  },\n  _fileInputChange: function () {\n    if (!this.imgInputFile.value) {\n      this.imgUrlFile.removeAttribute('disabled');\n      this.previewSrc.style.textDecoration = '';\n    } else {\n      this.imgUrlFile.setAttribute('disabled', true);\n      this.previewSrc.style.textDecoration = 'line-through';\n    }\n  },\n  _removeSelectedFiles: function (urlInput, previewSrc) {\n    this.value = '';\n    if (urlInput) {\n      urlInput.removeAttribute('disabled');\n      previewSrc.style.textDecoration = '';\n    }\n  },\n  _openGallery: function () {\n    this.callPlugin('imageGallery', this.plugins.imageGallery.open.bind(this, this.plugins.image._setUrlInput.bind(this.context.image)), null);\n  },\n  _setUrlInput: function (target) {\n    this.altText.value = target.alt;\n    this._v_src._linkValue = this.previewSrc.textContent = this.imgUrlFile.value = target.src;\n    this.imgUrlFile.focus();\n  },\n  _onLinkPreview: function (context, protocol, e) {\n    const value = e.target.value.trim();\n    context._linkValue = this.textContent = !value ? '' : protocol && value.indexOf('://') === -1 && value.indexOf('#') !== 0 ? protocol + value : value.indexOf('://') === -1 ? '/' + value : value;\n  },\n  /**\n   * @Override @Required fileManager\n   */\n  fileTags: ['img'],\n  /**\n   * @Override core, fileManager, resizing\n   * @description It is called from core.selectComponent.\n   * @param {Element} element Target element\n   */\n  select: function (element) {\n    this.plugins.image.onModifyMode.call(this, element, this.plugins.resizing.call_controller_resize.call(this, element, 'image'));\n  },\n  /**\n   * @Override fileManager, resizing\n   */\n  destroy: function (element) {\n    const imageEl = element || this.context.image._element;\n    const imageContainer = this.util.getParentElement(imageEl, this.util.isMediaComponent) || imageEl;\n    const dataIndex = imageEl.getAttribute('data-index') * 1;\n    let focusEl = imageContainer.previousElementSibling || imageContainer.nextElementSibling;\n    const emptyDiv = imageContainer.parentNode;\n    this.util.removeItem(imageContainer);\n    this.plugins.image.init.call(this);\n    this.controllersOff();\n    if (emptyDiv !== this.context.element.wysiwyg) this.util.removeItemAllParents(emptyDiv, function (current) {\n      return current.childNodes.length === 0;\n    }, null);\n\n    // focus\n    this.focusEdge(focusEl);\n\n    // event\n    this.plugins.fileManager.deleteInfo.call(this, 'image', dataIndex, this.functions.onImageUpload);\n\n    // history stack\n    this.history.push(false);\n  },\n  /**\n   * @Required @Override dialog\n   */\n  on: function (update) {\n    const contextImage = this.context.image;\n    if (!update) {\n      contextImage.inputX.value = contextImage._origin_w = this.options.imageWidth === contextImage._defaultSizeX ? '' : this.options.imageWidth;\n      contextImage.inputY.value = contextImage._origin_h = this.options.imageHeight === contextImage._defaultSizeY ? '' : this.options.imageHeight;\n      if (contextImage.imgInputFile && this.options.imageMultipleFile) contextImage.imgInputFile.setAttribute('multiple', 'multiple');\n    } else {\n      if (contextImage.imgInputFile && this.options.imageMultipleFile) contextImage.imgInputFile.removeAttribute('multiple');\n    }\n    this.plugins.anchor.on.call(this, contextImage.anchorCtx, update);\n  },\n  /**\n   * @Required @Override dialog\n   */\n  open: function () {\n    this.plugins.dialog.open.call(this, 'image', 'image' === this.currentControllerName);\n  },\n  openTab: function (e) {\n    const modal = this.context.image.modal;\n    const targetElement = e === 'init' ? modal.querySelector('._se_tab_link') : e.target;\n    if (!/^BUTTON$/i.test(targetElement.tagName)) {\n      return false;\n    }\n\n    // Declare all variables\n    const tabName = targetElement.getAttribute('data-tab-link');\n    const contentClassName = '_se_tab_content';\n    let i, tabContent, tabLinks;\n\n    // Get all elements with class=\"tabcontent\" and hide them\n    tabContent = modal.getElementsByClassName(contentClassName);\n    for (i = 0; i < tabContent.length; i++) {\n      tabContent[i].style.display = 'none';\n    }\n\n    // Get all elements with class=\"tablinks\" and remove the class \"active\"\n    tabLinks = modal.getElementsByClassName('_se_tab_link');\n    for (i = 0; i < tabLinks.length; i++) {\n      this.util.removeClass(tabLinks[i], 'active');\n    }\n\n    // Show the current tab, and add an \"active\" class to the button that opened the tab\n    modal.querySelector('.' + contentClassName + '_' + tabName).style.display = 'block';\n    this.util.addClass(targetElement, 'active');\n\n    // focus\n    if (tabName === 'image' && this.context.image.focusElement) {\n      this.context.image.focusElement.focus();\n    } else if (tabName === 'url') {\n      this.context.anchor.caller.image.urlInput.focus();\n    }\n    return false;\n  },\n  submit: function (e) {\n    const contextImage = this.context.image;\n    const imagePlugin = this.plugins.image;\n    e.preventDefault();\n    e.stopPropagation();\n    contextImage._altText = contextImage.altText.value;\n    contextImage._align = contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"]:checked').value;\n    contextImage._captionChecked = contextImage.captionCheckEl.checked;\n    if (contextImage._resizing) contextImage._proportionChecked = contextImage.proportion.checked;\n    try {\n      if (this.context.dialog.updateModal) {\n        imagePlugin.update_image.call(this, false, true, false);\n      }\n      if (contextImage.imgInputFile && contextImage.imgInputFile.files.length > 0) {\n        this.showLoading();\n        imagePlugin.submitAction.call(this, this.context.image.imgInputFile.files);\n      } else if (contextImage.imgUrlFile && contextImage._v_src._linkValue.length > 0) {\n        this.showLoading();\n        imagePlugin.onRender_imgUrl.call(this, contextImage._v_src._linkValue);\n      }\n    } catch (error) {\n      this.closeLoading();\n      throw Error('[SUNEDITOR.image.submit.fail] cause : \"' + error.message + '\"');\n    } finally {\n      this.plugins.dialog.close.call(this);\n    }\n    return false;\n  },\n  submitAction: function (fileList) {\n    if (fileList.length === 0) return;\n    let fileSize = 0;\n    let files = [];\n    for (let i = 0, len = fileList.length; i < len; i++) {\n      if (/image/i.test(fileList[i].type)) {\n        files.push(fileList[i]);\n        fileSize += fileList[i].size;\n      }\n    }\n    const limitSize = this.options.imageUploadSizeLimit;\n    if (limitSize > 0) {\n      let infoSize = 0;\n      const imagesInfo = this.context.image._infoList;\n      for (let i = 0, len = imagesInfo.length; i < len; i++) {\n        infoSize += imagesInfo[i].size * 1;\n      }\n      if (fileSize + infoSize > limitSize) {\n        this.closeLoading();\n        const err = '[SUNEDITOR.imageUpload.fail] Size of uploadable total images: ' + limitSize / 1000 + 'KB';\n        if (typeof this.functions.onImageUploadError !== 'function' || this.functions.onImageUploadError(err, {\n          'limitSize': limitSize,\n          'currentSize': infoSize,\n          'uploadSize': fileSize\n        }, this)) {\n          this.functions.noticeOpen(err);\n        }\n        return;\n      }\n    }\n    const contextImage = this.context.image;\n    contextImage._uploadFileLength = files.length;\n    const anchor = this.plugins.anchor.createAnchor.call(this, contextImage.anchorCtx, true);\n    const info = {\n      anchor: anchor,\n      inputWidth: contextImage.inputX.value,\n      inputHeight: contextImage.inputY.value,\n      align: contextImage._align,\n      isUpdate: this.context.dialog.updateModal,\n      alt: contextImage._altText,\n      element: contextImage._element\n    };\n    if (typeof this.functions.onImageUploadBefore === 'function') {\n      const result = this.functions.onImageUploadBefore(files, info, this, function (data) {\n        if (data && this._w.Array.isArray(data.result)) {\n          this.plugins.image.register.call(this, info, data);\n        } else {\n          this.plugins.image.upload.call(this, info, data);\n        }\n      }.bind(this));\n      if (typeof result === 'undefined') return;\n      if (!result) {\n        this.closeLoading();\n        return;\n      }\n      if (this._w.Array.isArray(result) && result.length > 0) files = result;\n    }\n    this.plugins.image.upload.call(this, info, files);\n  },\n  error: function (message, response) {\n    this.closeLoading();\n    if (typeof this.functions.onImageUploadError !== 'function' || this.functions.onImageUploadError(message, response, this)) {\n      this.functions.noticeOpen(message);\n      throw Error('[SUNEDITOR.plugin.image.error] response: ' + message);\n    }\n  },\n  upload: function (info, files) {\n    if (!files) {\n      this.closeLoading();\n      return;\n    }\n    if (typeof files === 'string') {\n      this.plugins.image.error.call(this, files, null);\n      return;\n    }\n    const imageUploadUrl = this.options.imageUploadUrl;\n    const filesLen = this.context.dialog.updateModal ? 1 : files.length;\n\n    // server upload\n    if (typeof imageUploadUrl === 'string' && imageUploadUrl.length > 0) {\n      const formData = new FormData();\n      for (let i = 0; i < filesLen; i++) {\n        formData.append('file-' + i, files[i]);\n      }\n      this.plugins.fileManager.upload.call(this, imageUploadUrl, this.options.imageUploadHeader, formData, this.plugins.image.callBack_imgUpload.bind(this, info), this.functions.onImageUploadError);\n    } else {\n      // base64\n      this.plugins.image.setup_reader.call(this, files, info.anchor, info.inputWidth, info.inputHeight, info.align, info.alt, filesLen, info.isUpdate);\n    }\n  },\n  callBack_imgUpload: function (info, xmlHttp) {\n    if (typeof this.functions.imageUploadHandler === 'function') {\n      this.functions.imageUploadHandler(xmlHttp, info, this);\n    } else {\n      const response = JSON.parse(xmlHttp.responseText);\n      if (response.errorMessage) {\n        this.plugins.image.error.call(this, response.errorMessage, response);\n      } else {\n        this.plugins.image.register.call(this, info, response);\n      }\n    }\n  },\n  register: function (info, response) {\n    const fileList = response.result;\n    for (let i = 0, len = fileList.length, file; i < len; i++) {\n      file = {\n        name: fileList[i].name,\n        size: fileList[i].size\n      };\n      if (info.isUpdate) {\n        this.plugins.image.update_src.call(this, fileList[i].url, info.element, file);\n        break;\n      } else {\n        this.plugins.image.create_image.call(this, fileList[i].url, info.anchor, info.inputWidth, info.inputHeight, info.align, file, info.alt);\n      }\n    }\n    this.closeLoading();\n  },\n  setup_reader: function (files, anchor, width, height, align, alt, filesLen, isUpdate) {\n    try {\n      this.context.image.base64RenderIndex = filesLen;\n      const wFileReader = this._w.FileReader;\n      const filesStack = [filesLen];\n      this.context.image.inputX.value = width;\n      this.context.image.inputY.value = height;\n      for (let i = 0, reader, file; i < filesLen; i++) {\n        reader = new wFileReader();\n        file = files[i];\n        reader.onload = function (reader, update, updateElement, file, index) {\n          filesStack[index] = {\n            result: reader.result,\n            file: file\n          };\n          if (--this.context.image.base64RenderIndex === 0) {\n            this.plugins.image.onRender_imgBase64.call(this, update, filesStack, updateElement, anchor, width, height, align, alt);\n            this.closeLoading();\n          }\n        }.bind(this, reader, isUpdate, this.context.image._element, file, i);\n        reader.readAsDataURL(file);\n      }\n    } catch (e) {\n      this.closeLoading();\n      throw Error('[SUNEDITOR.image.setup_reader.fail] cause : \"' + e.message + '\"');\n    }\n  },\n  onRender_imgBase64: function (update, filesStack, updateElement, anchor, width, height, align, alt) {\n    const updateMethod = this.plugins.image.update_src;\n    const createMethod = this.plugins.image.create_image;\n    for (let i = 0, len = filesStack.length; i < len; i++) {\n      if (update) {\n        this.context.image._element.setAttribute('data-file-name', filesStack[i].file.name);\n        this.context.image._element.setAttribute('data-file-size', filesStack[i].file.size);\n        updateMethod.call(this, filesStack[i].result, updateElement, filesStack[i].file);\n      } else {\n        createMethod.call(this, filesStack[i].result, anchor, width, height, align, filesStack[i].file, alt);\n      }\n    }\n  },\n  onRender_imgUrl: function (url) {\n    if (!url) url = this.context.image._v_src._linkValue;\n    if (!url) return false;\n    const contextImage = this.context.image;\n    try {\n      const file = {\n        name: url.split('/').pop(),\n        size: 0\n      };\n      if (this.context.dialog.updateModal) this.plugins.image.update_src.call(this, url, contextImage._element, file);else this.plugins.image.create_image.call(this, url, this.plugins.anchor.createAnchor.call(this, contextImage.anchorCtx, true), contextImage.inputX.value, contextImage.inputY.value, contextImage._align, file, contextImage._altText);\n    } catch (e) {\n      throw Error('[SUNEDITOR.image.URLRendering.fail] cause : \"' + e.message + '\"');\n    } finally {\n      this.closeLoading();\n    }\n  },\n  onRender_link: function (imgTag, anchor) {\n    if (anchor) {\n      anchor.setAttribute('data-image-link', 'image');\n      imgTag.setAttribute('data-image-link', anchor.href);\n      anchor.appendChild(imgTag);\n      return anchor;\n    }\n    return imgTag;\n  },\n  /**\n   * @Override resizing\n   * @param {String} xy 'x': width, 'y': height\n   * @param {KeyboardEvent} e Event object\n   */\n  setInputSize: function (xy, e) {\n    if (e && e.keyCode === 32) {\n      e.preventDefault();\n      return;\n    }\n    this.plugins.resizing._module_setInputSize.call(this, this.context.image, xy);\n  },\n  /**\n   * @Override resizing\n   */\n  setRatio: function () {\n    this.plugins.resizing._module_setRatio.call(this, this.context.image);\n  },\n  /**\n   * @Override fileManager\n   */\n  checkFileInfo: function () {\n    const imagePlugin = this.plugins.image;\n    const contextImage = this.context.image;\n    const modifyHandler = function (tag) {\n      imagePlugin.onModifyMode.call(this, tag, null);\n      imagePlugin.openModify.call(this, true);\n      // get size\n      contextImage.inputX.value = contextImage._origin_w;\n      contextImage.inputY.value = contextImage._origin_h;\n      // get align\n      const format = this.util.getFormatElement(tag);\n      if (format) contextImage._align = format.style.textAlign || format.style.float;\n      // link\n      if (this.util.isAnchor(tag.parentNode) && !contextImage.anchorCtx.linkValue) contextImage.anchorCtx.linkValue = ' ';\n      imagePlugin.update_image.call(this, true, false, true);\n      imagePlugin.init.call(this);\n    }.bind(this);\n    this.plugins.fileManager.checkInfo.call(this, 'image', ['img'], this.functions.onImageUpload, modifyHandler, true);\n  },\n  /**\n   * @Override fileManager\n   */\n  resetFileInfo: function () {\n    this.plugins.fileManager.resetInfo.call(this, 'image', this.functions.onImageUpload);\n  },\n  create_image: function (src, anchor, width, height, align, file, alt) {\n    const imagePlugin = this.plugins.image;\n    const contextImage = this.context.image;\n    this.context.resizing._resize_plugin = 'image';\n    let oImg = this.util.createElement('IMG');\n    oImg.src = src;\n    oImg.alt = alt;\n    oImg.setAttribute('data-rotate', '0');\n    anchor = imagePlugin.onRender_link.call(this, oImg, anchor ? anchor.cloneNode(false) : null);\n    if (contextImage._resizing) {\n      oImg.setAttribute('data-proportion', contextImage._proportionChecked);\n    }\n    const cover = this.plugins.component.set_cover.call(this, anchor);\n    const container = this.plugins.component.set_container.call(this, cover, 'se-image-container');\n\n    // caption\n    if (contextImage._captionChecked) {\n      contextImage._caption = this.plugins.component.create_caption.call(this);\n      cover.appendChild(contextImage._caption);\n    }\n    contextImage._element = oImg;\n    contextImage._cover = cover;\n    contextImage._container = container;\n\n    // set size\n    imagePlugin.applySize.call(this, width, height);\n\n    // align\n    imagePlugin.setAlign.call(this, align, oImg, cover, container);\n    oImg.onload = imagePlugin._image_create_onload.bind(this, oImg, contextImage.svgDefaultSize, container);\n    if (this.insertComponent(container, true, true, true)) this.plugins.fileManager.setInfo.call(this, 'image', oImg, this.functions.onImageUpload, file, true);\n    this.context.resizing._resize_plugin = '';\n  },\n  _image_create_onload: function (oImg, svgDefaultSize, container) {\n    // svg exception handling\n    if (oImg.offsetWidth === 0) this.plugins.image.applySize.call(this, svgDefaultSize, '');\n    if (this.options.mediaAutoSelect) {\n      this.selectComponent(oImg, 'image');\n    } else {\n      const line = this.appendFormatTag(container, null);\n      if (line) this.setRange(line, 0, line, 0);\n    }\n  },\n  update_image: function (init, openController, notHistoryPush) {\n    const contextImage = this.context.image;\n    let imageEl = contextImage._element;\n    let cover = contextImage._cover;\n    let container = contextImage._container;\n    let isNewContainer = false;\n    if (cover === null) {\n      isNewContainer = true;\n      imageEl = contextImage._element.cloneNode(true);\n      cover = this.plugins.component.set_cover.call(this, imageEl);\n    }\n    if (container === null) {\n      cover = cover.cloneNode(true);\n      imageEl = cover.querySelector('img');\n      isNewContainer = true;\n      container = this.plugins.component.set_container.call(this, cover, 'se-image-container');\n    } else if (isNewContainer) {\n      container.innerHTML = '';\n      container.appendChild(cover);\n      contextImage._cover = cover;\n      contextImage._element = imageEl;\n      isNewContainer = false;\n    }\n\n    // check size\n    let changeSize;\n    const x = this.util.isNumber(contextImage.inputX.value) ? contextImage.inputX.value + contextImage.sizeUnit : contextImage.inputX.value;\n    const y = this.util.isNumber(contextImage.inputY.value) ? contextImage.inputY.value + contextImage.sizeUnit : contextImage.inputY.value;\n    if (/%$/.test(imageEl.style.width)) {\n      changeSize = x !== container.style.width || y !== container.style.height;\n    } else {\n      changeSize = x !== imageEl.style.width || y !== imageEl.style.height;\n    }\n\n    // alt\n    imageEl.alt = contextImage._altText;\n\n    // caption\n    let modifiedCaption = false;\n    if (contextImage._captionChecked) {\n      if (!contextImage._caption) {\n        contextImage._caption = this.plugins.component.create_caption.call(this);\n        cover.appendChild(contextImage._caption);\n        modifiedCaption = true;\n      }\n    } else {\n      if (contextImage._caption) {\n        this.util.removeItem(contextImage._caption);\n        contextImage._caption = null;\n        modifiedCaption = true;\n      }\n    }\n\n    // link\n    let isNewAnchor = null;\n    const anchor = this.plugins.anchor.createAnchor.call(this, contextImage.anchorCtx, true);\n    if (anchor) {\n      if (contextImage._linkElement !== anchor || isNewContainer && !container.contains(anchor)) {\n        contextImage._linkElement = anchor.cloneNode(false);\n        cover.insertBefore(this.plugins.image.onRender_link.call(this, imageEl, contextImage._linkElement), contextImage._caption);\n        isNewAnchor = contextImage._element;\n      } else {\n        contextImage._linkElement.setAttribute('data-image-link', 'image');\n      }\n    } else if (contextImage._linkElement !== null) {\n      const imageElement = imageEl;\n      imageElement.setAttribute('data-image-link', '');\n      if (cover.contains(contextImage._linkElement)) {\n        const newEl = imageElement.cloneNode(true);\n        cover.removeChild(contextImage._linkElement);\n        cover.insertBefore(newEl, contextImage._caption);\n        contextImage._element = imageEl = newEl;\n      }\n    }\n    let existElement = null;\n    if (isNewContainer) {\n      existElement = this.util.isRangeFormatElement(contextImage._element.parentNode) || this.util.isWysiwygDiv(contextImage._element.parentNode) ? contextImage._element : this.util.isAnchor(contextImage._element.parentNode) ? contextImage._element.parentNode : this.util.getFormatElement(contextImage._element) || contextImage._element;\n      if (this.util.getParentElement(contextImage._element, this.util.isNotCheckingNode)) {\n        existElement = isNewAnchor ? anchor : contextImage._element;\n        existElement.parentNode.replaceChild(container, existElement);\n      } else if (this.util.isListCell(existElement)) {\n        const refer = this.util.getParentElement(contextImage._element, function (current) {\n          return current.parentNode === existElement;\n        });\n        existElement.insertBefore(container, refer);\n        this.util.removeItem(contextImage._element);\n        this.util.removeEmptyNode(refer, null, true);\n      } else if (this.util.isFormatElement(existElement)) {\n        const refer = this.util.getParentElement(contextImage._element, function (current) {\n          return current.parentNode === existElement;\n        });\n        existElement = this.util.splitElement(existElement, refer);\n        existElement.parentNode.insertBefore(container, existElement);\n        this.util.removeItem(contextImage._element);\n        this.util.removeEmptyNode(existElement, null, true);\n        if (existElement.children.length === 0) existElement.innerHTML = this.util.htmlRemoveWhiteSpace(existElement.innerHTML);\n      } else {\n        if (this.util.isFormatElement(existElement.parentNode)) {\n          const formats = existElement.parentNode;\n          formats.parentNode.insertBefore(container, existElement.previousSibling ? formats.nextElementSibling : formats);\n          if (contextImage.__updateTags.map(function (current) {\n            return existElement.contains(current);\n          }).length === 0) this.util.removeItem(existElement);\n        } else {\n          existElement.parentNode.replaceChild(container, existElement);\n        }\n      }\n      imageEl = container.querySelector('img');\n      contextImage._element = imageEl;\n      contextImage._cover = cover;\n      contextImage._container = container;\n    }\n    if (isNewAnchor) {\n      if (!isNewContainer) {\n        this.util.removeItem(anchor);\n      } else {\n        this.util.removeItem(isNewAnchor);\n        if (this.util.getListChildren(anchor, function (current) {\n          return /IMG/i.test(current.tagName);\n        }).length === 0) {\n          this.util.removeItem(anchor);\n        }\n      }\n    }\n\n    // transform\n    if (modifiedCaption || !contextImage._onlyPercentage && changeSize) {\n      if (!init && (/\\d+/.test(imageEl.style.height) || this.context.resizing._rotateVertical && contextImage._captionChecked)) {\n        if (/%$/.test(contextImage.inputX.value) || /%$/.test(contextImage.inputY.value)) {\n          this.plugins.resizing.resetTransform.call(this, imageEl);\n        } else {\n          this.plugins.resizing.setTransformSize.call(this, imageEl, this.util.getNumber(contextImage.inputX.value, 0), this.util.getNumber(contextImage.inputY.value, 0));\n        }\n      }\n    }\n\n    // size\n    if (contextImage._resizing) {\n      imageEl.setAttribute('data-proportion', contextImage._proportionChecked);\n      if (changeSize) {\n        this.plugins.image.applySize.call(this);\n      }\n    }\n\n    // align\n    this.plugins.image.setAlign.call(this, null, imageEl, null, null);\n\n    // set imagesInfo\n    if (init) {\n      this.plugins.fileManager.setInfo.call(this, 'image', imageEl, this.functions.onImageUpload, null, true);\n    }\n    if (openController) {\n      this.selectComponent(imageEl, 'image');\n    }\n\n    // history stack\n    if (!notHistoryPush) this.history.push(false);\n  },\n  update_src: function (src, element, file) {\n    element.src = src;\n    this._w.setTimeout(this.plugins.fileManager.setInfo.bind(this, 'image', element, this.functions.onImageUpload, file, true));\n    this.selectComponent(element, 'image');\n  },\n  /**\n   * @Required @Override fileManager, resizing\n   */\n  onModifyMode: function (element, size) {\n    if (!element) return;\n    const contextImage = this.context.image;\n    contextImage._linkElement = contextImage.anchorCtx.linkAnchor = this.util.isAnchor(element.parentNode) ? element.parentNode : null;\n    contextImage._element = element;\n    contextImage._cover = this.util.getParentElement(element, 'FIGURE');\n    contextImage._container = this.util.getParentElement(element, this.util.isMediaComponent);\n    contextImage._caption = this.util.getChildElement(contextImage._cover, 'FIGCAPTION');\n    contextImage._align = element.getAttribute('data-align') || element.style.float || 'none';\n    element.style.float = '';\n    this.plugins.anchor.setCtx(contextImage._linkElement, contextImage.anchorCtx);\n    if (size) {\n      contextImage._element_w = size.w;\n      contextImage._element_h = size.h;\n      contextImage._element_t = size.t;\n      contextImage._element_l = size.l;\n    }\n    let userSize = contextImage._element.getAttribute('data-size') || contextImage._element.getAttribute('data-origin');\n    let w, h;\n    if (userSize) {\n      userSize = userSize.split(',');\n      w = userSize[0];\n      h = userSize[1];\n    } else if (size) {\n      w = size.w;\n      h = size.h;\n    }\n    contextImage._origin_w = w || element.style.width || element.width || '';\n    contextImage._origin_h = h || element.style.height || element.height || '';\n  },\n  /**\n   * @Required @Override fileManager, resizing\n   */\n  openModify: function (notOpen) {\n    const contextImage = this.context.image;\n    if (contextImage.imgUrlFile) {\n      contextImage._v_src._linkValue = contextImage.previewSrc.textContent = contextImage.imgUrlFile.value = contextImage._element.src;\n    }\n    contextImage._altText = contextImage.altText.value = contextImage._element.alt;\n    (contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"][value=\"' + contextImage._align + '\"]') || contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"][value=\"none\"]')).checked = true;\n    contextImage._align = contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"]:checked').value;\n    contextImage._captionChecked = contextImage.captionCheckEl.checked = !!contextImage._caption;\n    if (contextImage._resizing) {\n      this.plugins.resizing._module_setModifyInputSize.call(this, contextImage, this.plugins.image);\n    }\n    if (!notOpen) this.plugins.dialog.open.call(this, 'image', true);\n  },\n  /**\n   * @Override fileManager\n   */\n  applySize: function (w, h) {\n    const contextImage = this.context.image;\n    if (!w) w = contextImage.inputX.value || this.options.imageWidth;\n    if (!h) h = contextImage.inputY.value || this.options.imageHeight;\n    if (contextImage._onlyPercentage && !!w || /%$/.test(w)) {\n      this.plugins.image.setPercentSize.call(this, w, h);\n      return true;\n    } else if ((!w || w === 'auto') && (!h || h === 'auto')) {\n      this.plugins.image.setAutoSize.call(this);\n    } else {\n      this.plugins.image.setSize.call(this, w, h, false);\n    }\n    return false;\n  },\n  /**\n   * @Override resizing\n   */\n  sizeRevert: function () {\n    this.plugins.resizing._module_sizeRevert.call(this, this.context.image);\n  },\n  /**\n   * @Override resizing\n   */\n  setSize: function (w, h, notResetPercentage, direction) {\n    const contextImage = this.context.image;\n    const onlyW = /^(rw|lw)$/.test(direction) && /\\d+/.test(contextImage._element.style.height);\n    const onlyH = /^(th|bh)$/.test(direction) && /\\d+/.test(contextImage._element.style.width);\n    if (!onlyH) {\n      contextImage._element.style.width = this.util.isNumber(w) ? w + contextImage.sizeUnit : w;\n      this.plugins.image.cancelPercentAttr.call(this);\n    }\n    if (!onlyW) {\n      contextImage._element.style.height = this.util.isNumber(h) ? h + contextImage.sizeUnit : /%$/.test(h) ? '' : h;\n    }\n    if (contextImage._align === 'center') this.plugins.image.setAlign.call(this, null, null, null, null);\n    if (!notResetPercentage) contextImage._element.removeAttribute('data-percentage');\n\n    // save current size\n    this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n  },\n  /**\n   * @Override resizing\n   */\n  setAutoSize: function () {\n    const contextImage = this.context.image;\n    if (contextImage._caption) contextImage._caption.style.marginTop = '';\n    this.plugins.resizing.resetTransform.call(this, contextImage._element);\n    this.plugins.image.cancelPercentAttr.call(this);\n    contextImage._element.style.maxWidth = '';\n    contextImage._element.style.width = '';\n    contextImage._element.style.height = '';\n    contextImage._cover.style.width = '';\n    contextImage._cover.style.height = '';\n    this.plugins.image.setAlign.call(this, null, null, null, null);\n    contextImage._element.setAttribute('data-percentage', 'auto,auto');\n\n    // save current size\n    this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n  },\n  /**\n   * @Override resizing\n   */\n  setOriginSize: function () {\n    const contextImage = this.context.image;\n    contextImage._element.removeAttribute('data-percentage');\n    this.plugins.resizing.resetTransform.call(this, contextImage._element);\n    this.plugins.image.cancelPercentAttr.call(this);\n    const originSize = (contextImage._element.getAttribute('data-origin') || '').split(',');\n    const w = originSize[0];\n    const h = originSize[1];\n    if (originSize) {\n      if (contextImage._onlyPercentage || /%$/.test(w) && (/%$/.test(h) || !/\\d/.test(h))) {\n        this.plugins.image.setPercentSize.call(this, w, h);\n      } else {\n        this.plugins.image.setSize.call(this, w, h);\n      }\n\n      // save current size\n      this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n    }\n  },\n  /**\n   * @Override resizing\n   */\n  setPercentSize: function (w, h) {\n    const contextImage = this.context.image;\n    h = !!h && !/%$/.test(h) && !this.util.getNumber(h, 0) ? this.util.isNumber(h) ? h + '%' : h : this.util.isNumber(h) ? h + contextImage.sizeUnit : h || '';\n    const heightPercentage = /%$/.test(h);\n    contextImage._container.style.width = this.util.isNumber(w) ? w + '%' : w;\n    contextImage._container.style.height = '';\n    contextImage._cover.style.width = '100%';\n    contextImage._cover.style.height = !heightPercentage ? '' : h;\n    contextImage._element.style.width = '100%';\n    contextImage._element.style.height = heightPercentage ? '' : h;\n    contextImage._element.style.maxWidth = '';\n    if (contextImage._align === 'center') this.plugins.image.setAlign.call(this, null, null, null, null);\n    contextImage._element.setAttribute('data-percentage', w + ',' + h);\n    this.plugins.resizing.setCaptionPosition.call(this, contextImage._element);\n\n    // save current size\n    this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n  },\n  /**\n   * @Override resizing\n   */\n  cancelPercentAttr: function () {\n    const contextImage = this.context.image;\n    contextImage._cover.style.width = '';\n    contextImage._cover.style.height = '';\n    contextImage._container.style.width = '';\n    contextImage._container.style.height = '';\n    this.util.removeClass(contextImage._container, this.context.image._floatClassRegExp);\n    this.util.addClass(contextImage._container, '__se__float-' + contextImage._align);\n    if (contextImage._align === 'center') this.plugins.image.setAlign.call(this, null, null, null, null);\n  },\n  /**\n   * @Override resizing\n   */\n  setAlign: function (align, element, cover, container) {\n    const contextImage = this.context.image;\n    if (!align) align = contextImage._align;\n    if (!element) element = contextImage._element;\n    if (!cover) cover = contextImage._cover;\n    if (!container) container = contextImage._container;\n    if (/%$/.test(element.style.width) && align === 'center') {\n      container.style.minWidth = '100%';\n      cover.style.width = container.style.width;\n    } else {\n      container.style.minWidth = '';\n      cover.style.width = this.context.resizing._rotateVertical ? element.style.height || element.offsetHeight : !element.style.width || element.style.width === 'auto' ? '' : element.style.width || '100%';\n    }\n    if (!this.util.hasClass(container, '__se__float-' + align)) {\n      this.util.removeClass(container, contextImage._floatClassRegExp);\n      this.util.addClass(container, '__se__float-' + align);\n    }\n    element.setAttribute('data-align', align);\n  },\n  /**\n   * @Override dialog\n   */\n  init: function () {\n    const contextImage = this.context.image;\n    if (contextImage.imgInputFile) contextImage.imgInputFile.value = '';\n    if (contextImage.imgUrlFile) contextImage._v_src._linkValue = contextImage.previewSrc.textContent = contextImage.imgUrlFile.value = '';\n    if (contextImage.imgInputFile && contextImage.imgUrlFile) {\n      contextImage.imgUrlFile.removeAttribute('disabled');\n      contextImage.previewSrc.style.textDecoration = '';\n    }\n    contextImage.altText.value = '';\n    contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"][value=\"none\"]').checked = true;\n    contextImage.captionCheckEl.checked = false;\n    contextImage._element = null;\n    this.plugins.image.openTab.call(this, 'init');\n    if (contextImage._resizing) {\n      contextImage.inputX.value = this.options.imageWidth === contextImage._defaultSizeX ? '' : this.options.imageWidth;\n      contextImage.inputY.value = this.options.imageHeight === contextImage._defaultSizeY ? '' : this.options.imageHeight;\n      contextImage.proportion.checked = true;\n      contextImage._ratio = false;\n      contextImage._ratioX = 1;\n      contextImage._ratioY = 1;\n    }\n    this.plugins.anchor.init.call(this, contextImage.anchorCtx);\n  }\n};","map":{"version":3,"names":["dialog","anchor","component","resizing","fileManager","name","display","add","core","addModule","options","context","contextImage","image","_infoList","_infoIndex","_uploadFileLength","focusElement","sizeUnit","_imageSizeUnit","_linkElement","_altText","_align","_floatClassRegExp","_v_src","_linkValue","svgDefaultSize","base64RenderIndex","_element","_cover","_container","inputX","inputY","_element_w","_element_h","_element_l","_element_t","_defaultSizeX","_defaultSizeY","_origin_w","imageWidth","_origin_h","imageHeight","_proportionChecked","_resizing","imageResizing","_resizeDotHide","imageHeightShow","_rotation","imageRotation","_alignHide","imageAlignShow","_onlyPercentage","imageSizeOnlyPercentage","_ratio","_ratioX","_ratioY","_captionShow","_captionChecked","_caption","captionCheckEl","image_dialog","setDialog","modal","imgInputFile","querySelector","imgUrlFile","altText","previewSrc","addEventListener","openTab","bind","submit","_removeSelectedFiles","_onLinkPreview","linkProtocol","_fileInputChange","imageGalleryButton","_openGallery","proportion","value","setInputSize","setRatio","sizeRevert","appendChild","plugins","initEvent","call","anchorCtx","caller","option","lang","util","createElement","className","style","html","dialogBox","close","icons","cancel","imageBox","title","toolbar","link","imageFileInput","file","imageAccept","imageMultipleFile","controller","remove","imageUrlInput","url","imageGalleryUrl","imageGallery","image_gallery","onlyPercentage","onlyPercentDisplay","heightDisplay","size","width","height","revertButton","revert","caption","forms","innerHTML","basic","left","center","right","submitButton","removeAttribute","textDecoration","setAttribute","urlInput","callPlugin","open","_setUrlInput","target","alt","textContent","src","focus","protocol","e","trim","indexOf","fileTags","select","element","onModifyMode","call_controller_resize","destroy","imageEl","imageContainer","getParentElement","isMediaComponent","dataIndex","getAttribute","focusEl","previousElementSibling","nextElementSibling","emptyDiv","parentNode","removeItem","init","controllersOff","wysiwyg","removeItemAllParents","current","childNodes","length","focusEdge","deleteInfo","functions","onImageUpload","history","push","on","update","currentControllerName","targetElement","test","tagName","tabName","contentClassName","i","tabContent","tabLinks","getElementsByClassName","removeClass","addClass","imagePlugin","preventDefault","stopPropagation","checked","updateModal","update_image","files","showLoading","submitAction","onRender_imgUrl","error","closeLoading","Error","message","fileList","fileSize","len","type","limitSize","imageUploadSizeLimit","infoSize","imagesInfo","err","onImageUploadError","noticeOpen","createAnchor","info","inputWidth","inputHeight","align","isUpdate","onImageUploadBefore","result","data","_w","Array","isArray","register","upload","response","imageUploadUrl","filesLen","formData","FormData","append","imageUploadHeader","callBack_imgUpload","setup_reader","xmlHttp","imageUploadHandler","JSON","parse","responseText","errorMessage","update_src","create_image","wFileReader","FileReader","filesStack","reader","onload","updateElement","index","onRender_imgBase64","readAsDataURL","updateMethod","createMethod","split","pop","onRender_link","imgTag","href","xy","keyCode","_module_setInputSize","_module_setRatio","checkFileInfo","modifyHandler","tag","openModify","format","getFormatElement","textAlign","float","isAnchor","linkValue","checkInfo","resetFileInfo","resetInfo","_resize_plugin","oImg","cloneNode","cover","set_cover","container","set_container","create_caption","applySize","setAlign","_image_create_onload","insertComponent","setInfo","offsetWidth","mediaAutoSelect","selectComponent","line","appendFormatTag","setRange","openController","notHistoryPush","isNewContainer","changeSize","x","isNumber","y","modifiedCaption","isNewAnchor","contains","insertBefore","imageElement","newEl","removeChild","existElement","isRangeFormatElement","isWysiwygDiv","isNotCheckingNode","replaceChild","isListCell","refer","removeEmptyNode","isFormatElement","splitElement","children","htmlRemoveWhiteSpace","formats","previousSibling","__updateTags","map","getListChildren","_rotateVertical","resetTransform","setTransformSize","getNumber","setTimeout","linkAnchor","getChildElement","setCtx","w","h","t","l","userSize","notOpen","_module_setModifyInputSize","setPercentSize","setAutoSize","setSize","_module_sizeRevert","notResetPercentage","direction","onlyW","onlyH","cancelPercentAttr","_module_saveCurrentSize","marginTop","maxWidth","setOriginSize","originSize","heightPercentage","setCaptionPosition","minWidth","offsetHeight","hasClass"],"sources":["E:/Programming/React/New folder (2)/dynamicArt/dynamic-article/node_modules/suneditor/src/plugins/dialog/image.js"],"sourcesContent":["/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nimport dialog from '../modules/dialog';\nimport anchor from '../modules/_anchor';\nimport component from '../modules/component';\nimport resizing from '../modules/resizing';\nimport fileManager from '../modules/fileManager';\n\nexport default {\n    name: 'image',\n    display: 'dialog',\n    add: function (core) {\n        core.addModule([dialog, anchor, component, resizing, fileManager]);\n        \n        const options = core.options;\n        const context = core.context;\n        const contextImage = context.image = {\n            _infoList: [], // @Override fileManager\n            _infoIndex: 0, // @Override fileManager\n            _uploadFileLength: 0, // @Override fileManager\n            focusElement: null, // @Override dialog // This element has focus when the dialog is opened.\n            sizeUnit: options._imageSizeUnit,\n            _linkElement: '',\n            _altText: '',\n            _align: 'none',\n            _floatClassRegExp: '__se__float\\\\-[a-z]+',\n            _v_src: {_linkValue: ''},\n            svgDefaultSize: '30%',\n            base64RenderIndex: 0,\n            // @require @Override component\n            _element: null,\n            _cover: null,\n            _container: null,\n            // @Override resizing properties\n            inputX: null,\n            inputY: null,\n            _element_w: 1,\n            _element_h: 1,\n            _element_l: 0,\n            _element_t: 0,\n            _defaultSizeX: 'auto',\n            _defaultSizeY: 'auto',\n            _origin_w: options.imageWidth === 'auto' ? '' : options.imageWidth,\n            _origin_h: options.imageHeight === 'auto' ? '' : options.imageHeight,\n            _proportionChecked: true,\n            _resizing: options.imageResizing,\n            _resizeDotHide: !options.imageHeightShow,\n            _rotation: options.imageRotation,\n            _alignHide: !options.imageAlignShow,\n            _onlyPercentage: options.imageSizeOnlyPercentage,\n            _ratio: false,\n            _ratioX: 1,\n            _ratioY: 1,\n            _captionShow: true,\n            _captionChecked: false,\n            _caption: null,\n            captionCheckEl: null\n        };\n\n        /** image dialog */\n        let image_dialog = this.setDialog(core);\n        contextImage.modal = image_dialog;\n        contextImage.imgInputFile = image_dialog.querySelector('._se_image_file');\n        contextImage.imgUrlFile = image_dialog.querySelector('._se_image_url');\n        contextImage.focusElement = contextImage.imgInputFile || contextImage.imgUrlFile;\n        contextImage.altText = image_dialog.querySelector('._se_image_alt');\n        contextImage.captionCheckEl = image_dialog.querySelector('._se_image_check_caption');\n        contextImage.previewSrc = image_dialog.querySelector('._se_tab_content_image .se-link-preview');\n\n        /** add event listeners */\n        image_dialog.querySelector('.se-dialog-tabs').addEventListener('click', this.openTab.bind(core));\n        image_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core));\n        if (contextImage.imgInputFile) image_dialog.querySelector('.se-file-remove').addEventListener('click', this._removeSelectedFiles.bind(contextImage.imgInputFile, contextImage.imgUrlFile, contextImage.previewSrc));\n        if (contextImage.imgUrlFile) contextImage.imgUrlFile.addEventListener('input', this._onLinkPreview.bind(contextImage.previewSrc, contextImage._v_src, options.linkProtocol));\n        if (contextImage.imgInputFile && contextImage.imgUrlFile) contextImage.imgInputFile.addEventListener('change', this._fileInputChange.bind(contextImage));\n\n        const imageGalleryButton = image_dialog.querySelector('.__se__gallery');\n        if (imageGalleryButton) imageGalleryButton.addEventListener('click', this._openGallery.bind(core));\n        \n        contextImage.proportion = {};\n        contextImage.inputX = {};\n        contextImage.inputY = {};\n        if (options.imageResizing) {\n            contextImage.proportion = image_dialog.querySelector('._se_image_check_proportion');\n            contextImage.inputX = image_dialog.querySelector('._se_image_size_x');\n            contextImage.inputY = image_dialog.querySelector('._se_image_size_y');\n            contextImage.inputX.value = options.imageWidth;\n            contextImage.inputY.value = options.imageHeight;\n            \n            contextImage.inputX.addEventListener('keyup', this.setInputSize.bind(core, 'x'));\n            contextImage.inputY.addEventListener('keyup', this.setInputSize.bind(core, 'y'));\n\n            contextImage.inputX.addEventListener('change', this.setRatio.bind(core));\n            contextImage.inputY.addEventListener('change', this.setRatio.bind(core));\n            contextImage.proportion.addEventListener('change', this.setRatio.bind(core));\n            \n            image_dialog.querySelector('.se-dialog-btn-revert').addEventListener('click', this.sizeRevert.bind(core));\n        }\n\n        /** append html */\n        context.dialog.modal.appendChild(image_dialog);\n\n        /** link event */\n        core.plugins.anchor.initEvent.call(core, 'image', image_dialog.querySelector('._se_tab_content_url'));\n        contextImage.anchorCtx = core.context.anchor.caller.image;\n\n        /** empty memory */\n        image_dialog = null;\n    },\n\n    /** dialog */\n    setDialog: function (core) {\n        const option = core.options;\n        const lang = core.lang;\n        const dialog = core.util.createElement('DIV');\n\n        dialog.className = 'se-dialog-content se-dialog-image';\n        dialog.style.display = 'none';\n\n        let html = '' +\n            '<div class=\"se-dialog-header\">' +\n                '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" class=\"close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' +\n                    core.icons.cancel +\n                '</button>' +\n                '<span class=\"se-modal-title\">' + lang.dialogBox.imageBox.title + '</span>' +\n            '</div>' +\n            '<div class=\"se-dialog-tabs\">' +\n                '<button type=\"button\" class=\"_se_tab_link active\" data-tab-link=\"image\">' + lang.toolbar.image + '</button>' +\n                '<button type=\"button\" class=\"_se_tab_link\" data-tab-link=\"url\">' + lang.toolbar.link + '</button>' +\n            '</div>' +\n            '<form method=\"post\" enctype=\"multipart/form-data\">' +\n                '<div class=\"_se_tab_content _se_tab_content_image\">' +\n                    '<div class=\"se-dialog-body\"><div style=\"border-bottom: 1px dashed #ccc;\">';\n                    \n                    if (option.imageFileInput) {\n                        html += '' +\n                            '<div class=\"se-dialog-form\">' +\n                                '<label>' + lang.dialogBox.imageBox.file + '</label>' +\n                                '<div class=\"se-dialog-form-files\">' +\n                                    '<input class=\"se-input-form _se_image_file\" type=\"file\" accept=\"' + option.imageAccept + '\"' + (option.imageMultipleFile ? ' multiple=\"multiple\"' : '') + '/>' +\n                                    '<button type=\"button\" class=\"se-btn se-dialog-files-edge-button se-file-remove\" title=\"' + lang.controller.remove + '\" aria-label=\"' + lang.controller.remove + '\">' + core.icons.cancel + '</button>' +\n                                '</div>' +\n                            '</div>' ;\n                    }\n        \n                    if (option.imageUrlInput) {\n                        html += '' +\n                            '<div class=\"se-dialog-form\">' +\n                                '<label>' + lang.dialogBox.imageBox.url + '</label>' +\n                                '<div class=\"se-dialog-form-files\">' +\n                                    '<input class=\"se-input-form se-input-url _se_image_url\" type=\"text\" />' +\n                                    ((option.imageGalleryUrl && core.plugins.imageGallery) ? '<button type=\"button\" class=\"se-btn se-dialog-files-edge-button __se__gallery\" title=\"' + lang.toolbar.imageGallery + '\" aria-label=\"' + lang.toolbar.imageGallery + '\">' + core.icons.image_gallery + '</button>' : '') +\n                                '</div>' +\n                                '<pre class=\"se-link-preview\"></pre>' +\n                            '</div>';\n                    }\n        \n                    html += '</div>' +\n                        '<div class=\"se-dialog-form\">' +\n                            '<label>' + lang.dialogBox.imageBox.altText + '</label><input class=\"se-input-form _se_image_alt\" type=\"text\" />' +\n                        '</div>';\n\n            if (option.imageResizing) {\n                const onlyPercentage = option.imageSizeOnlyPercentage;\n                const onlyPercentDisplay = onlyPercentage ? ' style=\"display: none !important;\"' : '';\n                const heightDisplay = !option.imageHeightShow ? ' style=\"display: none !important;\"' : '';\n                html += '<div class=\"se-dialog-form\">';\n                        if (onlyPercentage || !option.imageHeightShow) {\n                            html += '' +\n                            '<div class=\"se-dialog-size-text\">' +\n                                '<label class=\"size-w\">' + lang.dialogBox.size + '</label>' +\n                            '</div>';\n                        } else {\n                            html += '' +\n                            '<div class=\"se-dialog-size-text\">' +\n                                '<label class=\"size-w\">' + lang.dialogBox.width + '</label>' +\n                                '<label class=\"se-dialog-size-x\">&nbsp;</label>' +\n                                '<label class=\"size-h\">' + lang.dialogBox.height + '</label>' +\n                            '</div>';\n                        }\n                        html += '' +\n                            '<input class=\"se-input-control _se_image_size_x\" placeholder=\"auto\"' + (onlyPercentage ? ' type=\"number\" min=\"1\"' : 'type=\"text\"') + (onlyPercentage ? ' max=\"100\"' : '') + ' />' +\n                            '<label class=\"se-dialog-size-x\"' + heightDisplay + '>' + (onlyPercentage ? '%' : 'x') + '</label>' +\n                            '<input type=\"text\" class=\"se-input-control _se_image_size_y\" placeholder=\"auto\"' + onlyPercentDisplay + (onlyPercentage ? ' max=\"100\"' : '') + heightDisplay + '/>' +\n                            '<label' + onlyPercentDisplay + heightDisplay + '><input type=\"checkbox\" class=\"se-dialog-btn-check _se_image_check_proportion\" checked/>&nbsp;' + lang.dialogBox.proportion + '</label>' +\n                            '<button type=\"button\" title=\"' + lang.dialogBox.revertButton + '\" aria-label=\"' + lang.dialogBox.revertButton + '\" class=\"se-btn se-dialog-btn-revert\" style=\"float: right;\">' + core.icons.revert + '</button>' +\n                        '</div>' ;\n            }\n\n            html += '' +\n                        '<div class=\"se-dialog-form se-dialog-form-footer\">' +\n                            '<label><input type=\"checkbox\" class=\"se-dialog-btn-check _se_image_check_caption\" />&nbsp;' + lang.dialogBox.caption + '</label>' +\n                        '</div>' +\n                    '</div>' +\n                '</div>' +\n                '<div class=\"_se_tab_content _se_tab_content_url\" style=\"display: none\">' +\n                    core.context.anchor.forms.innerHTML +\n                '</div>' +\n                '<div class=\"se-dialog-footer\">' +\n                    '<div' + (option.imageAlignShow ? '' : ' style=\"display: none\"') + '>' +\n                        '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"none\" checked>' + lang.dialogBox.basic + '</label>' +\n                        '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"left\">' + lang.dialogBox.left + '</label>' +\n                        '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"center\">' + lang.dialogBox.center + '</label>' +\n                        '<label><input type=\"radio\" name=\"suneditor_image_radio\" class=\"se-dialog-btn-radio\" value=\"right\">' + lang.dialogBox.right + '</label>' +\n                    '</div>' +\n                    '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' +\n                '</div>' +\n            '</form>';\n\n        dialog.innerHTML = html;\n\n        return dialog;\n    },\n\n    _fileInputChange: function () {\n        if (!this.imgInputFile.value) {\n            this.imgUrlFile.removeAttribute('disabled');\n            this.previewSrc.style.textDecoration = '';\n        } else {\n            this.imgUrlFile.setAttribute('disabled', true);\n            this.previewSrc.style.textDecoration = 'line-through';\n        }\n    },\n\n    _removeSelectedFiles: function (urlInput, previewSrc) {\n        this.value = '';\n        if (urlInput) {\n            urlInput.removeAttribute('disabled');\n            previewSrc.style.textDecoration = '';\n        }\n    },\n\n    _openGallery: function () {\n        this.callPlugin('imageGallery', this.plugins.imageGallery.open.bind(this, this.plugins.image._setUrlInput.bind(this.context.image)), null);\n    },\n\n    _setUrlInput: function (target) {\n        this.altText.value = target.alt;\n        this._v_src._linkValue = this.previewSrc.textContent = this.imgUrlFile.value = target.src;\n        this.imgUrlFile.focus();\n    },\n\n    _onLinkPreview: function (context, protocol, e) {\n        const value = e.target.value.trim();\n        context._linkValue = this.textContent = !value ? '' : (protocol && value.indexOf('://') === -1 && value.indexOf('#') !== 0) ? protocol + value : value.indexOf('://') === -1 ? '/' + value : value;\n    },\n\n    /**\n     * @Override @Required fileManager\n     */\n    fileTags: ['img'],\n\n    /**\n     * @Override core, fileManager, resizing\n     * @description It is called from core.selectComponent.\n     * @param {Element} element Target element\n     */\n    select: function (element) {\n        this.plugins.image.onModifyMode.call(this, element, this.plugins.resizing.call_controller_resize.call(this, element, 'image'));\n    },\n\n    /**\n     * @Override fileManager, resizing\n     */\n    destroy: function (element) {\n        const imageEl = element || this.context.image._element;\n        const imageContainer = this.util.getParentElement(imageEl, this.util.isMediaComponent) || imageEl;\n        const dataIndex = imageEl.getAttribute('data-index') * 1;\n        let focusEl = (imageContainer.previousElementSibling || imageContainer.nextElementSibling);\n        \n        const emptyDiv = imageContainer.parentNode;\n        this.util.removeItem(imageContainer);\n        this.plugins.image.init.call(this);\n        this.controllersOff();\n\n        if (emptyDiv !== this.context.element.wysiwyg) this.util.removeItemAllParents(emptyDiv, function (current) { return current.childNodes.length === 0; }, null);\n\n        // focus\n        this.focusEdge(focusEl);\n        \n        // event\n        this.plugins.fileManager.deleteInfo.call(this, 'image', dataIndex, this.functions.onImageUpload);\n\n        // history stack\n        this.history.push(false);\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    on: function (update) {\n        const contextImage = this.context.image;\n        \n        if (!update) {\n            contextImage.inputX.value = contextImage._origin_w = this.options.imageWidth === contextImage._defaultSizeX ? '' : this.options.imageWidth;\n            contextImage.inputY.value = contextImage._origin_h = this.options.imageHeight === contextImage._defaultSizeY ? '' : this.options.imageHeight;\n            if (contextImage.imgInputFile && this.options.imageMultipleFile) contextImage.imgInputFile.setAttribute('multiple', 'multiple');\n        } else {\n            if (contextImage.imgInputFile && this.options.imageMultipleFile) contextImage.imgInputFile.removeAttribute('multiple');\n        }\n        this.plugins.anchor.on.call(this, contextImage.anchorCtx, update);\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    open: function () {\n        this.plugins.dialog.open.call(this, 'image', 'image' === this.currentControllerName);\n    },\n\n    openTab: function (e) {\n        const modal = this.context.image.modal;\n        const targetElement = (e === 'init' ? modal.querySelector('._se_tab_link') : e.target);\n\n        if (!/^BUTTON$/i.test(targetElement.tagName)) {\n            return false;\n        }\n\n        // Declare all variables\n        const tabName = targetElement.getAttribute('data-tab-link');\n        const contentClassName = '_se_tab_content';\n        let i, tabContent, tabLinks;\n\n        // Get all elements with class=\"tabcontent\" and hide them\n        tabContent = modal.getElementsByClassName(contentClassName);\n        for (i = 0; i < tabContent.length; i++) {\n            tabContent[i].style.display = 'none';\n        }\n\n        // Get all elements with class=\"tablinks\" and remove the class \"active\"\n        tabLinks = modal.getElementsByClassName('_se_tab_link');\n        for (i = 0; i < tabLinks.length; i++) {\n            this.util.removeClass(tabLinks[i], 'active');\n        }\n\n        // Show the current tab, and add an \"active\" class to the button that opened the tab\n        modal.querySelector('.' + contentClassName + '_' + tabName).style.display = 'block';\n        this.util.addClass(targetElement, 'active');\n\n        // focus\n        if (tabName === 'image' && this.context.image.focusElement) {\n            this.context.image.focusElement.focus();\n        } else if (tabName === 'url') {\n            this.context.anchor.caller.image.urlInput.focus();\n        }\n\n        return false;\n    },\n\n    submit: function (e) {\n        const contextImage = this.context.image;\n        const imagePlugin = this.plugins.image;\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        contextImage._altText = contextImage.altText.value;\n        contextImage._align = contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"]:checked').value;\n        contextImage._captionChecked = contextImage.captionCheckEl.checked;\n        if (contextImage._resizing) contextImage._proportionChecked = contextImage.proportion.checked;\n\n        try {\n            if (this.context.dialog.updateModal) {\n                imagePlugin.update_image.call(this, false, true, false);\n            }\n            \n            if (contextImage.imgInputFile && contextImage.imgInputFile.files.length > 0) {\n                this.showLoading();\n                imagePlugin.submitAction.call(this, this.context.image.imgInputFile.files);\n            } else if (contextImage.imgUrlFile && contextImage._v_src._linkValue.length > 0) {\n                this.showLoading();\n                imagePlugin.onRender_imgUrl.call(this, contextImage._v_src._linkValue);\n            }\n        } catch (error) {\n            this.closeLoading();\n            throw Error('[SUNEDITOR.image.submit.fail] cause : \"' + error.message + '\"');\n        } finally {\n            this.plugins.dialog.close.call(this);\n        }\n\n        return false;\n    },\n\n    submitAction: function (fileList) {\n        if (fileList.length === 0) return;\n\n        let fileSize = 0;\n        let files = [];\n        for (let i = 0, len = fileList.length; i < len; i++) {\n            if (/image/i.test(fileList[i].type)) {\n                files.push(fileList[i]);\n                fileSize += fileList[i].size;\n            }\n        }\n\n        const limitSize = this.options.imageUploadSizeLimit;\n        if (limitSize > 0) {\n            let infoSize = 0;\n            const imagesInfo = this.context.image._infoList;\n            for (let i = 0, len = imagesInfo.length; i < len; i++) {\n                infoSize += imagesInfo[i].size * 1;\n            }\n\n            if ((fileSize + infoSize) > limitSize) {\n                this.closeLoading();\n                const err = '[SUNEDITOR.imageUpload.fail] Size of uploadable total images: ' + (limitSize/1000) + 'KB';\n                if (typeof this.functions.onImageUploadError !== 'function' || this.functions.onImageUploadError(err, { 'limitSize': limitSize, 'currentSize': infoSize, 'uploadSize': fileSize }, this)) {\n                    this.functions.noticeOpen(err);\n                }\n                return;\n            }\n        }\n\n        const contextImage = this.context.image;\n        contextImage._uploadFileLength = files.length;\n        \n        const anchor = this.plugins.anchor.createAnchor.call(this, contextImage.anchorCtx, true);\n        const info = {\n            anchor: anchor,\n            inputWidth: contextImage.inputX.value,\n            inputHeight: contextImage.inputY.value,\n            align: contextImage._align,\n            isUpdate: this.context.dialog.updateModal,\n            alt: contextImage._altText,\n            element: contextImage._element\n        };\n\n        if (typeof this.functions.onImageUploadBefore === 'function') {\n            const result = this.functions.onImageUploadBefore(files, info, this, function (data) {\n                if (data && this._w.Array.isArray(data.result)) {\n                    this.plugins.image.register.call(this, info, data);\n                } else {\n                    this.plugins.image.upload.call(this, info, data);\n                }\n            }.bind(this));\n            \n            if (typeof result === 'undefined') return;\n            if (!result) {\n                this.closeLoading();\n                return;\n            }\n            if (this._w.Array.isArray(result) && result.length > 0) files = result;\n        }\n\n        this.plugins.image.upload.call(this, info, files);\n    },\n\n    error: function (message, response) {\n        this.closeLoading();\n        if (typeof this.functions.onImageUploadError !== 'function' || this.functions.onImageUploadError(message, response, this)) {\n            this.functions.noticeOpen(message);\n            throw Error('[SUNEDITOR.plugin.image.error] response: ' + message);\n        }\n    },\n\n    upload: function (info, files) {\n        if (!files) {\n            this.closeLoading();\n            return;\n        }\n        if (typeof files === 'string') {\n            this.plugins.image.error.call(this, files, null);\n            return;\n        }\n\n        const imageUploadUrl = this.options.imageUploadUrl;\n        const filesLen = this.context.dialog.updateModal ? 1 : files.length;\n\n        // server upload\n        if (typeof imageUploadUrl === 'string' && imageUploadUrl.length > 0) {\n            const formData = new FormData();\n            for (let i = 0; i < filesLen; i++) {\n                formData.append('file-' + i, files[i]);\n            }\n            this.plugins.fileManager.upload.call(this, imageUploadUrl, this.options.imageUploadHeader, formData, this.plugins.image.callBack_imgUpload.bind(this, info), this.functions.onImageUploadError);\n        } else { // base64\n            this.plugins.image.setup_reader.call(this, files, info.anchor, info.inputWidth, info.inputHeight, info.align, info.alt, filesLen, info.isUpdate);\n        }\n    },\n\n    callBack_imgUpload: function (info, xmlHttp) {\n        if (typeof this.functions.imageUploadHandler === 'function') {\n            this.functions.imageUploadHandler(xmlHttp, info, this);\n        } else {\n            const response = JSON.parse(xmlHttp.responseText);\n            if (response.errorMessage) {\n                this.plugins.image.error.call(this, response.errorMessage, response);\n            } else {\n                this.plugins.image.register.call(this, info, response);\n            }\n        }\n    },\n\n    register: function (info, response) {\n        const fileList = response.result;\n\n        for (let i = 0, len = fileList.length, file; i < len; i++) {\n            file = { name: fileList[i].name, size: fileList[i].size };\n            if (info.isUpdate) {\n                this.plugins.image.update_src.call(this, fileList[i].url, info.element, file);\n                break;\n            } else {\n                this.plugins.image.create_image.call(this, fileList[i].url, info.anchor, info.inputWidth, info.inputHeight, info.align, file, info.alt);\n            }\n        }\n        \n        this.closeLoading();\n    },\n\n    setup_reader: function (files, anchor, width, height, align, alt, filesLen, isUpdate) {\n        try {\n            this.context.image.base64RenderIndex = filesLen;\n            const wFileReader = this._w.FileReader;\n            const filesStack = [filesLen];\n            this.context.image.inputX.value = width;\n            this.context.image.inputY.value = height;\n    \n            for (let i = 0, reader, file; i < filesLen; i++) {\n                reader = new wFileReader();\n                file = files[i];\n    \n                reader.onload = function (reader, update, updateElement, file, index) {\n                    filesStack[index] = { result: reader.result, file: file };\n\n                    if (--this.context.image.base64RenderIndex === 0) {\n                        this.plugins.image.onRender_imgBase64.call(this, update, filesStack, updateElement, anchor, width, height, align, alt);\n                        this.closeLoading();\n                    }\n                }.bind(this, reader, isUpdate, this.context.image._element, file, i);\n\n                reader.readAsDataURL(file);\n            }\n        } catch (e) {\n            this.closeLoading();\n            throw Error('[SUNEDITOR.image.setup_reader.fail] cause : \"' + e.message + '\"');\n        }\n    },\n\n    onRender_imgBase64: function (update, filesStack, updateElement, anchor, width, height, align, alt) {\n        const updateMethod = this.plugins.image.update_src;\n        const createMethod = this.plugins.image.create_image;\n        \n        for (let i = 0, len = filesStack.length; i < len; i++) {\n            if (update) {\n                this.context.image._element.setAttribute('data-file-name', filesStack[i].file.name);\n                this.context.image._element.setAttribute('data-file-size', filesStack[i].file.size);\n                updateMethod.call(this, filesStack[i].result, updateElement, filesStack[i].file);\n            } else {\n                createMethod.call(this, filesStack[i].result, anchor, width, height, align, filesStack[i].file, alt);\n            }\n        }\n    },\n\n    onRender_imgUrl: function (url) {\n        if (!url) url = this.context.image._v_src._linkValue;\n        if (!url) return false;\n        const contextImage = this.context.image;\n\n        try {\n            const file = {name: url.split('/').pop(), size: 0};\n            if (this.context.dialog.updateModal) this.plugins.image.update_src.call(this, url, contextImage._element, file);\n            else this.plugins.image.create_image.call(this, url, this.plugins.anchor.createAnchor.call(this, contextImage.anchorCtx, true), contextImage.inputX.value, contextImage.inputY.value, contextImage._align, file, contextImage._altText);\n        } catch (e) {\n            throw Error('[SUNEDITOR.image.URLRendering.fail] cause : \"' + e.message + '\"');\n        } finally {\n            this.closeLoading();\n        }\n    },\n\n    onRender_link: function (imgTag, anchor) {\n        if (anchor) {\n            anchor.setAttribute('data-image-link', 'image');\n            imgTag.setAttribute('data-image-link', anchor.href);\n            anchor.appendChild(imgTag);\n            return anchor;\n        }\n\n        return imgTag;\n    },\n\n    /**\n     * @Override resizing\n     * @param {String} xy 'x': width, 'y': height\n     * @param {KeyboardEvent} e Event object\n     */\n    setInputSize: function (xy, e) {\n        if (e && e.keyCode === 32) {\n            e.preventDefault();\n            return;\n        }\n\n        this.plugins.resizing._module_setInputSize.call(this, this.context.image, xy);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setRatio: function () {\n        this.plugins.resizing._module_setRatio.call(this, this.context.image);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    checkFileInfo: function () {\n        const imagePlugin = this.plugins.image;\n        const contextImage = this.context.image;\n\n        const modifyHandler = function (tag) {\n            imagePlugin.onModifyMode.call(this, tag, null);\n            imagePlugin.openModify.call(this, true);\n            // get size\n            contextImage.inputX.value = contextImage._origin_w;\n            contextImage.inputY.value = contextImage._origin_h;\n            // get align\n            const format = this.util.getFormatElement(tag);\n            if (format) contextImage._align = format.style.textAlign || format.style.float;\n            // link\n            if (this.util.isAnchor(tag.parentNode) && !contextImage.anchorCtx.linkValue) contextImage.anchorCtx.linkValue = ' ';\n            \n            imagePlugin.update_image.call(this, true, false, true);\n            imagePlugin.init.call(this);\n        }.bind(this);\n\n        this.plugins.fileManager.checkInfo.call(this, 'image', ['img'], this.functions.onImageUpload, modifyHandler, true);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    resetFileInfo: function () {\n        this.plugins.fileManager.resetInfo.call(this, 'image', this.functions.onImageUpload);\n    },\n\n    create_image: function (src, anchor, width, height, align, file, alt) {\n        const imagePlugin = this.plugins.image;\n        const contextImage = this.context.image;\n        this.context.resizing._resize_plugin = 'image';\n\n        let oImg = this.util.createElement('IMG');\n        oImg.src = src;\n        oImg.alt = alt;\n        oImg.setAttribute('data-rotate', '0');\n        anchor = imagePlugin.onRender_link.call(this, oImg, anchor ?  anchor.cloneNode(false) : null);\n\n        if (contextImage._resizing) {\n            oImg.setAttribute('data-proportion', contextImage._proportionChecked);\n        }\n\n        const cover = this.plugins.component.set_cover.call(this, anchor);\n        const container = this.plugins.component.set_container.call(this, cover, 'se-image-container');\n\n        // caption\n        if (contextImage._captionChecked) {\n            contextImage._caption = this.plugins.component.create_caption.call(this);\n            cover.appendChild(contextImage._caption);\n        }\n\n        contextImage._element = oImg;\n        contextImage._cover = cover;\n        contextImage._container = container;\n\n        // set size\n        imagePlugin.applySize.call(this, width, height);\n\n        // align\n        imagePlugin.setAlign.call(this, align, oImg, cover, container);\n\n        oImg.onload = imagePlugin._image_create_onload.bind(this, oImg, contextImage.svgDefaultSize, container);\n        if (this.insertComponent(container, true, true, true)) this.plugins.fileManager.setInfo.call(this, 'image', oImg, this.functions.onImageUpload, file, true);\n        this.context.resizing._resize_plugin = '';\n    },\n\n    _image_create_onload: function (oImg, svgDefaultSize, container) {\n        // svg exception handling\n        if (oImg.offsetWidth === 0) this.plugins.image.applySize.call(this, svgDefaultSize, '');\n        if (this.options.mediaAutoSelect) {\n            this.selectComponent(oImg, 'image');\n        } else {\n            const line = this.appendFormatTag(container, null);\n            if (line) this.setRange(line, 0, line, 0);\n        }\n    },\n\n    update_image: function (init, openController, notHistoryPush) {\n        const contextImage = this.context.image;\n        let imageEl = contextImage._element;\n        let cover = contextImage._cover;\n        let container = contextImage._container;\n        let isNewContainer = false;\n\n        if (cover === null) {\n            isNewContainer = true;\n            imageEl = contextImage._element.cloneNode(true);\n            cover = this.plugins.component.set_cover.call(this, imageEl);\n        }\n\n        if (container === null) {\n            cover = cover.cloneNode(true);\n            imageEl = cover.querySelector('img');\n            isNewContainer = true;\n            container = this.plugins.component.set_container.call(this, cover, 'se-image-container');\n        } else if (isNewContainer) {\n            container.innerHTML = '';\n            container.appendChild(cover);\n            contextImage._cover = cover;\n            contextImage._element = imageEl;\n            isNewContainer = false;\n        }\n\n        // check size\n        let changeSize;\n        const x = this.util.isNumber(contextImage.inputX.value) ? contextImage.inputX.value + contextImage.sizeUnit : contextImage.inputX.value;\n        const y = this.util.isNumber(contextImage.inputY.value) ? contextImage.inputY.value + contextImage.sizeUnit : contextImage.inputY.value;\n        if (/%$/.test(imageEl.style.width)) {\n            changeSize = x !== container.style.width || y !== container.style.height;\n        } else {\n            changeSize = x !== imageEl.style.width || y !== imageEl.style.height;\n        }\n\n        // alt\n        imageEl.alt = contextImage._altText;\n        \n        // caption\n        let modifiedCaption = false;\n        if (contextImage._captionChecked) {\n            if (!contextImage._caption) {\n                contextImage._caption = this.plugins.component.create_caption.call(this);\n                cover.appendChild(contextImage._caption);\n                modifiedCaption = true;\n            }\n        } else {\n            if (contextImage._caption) {\n                this.util.removeItem(contextImage._caption);\n                contextImage._caption = null;\n                modifiedCaption = true;\n            }\n        }\n\n        // link\n        let isNewAnchor = null;\n        const anchor = this.plugins.anchor.createAnchor.call(this, contextImage.anchorCtx, true);\n        if (anchor) {\n            if (contextImage._linkElement !== anchor || (isNewContainer && !container.contains(anchor))) {\n                contextImage._linkElement = anchor.cloneNode(false);\n                cover.insertBefore(this.plugins.image.onRender_link.call(this, imageEl, contextImage._linkElement), contextImage._caption);\n                isNewAnchor = contextImage._element;\n            } else {\n                contextImage._linkElement.setAttribute('data-image-link', 'image');\n            }\n        } else if (contextImage._linkElement !== null) {\n            const imageElement = imageEl;\n            imageElement.setAttribute('data-image-link', '');\n            if (cover.contains(contextImage._linkElement)) {\n                const newEl = imageElement.cloneNode(true);\n                cover.removeChild(contextImage._linkElement);\n                cover.insertBefore(newEl, contextImage._caption);\n                contextImage._element = imageEl = newEl;\n            }\n        }\n\n        let existElement = null;\n        if (isNewContainer) {\n            existElement = (this.util.isRangeFormatElement(contextImage._element.parentNode) || this.util.isWysiwygDiv(contextImage._element.parentNode)) ? \n                contextImage._element : \n                this.util.isAnchor(contextImage._element.parentNode) ? contextImage._element.parentNode : this.util.getFormatElement(contextImage._element) || contextImage._element;\n                \n            if (this.util.getParentElement(contextImage._element, this.util.isNotCheckingNode)) {\n                existElement = isNewAnchor ? anchor : contextImage._element;\n                existElement.parentNode.replaceChild(container, existElement);\n            } else if (this.util.isListCell(existElement)) {\n                const refer = this.util.getParentElement(contextImage._element, function (current) { return current.parentNode === existElement; });\n                existElement.insertBefore(container, refer);\n                this.util.removeItem(contextImage._element);\n                this.util.removeEmptyNode(refer, null, true);\n            } else if (this.util.isFormatElement(existElement)) {\n                const refer = this.util.getParentElement(contextImage._element, function (current) { return current.parentNode === existElement; });\n                existElement = this.util.splitElement(existElement, refer);\n                existElement.parentNode.insertBefore(container, existElement);\n                this.util.removeItem(contextImage._element);\n                this.util.removeEmptyNode(existElement, null, true);\n                if (existElement.children.length === 0) existElement.innerHTML = this.util.htmlRemoveWhiteSpace(existElement.innerHTML);\n            } else {\n                if (this.util.isFormatElement(existElement.parentNode)) {\n                    const formats = existElement.parentNode;\n                    formats.parentNode.insertBefore(container, existElement.previousSibling ? formats.nextElementSibling : formats);\n                    if (contextImage.__updateTags.map(function (current) { return existElement.contains(current); }).length === 0) this.util.removeItem(existElement);\n                } else {\n                    existElement.parentNode.replaceChild(container, existElement);\n                }\n            }\n\n            imageEl = container.querySelector('img');\n\n            contextImage._element = imageEl;\n            contextImage._cover = cover;\n            contextImage._container = container;\n        }\n\n        if (isNewAnchor) {\n            if (!isNewContainer) {\n                this.util.removeItem(anchor);\n            } else {\n                this.util.removeItem(isNewAnchor);\n                if (this.util.getListChildren(anchor, function (current) { return /IMG/i.test(current.tagName); }).length === 0) {\n                    this.util.removeItem(anchor);\n                }\n            }\n        }\n\n        // transform\n        if (modifiedCaption || (!contextImage._onlyPercentage && changeSize)) {\n            if (!init && (/\\d+/.test(imageEl.style.height) || (this.context.resizing._rotateVertical && contextImage._captionChecked))) {\n                if (/%$/.test(contextImage.inputX.value) || /%$/.test(contextImage.inputY.value)) {\n                    this.plugins.resizing.resetTransform.call(this, imageEl);\n                } else {\n                    this.plugins.resizing.setTransformSize.call(this, imageEl, this.util.getNumber(contextImage.inputX.value, 0), this.util.getNumber(contextImage.inputY.value, 0));\n                }\n            }\n        }\n\n        // size\n        if (contextImage._resizing) {\n            imageEl.setAttribute('data-proportion', contextImage._proportionChecked);\n            if (changeSize) {\n                this.plugins.image.applySize.call(this);\n            }\n        }\n\n        // align\n        this.plugins.image.setAlign.call(this, null, imageEl, null, null);\n\n        // set imagesInfo\n        if (init) {\n            this.plugins.fileManager.setInfo.call(this, 'image', imageEl, this.functions.onImageUpload, null, true);\n        }\n\n        if (openController) {\n            this.selectComponent(imageEl, 'image');\n        }\n\n        // history stack\n        if (!notHistoryPush) this.history.push(false);\n    },\n\n    update_src: function (src, element, file) {\n        element.src = src;\n        this._w.setTimeout(this.plugins.fileManager.setInfo.bind(this, 'image', element, this.functions.onImageUpload, file, true));\n        this.selectComponent(element, 'image');\n    },\n\n    /**\n     * @Required @Override fileManager, resizing\n     */\n    onModifyMode: function (element, size) {\n        if (!element) return;\n        \n        const contextImage = this.context.image;\n        contextImage._linkElement = contextImage.anchorCtx.linkAnchor = this.util.isAnchor(element.parentNode) ? element.parentNode : null;\n        contextImage._element = element;\n        contextImage._cover = this.util.getParentElement(element, 'FIGURE');\n        contextImage._container = this.util.getParentElement(element, this.util.isMediaComponent);\n        contextImage._caption = this.util.getChildElement(contextImage._cover, 'FIGCAPTION');\n        contextImage._align =  element.getAttribute('data-align') || element.style.float || 'none';\n        element.style.float = '';\n        this.plugins.anchor.setCtx(contextImage._linkElement, contextImage.anchorCtx);\n\n        if (size) {\n            contextImage._element_w = size.w;\n            contextImage._element_h = size.h;\n            contextImage._element_t = size.t;\n            contextImage._element_l = size.l;\n        }\n\n        let userSize = contextImage._element.getAttribute('data-size') || contextImage._element.getAttribute('data-origin');\n        let w, h;\n        if (userSize) {\n            userSize = userSize.split(',');\n            w = userSize[0];\n            h = userSize[1];\n        } else if (size) {\n            w = size.w;\n            h = size.h;\n        }\n\n        contextImage._origin_w = w || element.style.width || element.width || '';\n        contextImage._origin_h = h || element.style.height || element.height || '';\n    },\n\n    /**\n     * @Required @Override fileManager, resizing\n     */\n    openModify: function (notOpen) {\n        const contextImage = this.context.image;\n        if (contextImage.imgUrlFile) {\n            contextImage._v_src._linkValue = contextImage.previewSrc.textContent = contextImage.imgUrlFile.value = contextImage._element.src;\n        }\n        contextImage._altText = contextImage.altText.value = contextImage._element.alt;\n        (contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"][value=\"' + contextImage._align + '\"]') || contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"][value=\"none\"]')).checked = true;\n        contextImage._align = contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"]:checked').value;\n        contextImage._captionChecked = contextImage.captionCheckEl.checked = !!contextImage._caption;\n        \n        if (contextImage._resizing) {\n            this.plugins.resizing._module_setModifyInputSize.call(this, contextImage, this.plugins.image);\n        }\n\n        if (!notOpen) this.plugins.dialog.open.call(this, 'image', true);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    applySize: function (w, h) {\n        const contextImage = this.context.image;\n\n        if (!w) w = contextImage.inputX.value || this.options.imageWidth;\n        if (!h) h = contextImage.inputY.value || this.options.imageHeight;\n        \n        if ((contextImage._onlyPercentage && !!w) || /%$/.test(w)) {\n            this.plugins.image.setPercentSize.call(this, w, h);\n            return true;\n        } else if ((!w || w === 'auto') && (!h || h === 'auto')) {\n            this.plugins.image.setAutoSize.call(this);\n        } else {\n            this.plugins.image.setSize.call(this, w, h, false);\n        }\n\n        return false;\n    },\n\n    /**\n     * @Override resizing\n     */\n    sizeRevert: function () {\n        this.plugins.resizing._module_sizeRevert.call(this, this.context.image);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setSize: function (w, h, notResetPercentage, direction) {\n        const contextImage = this.context.image;\n        const onlyW = /^(rw|lw)$/.test(direction) && /\\d+/.test(contextImage._element.style.height);\n        const onlyH = /^(th|bh)$/.test(direction) && /\\d+/.test(contextImage._element.style.width);\n\n        if (!onlyH) {\n            contextImage._element.style.width = this.util.isNumber(w) ? w + contextImage.sizeUnit : w;\n            this.plugins.image.cancelPercentAttr.call(this);\n        }\n        if (!onlyW) {\n            contextImage._element.style.height = this.util.isNumber(h) ? h + contextImage.sizeUnit : /%$/.test(h) ? '' : h;\n        }\n\n        if (contextImage._align === 'center') this.plugins.image.setAlign.call(this, null, null, null, null);\n        if (!notResetPercentage) contextImage._element.removeAttribute('data-percentage');\n\n        // save current size\n        this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setAutoSize: function () {\n        const contextImage = this.context.image;\n\n        if (contextImage._caption) contextImage._caption.style.marginTop = '';\n        this.plugins.resizing.resetTransform.call(this, contextImage._element);\n        this.plugins.image.cancelPercentAttr.call(this);\n\n        contextImage._element.style.maxWidth = '';\n        contextImage._element.style.width = '';\n        contextImage._element.style.height = '';\n        contextImage._cover.style.width = '';\n        contextImage._cover.style.height = '';\n\n        this.plugins.image.setAlign.call(this, null, null, null, null);\n        contextImage._element.setAttribute('data-percentage', 'auto,auto');\n\n        // save current size\n        this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n    },\n    \n    /**\n     * @Override resizing\n     */\n    setOriginSize: function () {\n        const contextImage = this.context.image;\n        contextImage._element.removeAttribute('data-percentage');\n\n        this.plugins.resizing.resetTransform.call(this, contextImage._element);\n        this.plugins.image.cancelPercentAttr.call(this);\n\n        const originSize = (contextImage._element.getAttribute('data-origin') || '').split(',');\n        const w = originSize[0];\n        const h = originSize[1];\n\n        if (originSize) {\n            if (contextImage._onlyPercentage || (/%$/.test(w) && (/%$/.test(h) || !/\\d/.test(h)))) {\n                this.plugins.image.setPercentSize.call(this, w, h);\n            } else {\n                this.plugins.image.setSize.call(this, w, h);\n            }\n\n            // save current size\n            this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n        }\n    },\n\n    /**\n     * @Override resizing\n     */\n    setPercentSize: function (w, h) {\n        const contextImage = this.context.image;\n        h = !!h && !/%$/.test(h) && !this.util.getNumber(h, 0) ? this.util.isNumber(h) ? h + '%' : h : this.util.isNumber(h) ? h + contextImage.sizeUnit : (h || '');\n        const heightPercentage = /%$/.test(h);\n\n        contextImage._container.style.width = this.util.isNumber(w) ? w + '%' : w;\n        contextImage._container.style.height = '';\n        contextImage._cover.style.width = '100%';\n        contextImage._cover.style.height = !heightPercentage ? '' : h;\n        contextImage._element.style.width = '100%';\n        contextImage._element.style.height = heightPercentage ? '' : h;\n        contextImage._element.style.maxWidth = '';\n\n        if (contextImage._align === 'center') this.plugins.image.setAlign.call(this, null, null, null, null);\n\n        contextImage._element.setAttribute('data-percentage', w + ',' + h);\n        this.plugins.resizing.setCaptionPosition.call(this, contextImage._element);\n\n        // save current size\n        this.plugins.resizing._module_saveCurrentSize.call(this, contextImage);\n    },\n\n    /**\n     * @Override resizing\n     */\n    cancelPercentAttr: function () {\n        const contextImage = this.context.image;\n        \n        contextImage._cover.style.width = '';\n        contextImage._cover.style.height = '';\n        contextImage._container.style.width = '';\n        contextImage._container.style.height = '';\n\n        this.util.removeClass(contextImage._container, this.context.image._floatClassRegExp);\n        this.util.addClass(contextImage._container, '__se__float-' + contextImage._align);\n\n        if (contextImage._align === 'center') this.plugins.image.setAlign.call(this, null, null, null, null);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setAlign: function (align, element, cover, container) {\n        const contextImage = this.context.image;\n        \n        if (!align) align = contextImage._align;\n        if (!element) element = contextImage._element;\n        if (!cover) cover = contextImage._cover;\n        if (!container) container = contextImage._container;\n\n        if (/%$/.test(element.style.width) && align === 'center') {\n            container.style.minWidth = '100%';\n            cover.style.width = container.style.width;\n        } else {\n            container.style.minWidth = '';\n            cover.style.width = this.context.resizing._rotateVertical ? (element.style.height || element.offsetHeight) : ((!element.style.width || element.style.width === 'auto') ? '' : element.style.width || '100%');\n        }\n\n        if (!this.util.hasClass(container, '__se__float-' + align)) {\n            this.util.removeClass(container, contextImage._floatClassRegExp);\n            this.util.addClass(container, '__se__float-' + align);\n        }\n        \n        element.setAttribute('data-align', align);\n    },\n\n    /**\n     * @Override dialog\n     */\n    init: function () {\n        const contextImage = this.context.image;\n        if (contextImage.imgInputFile) contextImage.imgInputFile.value = '';\n        if (contextImage.imgUrlFile) contextImage._v_src._linkValue = contextImage.previewSrc.textContent = contextImage.imgUrlFile.value = '';\n        if (contextImage.imgInputFile && contextImage.imgUrlFile) {\n            contextImage.imgUrlFile.removeAttribute('disabled');\n            contextImage.previewSrc.style.textDecoration = '';\n        }\n\n        contextImage.altText.value = '';\n        contextImage.modal.querySelector('input[name=\"suneditor_image_radio\"][value=\"none\"]').checked = true;\n        contextImage.captionCheckEl.checked = false;\n        contextImage._element = null;\n        this.plugins.image.openTab.call(this, 'init');\n\n        if (contextImage._resizing) {\n            contextImage.inputX.value = this.options.imageWidth === contextImage._defaultSizeX ? '' : this.options.imageWidth;\n            contextImage.inputY.value = this.options.imageHeight === contextImage._defaultSizeY ? '' : this.options.imageHeight;\n            contextImage.proportion.checked = true;\n            contextImage._ratio = false;\n            contextImage._ratioX = 1;\n            contextImage._ratioY = 1;\n        }\n\n        this.plugins.anchor.init.call(this, contextImage.anchorCtx);\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}