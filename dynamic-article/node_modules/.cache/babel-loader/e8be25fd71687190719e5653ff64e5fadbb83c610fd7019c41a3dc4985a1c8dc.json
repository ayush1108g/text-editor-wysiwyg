{"ast":null,"code":"/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nimport dialog from '../modules/dialog';\nimport component from '../modules/component';\nimport fileManager from '../modules/fileManager';\nexport default {\n  name: 'audio',\n  display: 'dialog',\n  add: function (core) {\n    core.addModule([dialog, component, fileManager]);\n    const context = core.context;\n    const contextAudio = context.audio = {\n      _infoList: [],\n      // @Override fileManager\n      _infoIndex: 0,\n      // @Override fileManager\n      _uploadFileLength: 0,\n      // @Override fileManager\n      focusElement: null,\n      // @Override dialog // This element has focus when the dialog is opened.\n      targetSelect: null,\n      _origin_w: core.options.audioWidth,\n      _origin_h: core.options.audioHeight,\n      _linkValue: '',\n      // @require @Override component\n      _element: null,\n      _cover: null,\n      _container: null\n    };\n\n    /** dialog */\n    let audio_dialog = this.setDialog(core);\n    contextAudio.modal = audio_dialog;\n    contextAudio.audioInputFile = audio_dialog.querySelector('._se_audio_files');\n    contextAudio.audioUrlFile = audio_dialog.querySelector('.se-input-url');\n    contextAudio.focusElement = contextAudio.audioInputFile || contextAudio.audioUrlFile;\n    contextAudio.preview = audio_dialog.querySelector('.se-link-preview');\n\n    /** controller */\n    let audio_controller = this.setController(core);\n    contextAudio.controller = audio_controller;\n\n    /** add event listeners */\n    audio_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core));\n    if (contextAudio.audioInputFile) audio_dialog.querySelector('.se-dialog-files-edge-button').addEventListener('click', this._removeSelectedFiles.bind(contextAudio.audioInputFile, contextAudio.audioUrlFile, contextAudio.preview));\n    if (contextAudio.audioInputFile && contextAudio.audioUrlFile) contextAudio.audioInputFile.addEventListener('change', this._fileInputChange.bind(contextAudio));\n    audio_controller.addEventListener('click', this.onClick_controller.bind(core));\n    if (contextAudio.audioUrlFile) contextAudio.audioUrlFile.addEventListener('input', this._onLinkPreview.bind(contextAudio.preview, contextAudio, core.options.linkProtocol));\n\n    /** append html */\n    context.dialog.modal.appendChild(audio_dialog);\n\n    /** append controller */\n    context.element.relative.appendChild(audio_controller);\n\n    /** empty memory */\n    audio_dialog = null, audio_controller = null;\n  },\n  /** HTML - dialog */\n  setDialog: function (core) {\n    const option = core.options;\n    const lang = core.lang;\n    const dialog = core.util.createElement('DIV');\n    dialog.className = 'se-dialog-content';\n    dialog.style.display = 'none';\n    let html = '' + '<form method=\"post\" enctype=\"multipart/form-data\">' + '<div class=\"se-dialog-header\">' + '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' + core.icons.cancel + '</button>' + '<span class=\"se-modal-title\">' + lang.dialogBox.audioBox.title + '</span>' + '</div>' + '<div class=\"se-dialog-body\">';\n    if (option.audioFileInput) {\n      html += '' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.audioBox.file + '</label>' + '<div class=\"se-dialog-form-files\">' + '<input class=\"se-input-form _se_audio_files\" type=\"file\" accept=\"' + option.audioAccept + '\"' + (option.audioMultipleFile ? ' multiple=\"multiple\"' : '') + '/>' + '<button type=\"button\" data-command=\"filesRemove\" class=\"se-btn se-dialog-files-edge-button se-file-remove\" title=\"' + lang.controller.remove + '\" aria-label=\"' + lang.controller.remove + '\">' + core.icons.cancel + '</button>' + '</div>' + '</div>';\n    }\n    if (option.audioUrlInput) {\n      html += '' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.audioBox.url + '</label>' + '<input class=\"se-input-form se-input-url\" type=\"text\" />' + '<pre class=\"se-link-preview\"></pre>' + '</div>';\n    }\n    html += '' + '</div>' + '<div class=\"se-dialog-footer\">' + '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' + '</div>' + '</form>';\n    dialog.innerHTML = html;\n    return dialog;\n  },\n  /** HTML - controller */\n  setController: function (core) {\n    const lang = core.lang;\n    const icons = core.icons;\n    const link_btn = core.util.createElement('DIV');\n    link_btn.className = 'se-controller se-controller-link';\n    link_btn.innerHTML = '' + '<div class=\"se-arrow se-arrow-up\"></div>' + '<div class=\"link-content\">' + '<div class=\"se-btn-group\">' + '<button type=\"button\" data-command=\"update\" tabindex=\"-1\" class=\"se-tooltip\">' + icons.edit + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.edit + '</span></span>' + '</button>' + '<button type=\"button\" data-command=\"delete\" tabindex=\"-1\" class=\"se-tooltip\">' + icons.delete + '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.remove + '</span></span>' + '</button>' + '</div>' + '</div>';\n    return link_btn;\n  },\n  // Disable url input when uploading files\n  _fileInputChange: function () {\n    if (!this.audioInputFile.value) {\n      this.audioUrlFile.removeAttribute('disabled');\n      this.preview.style.textDecoration = '';\n    } else {\n      this.audioUrlFile.setAttribute('disabled', true);\n      this.preview.style.textDecoration = 'line-through';\n    }\n  },\n  // Disable url input when uploading files\n  _removeSelectedFiles: function (urlInput, preview) {\n    this.value = '';\n    if (urlInput) {\n      urlInput.removeAttribute('disabled');\n      preview.style.textDecoration = '';\n    }\n  },\n  // create new audio tag\n  _createAudioTag: function () {\n    const oAudio = this.util.createElement('AUDIO');\n    this.plugins.audio._setTagAttrs.call(this, oAudio);\n    const w = this.context.audio._origin_w;\n    const h = this.context.audio._origin_h;\n    oAudio.setAttribute('origin-size', w + ',' + h);\n    oAudio.style.cssText = (w ? 'width:' + w + '; ' : '') + (h ? 'height:' + h + ';' : '');\n    return oAudio;\n  },\n  _setTagAttrs: function (element) {\n    element.setAttribute('controls', true);\n    const attrs = this.options.audioTagAttrs;\n    if (!attrs) return;\n    for (let key in attrs) {\n      if (!this.util.hasOwn(attrs, key)) continue;\n      element.setAttribute(key, attrs[key]);\n    }\n  },\n  _onLinkPreview: function (context, protocol, e) {\n    const value = e.target.value.trim();\n    context._linkValue = this.textContent = !value ? '' : protocol && value.indexOf('://') === -1 && value.indexOf('#') !== 0 ? protocol + value : value.indexOf('://') === -1 ? '/' + value : value;\n  },\n  /**\n   * @Required @Override fileManager\n   */\n  fileTags: ['audio'],\n  /**\n   * @Override core, fileManager, resizing\n   * @description It is called from core.selectComponent.\n   * @param {Element} element Target element\n   */\n  select: function (element) {\n    this.plugins.audio.onModifyMode.call(this, element);\n  },\n  /**\n   * @Override fileManager, resizing \n   */\n  destroy: function (element) {\n    element = element || this.context.audio._element;\n    const container = this.util.getParentElement(element, this.util.isComponent) || element;\n    const dataIndex = element.getAttribute('data-index') * 1;\n    const focusEl = container.previousElementSibling || container.nextElementSibling;\n    const emptyDiv = container.parentNode;\n    this.util.removeItem(container);\n    this.plugins.audio.init.call(this);\n    this.controllersOff();\n    if (emptyDiv !== this.context.element.wysiwyg) this.util.removeItemAllParents(emptyDiv, function (current) {\n      return current.childNodes.length === 0;\n    }, null);\n\n    // focus\n    this.focusEdge(focusEl);\n\n    // fileManager event\n    this.plugins.fileManager.deleteInfo.call(this, 'audio', dataIndex, this.functions.onAudioUpload);\n\n    // history stack\n    this.history.push(false);\n  },\n  /**\n   * @Override fileManager\n   */\n  checkFileInfo: function () {\n    this.plugins.fileManager.checkInfo.call(this, 'audio', ['audio'], this.functions.onAudioUpload, this.plugins.audio.updateCover.bind(this), false);\n  },\n  /**\n   * @Override fileManager\n   */\n  resetFileInfo: function () {\n    this.plugins.fileManager.resetInfo.call(this, 'audio', this.functions.onAudioUpload);\n  },\n  /**\n   * @Required @Override dialog\n   */\n  on: function (update) {\n    const contextAudio = this.context.audio;\n    if (!update) {\n      this.plugins.audio.init.call(this);\n      if (contextAudio.audioInputFile && this.options.audioMultipleFile) contextAudio.audioInputFile.setAttribute('multiple', 'multiple');\n    } else if (contextAudio._element) {\n      this.context.dialog.updateModal = true;\n      contextAudio._linkValue = contextAudio.preview.textContent = contextAudio.audioUrlFile.value = contextAudio._element.src;\n      if (contextAudio.audioInputFile && this.options.audioMultipleFile) contextAudio.audioInputFile.removeAttribute('multiple');\n    } else {\n      if (contextAudio.audioInputFile && this.options.audioMultipleFile) contextAudio.audioInputFile.removeAttribute('multiple');\n    }\n  },\n  /**\n   * @Required @Override dialog\n   */\n  open: function () {\n    this.plugins.dialog.open.call(this, 'audio', 'audio' === this.currentControllerName);\n  },\n  submit: function (e) {\n    const contextAudio = this.context.audio;\n    e.preventDefault();\n    e.stopPropagation();\n    try {\n      if (contextAudio.audioInputFile && contextAudio.audioInputFile.files.length > 0) {\n        this.showLoading();\n        this.plugins.audio.submitAction.call(this, contextAudio.audioInputFile.files);\n      } else if (contextAudio.audioUrlFile && contextAudio._linkValue.length > 0) {\n        this.showLoading();\n        this.plugins.audio.setupUrl.call(this, contextAudio._linkValue);\n      }\n    } catch (error) {\n      this.closeLoading();\n      throw Error('[SUNEDITOR.audio.submit.fail] cause : \"' + error.message + '\"');\n    } finally {\n      this.plugins.dialog.close.call(this);\n    }\n    return false;\n  },\n  submitAction: function (fileList) {\n    if (fileList.length === 0) return;\n    let fileSize = 0;\n    let files = [];\n    for (let i = 0, len = fileList.length; i < len; i++) {\n      if (/audio/i.test(fileList[i].type)) {\n        files.push(fileList[i]);\n        fileSize += fileList[i].size;\n      }\n    }\n    const limitSize = this.options.audioUploadSizeLimit;\n    if (limitSize > 0) {\n      let infoSize = 0;\n      const audiosInfo = this.context.audio._infoList;\n      for (let i = 0, len = audiosInfo.length; i < len; i++) {\n        infoSize += audiosInfo[i].size * 1;\n      }\n      if (fileSize + infoSize > limitSize) {\n        this.closeLoading();\n        const err = '[SUNEDITOR.audioUpload.fail] Size of uploadable total audios: ' + limitSize / 1000 + 'KB';\n        if (typeof this.functions.onAudioUploadError !== 'function' || this.functions.onAudioUploadError(err, {\n          'limitSize': limitSize,\n          'currentSize': infoSize,\n          'uploadSize': fileSize\n        }, this)) {\n          this.functions.noticeOpen(err);\n        }\n        return;\n      }\n    }\n    const contextAudio = this.context.audio;\n    contextAudio._uploadFileLength = files.length;\n    const info = {\n      isUpdate: this.context.dialog.updateModal,\n      element: contextAudio._element\n    };\n    if (typeof this.functions.onAudioUploadBefore === 'function') {\n      const result = this.functions.onAudioUploadBefore(files, info, this, function (data) {\n        if (data && this._w.Array.isArray(data.result)) {\n          this.plugins.audio.register.call(this, info, data);\n        } else {\n          this.plugins.audio.upload.call(this, info, data);\n        }\n      }.bind(this));\n      if (typeof result === 'undefined') return;\n      if (!result) {\n        this.closeLoading();\n        return;\n      }\n      if (typeof result === 'object' && result.length > 0) files = result;\n    }\n    this.plugins.audio.upload.call(this, info, files);\n  },\n  error: function (message, response) {\n    this.closeLoading();\n    if (typeof this.functions.onAudioUploadError !== 'function' || this.functions.onAudioUploadError(message, response, this)) {\n      this.functions.noticeOpen(message);\n      throw Error('[SUNEDITOR.plugin.audio.exception] response: ' + message);\n    }\n  },\n  upload: function (info, files) {\n    if (!files) {\n      this.closeLoading();\n      return;\n    }\n    if (typeof files === 'string') {\n      this.plugins.audio.error.call(this, files, null);\n      return;\n    }\n    const audioUploadUrl = this.options.audioUploadUrl;\n    const filesLen = this.context.dialog.updateModal ? 1 : files.length;\n\n    // create formData\n    const formData = new FormData();\n    for (let i = 0; i < filesLen; i++) {\n      formData.append('file-' + i, files[i]);\n    }\n\n    // server upload\n    this.plugins.fileManager.upload.call(this, audioUploadUrl, this.options.audioUploadHeader, formData, this.plugins.audio.callBack_upload.bind(this, info), this.functions.onAudioUploadError);\n  },\n  callBack_upload: function (info, xmlHttp) {\n    if (typeof this.functions.audioUploadHandler === 'function') {\n      this.functions.audioUploadHandler(xmlHttp, info, this);\n    } else {\n      const response = JSON.parse(xmlHttp.responseText);\n      if (response.errorMessage) {\n        this.plugins.audio.error.call(this, response.errorMessage, response);\n      } else {\n        this.plugins.audio.register.call(this, info, response);\n      }\n    }\n  },\n  register: function (info, response) {\n    const fileList = response.result;\n    for (let i = 0, len = fileList.length, file, oAudio; i < len; i++) {\n      if (info.isUpdate) oAudio = info.element;else oAudio = this.plugins.audio._createAudioTag.call(this);\n      file = {\n        name: fileList[i].name,\n        size: fileList[i].size\n      };\n      this.plugins.audio.create_audio.call(this, oAudio, fileList[i].url, file, info.isUpdate);\n    }\n    this.closeLoading();\n  },\n  setupUrl: function (src) {\n    try {\n      if (src.length === 0) return false;\n      this.plugins.audio.create_audio.call(this, this.plugins.audio._createAudioTag.call(this), src, null, this.context.dialog.updateModal);\n    } catch (error) {\n      throw Error('[SUNEDITOR.audio.audio.fail] cause : \"' + error.message + '\"');\n    } finally {\n      this.closeLoading();\n    }\n  },\n  create_audio: function (element, src, file, isUpdate) {\n    const contextAudio = this.context.audio;\n\n    // create new tag\n    if (!isUpdate) {\n      element.src = src;\n      const cover = this.plugins.component.set_cover.call(this, element);\n      const container = this.plugins.component.set_container.call(this, cover, '');\n      if (!this.insertComponent(container, false, true, !this.options.mediaAutoSelect)) {\n        this.focus();\n        return;\n      }\n      if (!this.options.mediaAutoSelect) {\n        const line = this.appendFormatTag(container, null);\n        if (line) this.setRange(line, 0, line, 0);\n      }\n    } // update\n    else {\n      if (contextAudio._element) element = contextAudio._element;\n      if (element && element.src !== src) {\n        element.src = src;\n        this.selectComponent(element, 'audio');\n      } else {\n        this.selectComponent(element, 'audio');\n        return;\n      }\n    }\n    this.plugins.fileManager.setInfo.call(this, 'audio', element, this.functions.onAudioUpload, file, false);\n    if (isUpdate) this.history.push(false);\n  },\n  updateCover: function (element) {\n    const contextAudio = this.context.audio;\n    this.plugins.audio._setTagAttrs.call(this, element);\n\n    // find component element\n    let existElement = this.util.isRangeFormatElement(element.parentNode) || this.util.isWysiwygDiv(element.parentNode) ? element : this.util.getFormatElement(element) || element;\n\n    // clone element\n    const prevElement = element;\n    contextAudio._element = element = element.cloneNode(false);\n    const cover = this.plugins.component.set_cover.call(this, element);\n    const container = this.plugins.component.set_container.call(this, cover, 'se-audio-container');\n    try {\n      if (this.util.getParentElement(prevElement, this.util.isNotCheckingNode)) {\n        prevElement.parentNode.replaceChild(container, prevElement);\n      } else if (this.util.isListCell(existElement)) {\n        const refer = this.util.getParentElement(prevElement, function (current) {\n          return current.parentNode === existElement;\n        });\n        existElement.insertBefore(container, refer);\n        this.util.removeItem(prevElement);\n        this.util.removeEmptyNode(refer, null, true);\n      } else if (this.util.isFormatElement(existElement)) {\n        const refer = this.util.getParentElement(prevElement, function (current) {\n          return current.parentNode === existElement;\n        });\n        existElement = this.util.splitElement(existElement, refer);\n        existElement.parentNode.insertBefore(container, existElement);\n        this.util.removeItem(prevElement);\n        this.util.removeEmptyNode(existElement, null, true);\n        if (existElement.children.length === 0) existElement.innerHTML = this.util.htmlRemoveWhiteSpace(existElement.innerHTML);\n      } else {\n        existElement.parentNode.replaceChild(container, existElement);\n      }\n    } catch (error) {\n      console.warn('[SUNEDITOR.audio.error] Maybe the audio tag is nested.', error);\n    }\n    this.plugins.fileManager.setInfo.call(this, 'audio', element, this.functions.onAudioUpload, null, false);\n    this.plugins.audio.init.call(this);\n  },\n  /**\n   * @Required @Override fileManager, resizing\n   */\n  onModifyMode: function (selectionTag) {\n    const contextAudio = this.context.audio;\n    this.setControllerPosition(contextAudio.controller, selectionTag, 'bottom', {\n      left: 0,\n      top: 0\n    });\n    this.controllersOn(contextAudio.controller, selectionTag, this.plugins.audio.onControllerOff.bind(this, selectionTag), 'audio');\n    this.util.addClass(selectionTag, 'active');\n    contextAudio._element = selectionTag;\n    contextAudio._cover = this.util.getParentElement(selectionTag, 'FIGURE');\n    contextAudio._container = this.util.getParentElement(selectionTag, this.util.isComponent);\n  },\n  /**\n   * @Required @Override fileManager, resizing\n   */\n  openModify: function (notOpen) {\n    if (this.context.audio.audioUrlFile) {\n      const contextAudio = this.context.audio;\n      contextAudio._linkValue = contextAudio.preview.textContent = contextAudio.audioUrlFile.value = contextAudio._element.src;\n    }\n    if (!notOpen) this.plugins.dialog.open.call(this, 'audio', true);\n  },\n  onClick_controller: function (e) {\n    e.stopPropagation();\n    const command = e.target.getAttribute('data-command');\n    if (!command) return;\n    e.preventDefault();\n    if (/update/.test(command)) {\n      this.plugins.audio.openModify.call(this, false);\n    } else {\n      /** delete */\n      this.plugins.audio.destroy.call(this, this.context.audio._element);\n    }\n    this.controllersOff();\n  },\n  onControllerOff: function (selectionTag) {\n    this.util.removeClass(selectionTag, 'active');\n    this.context.audio.controller.style.display = 'none';\n  },\n  /**\n   * @Required @Override dialog\n   */\n  init: function () {\n    if (this.context.dialog.updateModal) return;\n    const contextAudio = this.context.audio;\n    if (contextAudio.audioInputFile) contextAudio.audioInputFile.value = '';\n    if (contextAudio.audioUrlFile) contextAudio._linkValue = contextAudio.preview.textContent = contextAudio.audioUrlFile.value = '';\n    if (contextAudio.audioInputFile && contextAudio.audioUrlFile) {\n      contextAudio.audioUrlFile.removeAttribute('disabled');\n      contextAudio.preview.style.textDecoration = '';\n    }\n    contextAudio._element = null;\n  }\n};","map":{"version":3,"names":["dialog","component","fileManager","name","display","add","core","addModule","context","contextAudio","audio","_infoList","_infoIndex","_uploadFileLength","focusElement","targetSelect","_origin_w","options","audioWidth","_origin_h","audioHeight","_linkValue","_element","_cover","_container","audio_dialog","setDialog","modal","audioInputFile","querySelector","audioUrlFile","preview","audio_controller","setController","controller","addEventListener","submit","bind","_removeSelectedFiles","_fileInputChange","onClick_controller","_onLinkPreview","linkProtocol","appendChild","element","relative","option","lang","util","createElement","className","style","html","dialogBox","close","icons","cancel","audioBox","title","audioFileInput","file","audioAccept","audioMultipleFile","remove","audioUrlInput","url","submitButton","innerHTML","link_btn","edit","delete","value","removeAttribute","textDecoration","setAttribute","urlInput","_createAudioTag","oAudio","plugins","_setTagAttrs","call","w","h","cssText","attrs","audioTagAttrs","key","hasOwn","protocol","e","target","trim","textContent","indexOf","fileTags","select","onModifyMode","destroy","container","getParentElement","isComponent","dataIndex","getAttribute","focusEl","previousElementSibling","nextElementSibling","emptyDiv","parentNode","removeItem","init","controllersOff","wysiwyg","removeItemAllParents","current","childNodes","length","focusEdge","deleteInfo","functions","onAudioUpload","history","push","checkFileInfo","checkInfo","updateCover","resetFileInfo","resetInfo","on","update","updateModal","src","open","currentControllerName","preventDefault","stopPropagation","files","showLoading","submitAction","setupUrl","error","closeLoading","Error","message","fileList","fileSize","i","len","test","type","size","limitSize","audioUploadSizeLimit","infoSize","audiosInfo","err","onAudioUploadError","noticeOpen","info","isUpdate","onAudioUploadBefore","result","data","_w","Array","isArray","register","upload","response","audioUploadUrl","filesLen","formData","FormData","append","audioUploadHeader","callBack_upload","xmlHttp","audioUploadHandler","JSON","parse","responseText","errorMessage","create_audio","cover","set_cover","set_container","insertComponent","mediaAutoSelect","focus","line","appendFormatTag","setRange","selectComponent","setInfo","existElement","isRangeFormatElement","isWysiwygDiv","getFormatElement","prevElement","cloneNode","isNotCheckingNode","replaceChild","isListCell","refer","insertBefore","removeEmptyNode","isFormatElement","splitElement","children","htmlRemoveWhiteSpace","console","warn","selectionTag","setControllerPosition","left","top","controllersOn","onControllerOff","addClass","openModify","notOpen","command","removeClass"],"sources":["E:/Programming/React/New folder (2)/dynamicArt/dynamic-article/node_modules/suneditor/src/plugins/dialog/audio.js"],"sourcesContent":["/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nimport dialog from '../modules/dialog';\nimport component from '../modules/component';\nimport fileManager from '../modules/fileManager';\n\nexport default {\n    name: 'audio',\n    display: 'dialog',\n    add: function (core) {\n        core.addModule([dialog, component, fileManager]);\n\n        const context = core.context;\n        const contextAudio = context.audio = {\n            _infoList: [], // @Override fileManager\n            _infoIndex: 0, // @Override fileManager\n            _uploadFileLength: 0, // @Override fileManager\n            focusElement: null, // @Override dialog // This element has focus when the dialog is opened.\n            targetSelect: null,\n            _origin_w: core.options.audioWidth,\n            _origin_h: core.options.audioHeight,\n            _linkValue: '',\n            // @require @Override component\n            _element: null,\n            _cover: null,\n            _container: null,\n        };\n\n        /** dialog */\n        let audio_dialog = this.setDialog(core);\n        contextAudio.modal = audio_dialog;\n        contextAudio.audioInputFile = audio_dialog.querySelector('._se_audio_files');\n        contextAudio.audioUrlFile = audio_dialog.querySelector('.se-input-url');\n        contextAudio.focusElement = contextAudio.audioInputFile || contextAudio.audioUrlFile;\n        contextAudio.preview = audio_dialog.querySelector('.se-link-preview');\n\n        /** controller */\n        let audio_controller = this.setController(core);\n        contextAudio.controller = audio_controller;\n\n        /** add event listeners */\n        audio_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core));\n        if (contextAudio.audioInputFile) audio_dialog.querySelector('.se-dialog-files-edge-button').addEventListener('click', this._removeSelectedFiles.bind(contextAudio.audioInputFile, contextAudio.audioUrlFile, contextAudio.preview));\n        if (contextAudio.audioInputFile && contextAudio.audioUrlFile) contextAudio.audioInputFile.addEventListener('change', this._fileInputChange.bind(contextAudio));\n        audio_controller.addEventListener('click', this.onClick_controller.bind(core));\n        if (contextAudio.audioUrlFile) contextAudio.audioUrlFile.addEventListener('input', this._onLinkPreview.bind(contextAudio.preview, contextAudio, core.options.linkProtocol));\n\n        /** append html */\n        context.dialog.modal.appendChild(audio_dialog);\n\n        /** append controller */\n        context.element.relative.appendChild(audio_controller);\n\n        /** empty memory */\n        audio_dialog = null, audio_controller = null;\n    },\n\n    /** HTML - dialog */\n    setDialog: function (core) {\n        const option = core.options;\n        const lang = core.lang;\n        const dialog = core.util.createElement('DIV');\n\n        dialog.className = 'se-dialog-content';\n        dialog.style.display = 'none';\n        let html = '' +\n            '<form method=\"post\" enctype=\"multipart/form-data\">' +\n                '<div class=\"se-dialog-header\">' +\n                    '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' +\n                        core.icons.cancel +\n                    '</button>' +\n                    '<span class=\"se-modal-title\">' + lang.dialogBox.audioBox.title + '</span>' +\n                '</div>' +\n                '<div class=\"se-dialog-body\">';\n\n                if (option.audioFileInput) {\n                    html += '' +\n                        '<div class=\"se-dialog-form\">' +\n                            '<label>' + lang.dialogBox.audioBox.file + '</label>' +\n                            '<div class=\"se-dialog-form-files\">' +\n                                '<input class=\"se-input-form _se_audio_files\" type=\"file\" accept=\"' + option.audioAccept + '\"' + (option.audioMultipleFile ? ' multiple=\"multiple\"' : '') + '/>' +\n                                '<button type=\"button\" data-command=\"filesRemove\" class=\"se-btn se-dialog-files-edge-button se-file-remove\" title=\"' + lang.controller.remove + '\" aria-label=\"' + lang.controller.remove + '\">' + core.icons.cancel + '</button>' +\n                            '</div>' +\n                        '</div>';\n                }\n                 \n                if (option.audioUrlInput) {\n                    html += '' +\n                        '<div class=\"se-dialog-form\">' +\n                            '<label>' + lang.dialogBox.audioBox.url + '</label>' +\n                            '<input class=\"se-input-form se-input-url\" type=\"text\" />' +\n                            '<pre class=\"se-link-preview\"></pre>' +\n                        '</div>';\n                }\n                    \n                html += '' +\n                '</div>' +\n                '<div class=\"se-dialog-footer\">' +\n                    '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' +\n                '</div>' +\n            '</form>';\n\n        dialog.innerHTML = html;\n\n        return dialog;\n    },\n\n    /** HTML - controller */\n    setController: function (core) {\n        const lang = core.lang;\n        const icons = core.icons;\n        const link_btn = core.util.createElement('DIV');\n\n        link_btn.className = 'se-controller se-controller-link';\n        link_btn.innerHTML = '' +\n            '<div class=\"se-arrow se-arrow-up\"></div>' +\n            '<div class=\"link-content\">' +\n                '<div class=\"se-btn-group\">' +\n                    '<button type=\"button\" data-command=\"update\" tabindex=\"-1\" class=\"se-tooltip\">' +\n                        icons.edit +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.edit + '</span></span>' +\n                    '</button>' +\n                    '<button type=\"button\" data-command=\"delete\" tabindex=\"-1\" class=\"se-tooltip\">' +\n                        icons.delete +\n                        '<span class=\"se-tooltip-inner\"><span class=\"se-tooltip-text\">' + lang.controller.remove + '</span></span>' +\n                    '</button>' +\n                '</div>' +\n            '</div>';\n\n        return link_btn;\n    },\n\n    // Disable url input when uploading files\n    _fileInputChange: function () {\n        if (!this.audioInputFile.value) {\n            this.audioUrlFile.removeAttribute('disabled');\n            this.preview.style.textDecoration = '';\n        } else {\n            this.audioUrlFile.setAttribute('disabled', true);\n            this.preview.style.textDecoration = 'line-through';\n        }\n    },\n\n    // Disable url input when uploading files\n    _removeSelectedFiles: function (urlInput, preview) {\n        this.value = '';\n        if (urlInput) {\n            urlInput.removeAttribute('disabled');\n            preview.style.textDecoration = '';\n        }\n    },\n\n    // create new audio tag\n    _createAudioTag: function () {\n        const oAudio = this.util.createElement('AUDIO');\n        this.plugins.audio._setTagAttrs.call(this, oAudio);\n\n        const w = this.context.audio._origin_w;\n        const h = this.context.audio._origin_h;\n        oAudio.setAttribute('origin-size', w + ',' + h);\n        oAudio.style.cssText = (w ? ('width:' + w + '; ') : '') + (h ? ('height:' + h + ';') : '');\n\n        return oAudio;\n    },\n\n    _setTagAttrs: function (element) {\n        element.setAttribute('controls', true);\n\n        const attrs = this.options.audioTagAttrs;\n        if (!attrs) return;\n\n        for (let key in attrs) {\n            if (!this.util.hasOwn(attrs, key)) continue;\n            element.setAttribute(key, attrs[key]);\n        }\n    },\n\n    _onLinkPreview: function (context, protocol, e) {\n        const value = e.target.value.trim();\n        context._linkValue = this.textContent = !value ? '' : (protocol && value.indexOf('://') === -1 && value.indexOf('#') !== 0) ? protocol + value : value.indexOf('://') === -1 ? '/' + value : value;\n    },\n\n    /**\n     * @Required @Override fileManager\n     */\n    fileTags: ['audio'],\n\n    /**\n     * @Override core, fileManager, resizing\n     * @description It is called from core.selectComponent.\n     * @param {Element} element Target element\n     */\n    select: function (element) {\n        this.plugins.audio.onModifyMode.call(this, element);\n    },\n\n    /**\n     * @Override fileManager, resizing \n     */\n    destroy: function (element) {\n        element = element || this.context.audio._element;\n        const container = this.util.getParentElement(element, this.util.isComponent) || element;\n        const dataIndex = element.getAttribute('data-index') * 1;\n        const focusEl = (container.previousElementSibling || container.nextElementSibling);\n\n        const emptyDiv = container.parentNode;\n        this.util.removeItem(container);\n        this.plugins.audio.init.call(this);\n        this.controllersOff();\n\n        if (emptyDiv !== this.context.element.wysiwyg) this.util.removeItemAllParents(emptyDiv, function (current) { return current.childNodes.length === 0; }, null);\n\n        // focus\n        this.focusEdge(focusEl);\n\n        // fileManager event\n        this.plugins.fileManager.deleteInfo.call(this, 'audio', dataIndex, this.functions.onAudioUpload);\n\n        // history stack\n        this.history.push(false);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    checkFileInfo: function () {\n        this.plugins.fileManager.checkInfo.call(this, 'audio', ['audio'], this.functions.onAudioUpload, this.plugins.audio.updateCover.bind(this), false);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    resetFileInfo: function () {\n        this.plugins.fileManager.resetInfo.call(this, 'audio', this.functions.onAudioUpload);\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    on: function (update) {\n        const contextAudio = this.context.audio;\n\n        if (!update) {\n            this.plugins.audio.init.call(this);\n            if (contextAudio.audioInputFile && this.options.audioMultipleFile) contextAudio.audioInputFile.setAttribute('multiple', 'multiple');\n        } else if (contextAudio._element) {\n            this.context.dialog.updateModal = true;\n            contextAudio._linkValue = contextAudio.preview.textContent = contextAudio.audioUrlFile.value = contextAudio._element.src;\n            if (contextAudio.audioInputFile && this.options.audioMultipleFile) contextAudio.audioInputFile.removeAttribute('multiple');\n        } else {\n            if (contextAudio.audioInputFile && this.options.audioMultipleFile) contextAudio.audioInputFile.removeAttribute('multiple');\n        }\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    open: function () {\n        this.plugins.dialog.open.call(this, 'audio', 'audio' === this.currentControllerName);\n    },\n\n    submit: function (e) {\n        const contextAudio = this.context.audio;\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        try {\n            if (contextAudio.audioInputFile && contextAudio.audioInputFile.files.length > 0) {\n                this.showLoading();\n                this.plugins.audio.submitAction.call(this, contextAudio.audioInputFile.files);\n            } else if (contextAudio.audioUrlFile && contextAudio._linkValue.length > 0) {\n                this.showLoading();\n                this.plugins.audio.setupUrl.call(this, contextAudio._linkValue);\n            }\n        } catch (error) {\n            this.closeLoading();\n            throw Error('[SUNEDITOR.audio.submit.fail] cause : \"' + error.message + '\"');\n        } finally {\n            this.plugins.dialog.close.call(this);\n        }\n\n        return false;\n    },\n\n    submitAction: function (fileList) {\n        if (fileList.length === 0) return;\n\n        let fileSize = 0;\n        let files = [];\n        for (let i = 0, len = fileList.length; i < len; i++) {\n            if (/audio/i.test(fileList[i].type)) {\n                files.push(fileList[i]);\n                fileSize += fileList[i].size;\n            }\n        }\n\n        const limitSize = this.options.audioUploadSizeLimit;\n        if (limitSize > 0) {\n            let infoSize = 0;\n            const audiosInfo = this.context.audio._infoList;\n            for (let i = 0, len = audiosInfo.length; i < len; i++) {\n                infoSize += audiosInfo[i].size * 1;\n            }\n\n            if ((fileSize + infoSize) > limitSize) {\n                this.closeLoading();\n                const err = '[SUNEDITOR.audioUpload.fail] Size of uploadable total audios: ' + (limitSize/1000) + 'KB';\n                if (typeof this.functions.onAudioUploadError !== 'function' || this.functions.onAudioUploadError(err, { 'limitSize': limitSize, 'currentSize': infoSize, 'uploadSize': fileSize }, this)) {\n                    this.functions.noticeOpen(err);\n                }\n                return;\n            }\n        }\n\n        const contextAudio = this.context.audio;\n        contextAudio._uploadFileLength = files.length;\n\n        const info = {\n            isUpdate: this.context.dialog.updateModal,\n            element: contextAudio._element\n        };\n\n        if (typeof this.functions.onAudioUploadBefore === 'function') {\n            const result = this.functions.onAudioUploadBefore(files, info, this, function (data) {\n                if (data && this._w.Array.isArray(data.result)) {\n                    this.plugins.audio.register.call(this, info, data);\n                } else {\n                    this.plugins.audio.upload.call(this, info, data);\n                }\n            }.bind(this));\n\n            if (typeof result === 'undefined') return;\n            if (!result) {\n                this.closeLoading();\n                return;\n            }\n            if (typeof result === 'object' && result.length > 0) files = result;\n        }\n\n        this.plugins.audio.upload.call(this, info, files);\n    },\n\n    error: function (message, response) {\n        this.closeLoading();\n        if (typeof this.functions.onAudioUploadError !== 'function' || this.functions.onAudioUploadError(message, response, this)) {\n            this.functions.noticeOpen(message);\n            throw Error('[SUNEDITOR.plugin.audio.exception] response: ' + message);\n        }\n    },\n\n    upload: function (info, files) {\n        if (!files) {\n            this.closeLoading();\n            return;\n        }\n        if (typeof files === 'string') {\n            this.plugins.audio.error.call(this, files, null);\n            return;\n        }\n\n        const audioUploadUrl = this.options.audioUploadUrl;\n        const filesLen = this.context.dialog.updateModal ? 1 : files.length;\n\n        // create formData\n        const formData = new FormData();\n        for (let i = 0; i < filesLen; i++) {\n            formData.append('file-' + i, files[i]);\n        }\n\n        // server upload\n        this.plugins.fileManager.upload.call(this, audioUploadUrl, this.options.audioUploadHeader, formData, this.plugins.audio.callBack_upload.bind(this, info), this.functions.onAudioUploadError);\n    },\n\n    callBack_upload: function (info, xmlHttp) {\n        if (typeof this.functions.audioUploadHandler === 'function') {\n            this.functions.audioUploadHandler(xmlHttp, info, this);\n        } else {\n            const response = JSON.parse(xmlHttp.responseText);\n            if (response.errorMessage) {\n                this.plugins.audio.error.call(this, response.errorMessage, response);\n            } else {\n                this.plugins.audio.register.call(this, info, response);\n            }\n        }\n    },\n\n    register: function (info, response) {\n        const fileList = response.result;\n\n        for (let i = 0, len = fileList.length, file, oAudio; i < len; i++) {\n            if (info.isUpdate) oAudio = info.element;\n            else oAudio = this.plugins.audio._createAudioTag.call(this);\n\n            file = { name: fileList[i].name, size: fileList[i].size };\n            this.plugins.audio.create_audio.call(this, oAudio, fileList[i].url, file, info.isUpdate);\n        }\n\n        this.closeLoading();\n    },\n\n    setupUrl: function (src) {\n        try {\n            if (src.length === 0) return false;\n            this.plugins.audio.create_audio.call(this, this.plugins.audio._createAudioTag.call(this), src, null, this.context.dialog.updateModal);\n        } catch (error) {\n            throw Error('[SUNEDITOR.audio.audio.fail] cause : \"' + error.message + '\"');\n        } finally {\n            this.closeLoading();\n        }\n    },\n\n    create_audio: function (element, src, file, isUpdate) {\n        const contextAudio = this.context.audio;\n        \n        // create new tag\n        if (!isUpdate) {\n            element.src = src;\n            const cover = this.plugins.component.set_cover.call(this, element);\n            const container = this.plugins.component.set_container.call(this, cover, '');\n            if (!this.insertComponent(container, false, true, !this.options.mediaAutoSelect)) {\n                this.focus();\n                return;\n            }\n            if (!this.options.mediaAutoSelect) {\n                const line = this.appendFormatTag(container, null);\n                if (line) this.setRange(line, 0, line, 0);\n            }\n        } // update\n        else {\n            if (contextAudio._element) element = contextAudio._element;\n            if (element && element.src !== src) {\n                element.src = src;\n                this.selectComponent(element, 'audio');\n            } else {\n                this.selectComponent(element, 'audio');\n                return;\n            }\n        }\n\n        this.plugins.fileManager.setInfo.call(this, 'audio', element, this.functions.onAudioUpload, file, false);\n        if (isUpdate) this.history.push(false);\n    },\n\n    updateCover: function (element) {\n        const contextAudio = this.context.audio;\n        this.plugins.audio._setTagAttrs.call(this, element);\n        \n        // find component element\n        let existElement = (this.util.isRangeFormatElement(element.parentNode) || this.util.isWysiwygDiv(element.parentNode)) ? \n            element : this.util.getFormatElement(element) || element;\n\n        // clone element\n        const prevElement = element;\n        contextAudio._element = element = element.cloneNode(false);\n        const cover = this.plugins.component.set_cover.call(this, element);\n        const container = this.plugins.component.set_container.call(this, cover, 'se-audio-container');\n\n        try {\n            if (this.util.getParentElement(prevElement, this.util.isNotCheckingNode)) {\n                prevElement.parentNode.replaceChild(container, prevElement);\n            } else if (this.util.isListCell(existElement)) {\n                const refer = this.util.getParentElement(prevElement, function (current) { return current.parentNode === existElement; });\n                existElement.insertBefore(container, refer);\n                this.util.removeItem(prevElement);\n                this.util.removeEmptyNode(refer, null, true);\n            } else if (this.util.isFormatElement(existElement)) {\n                const refer = this.util.getParentElement(prevElement, function (current) { return current.parentNode === existElement; });\n                existElement = this.util.splitElement(existElement, refer);\n                existElement.parentNode.insertBefore(container, existElement);\n                this.util.removeItem(prevElement);\n                this.util.removeEmptyNode(existElement, null, true);\n                if (existElement.children.length === 0) existElement.innerHTML = this.util.htmlRemoveWhiteSpace(existElement.innerHTML);\n            } else {\n                existElement.parentNode.replaceChild(container, existElement);\n            }\n        } catch (error) {\n            console.warn('[SUNEDITOR.audio.error] Maybe the audio tag is nested.', error);\n        }\n\n        this.plugins.fileManager.setInfo.call(this, 'audio', element, this.functions.onAudioUpload, null, false);\n        this.plugins.audio.init.call(this);\n    },\n\n    /**\n     * @Required @Override fileManager, resizing\n     */\n    onModifyMode: function (selectionTag) {\n        const contextAudio = this.context.audio;\n        \n        this.setControllerPosition(contextAudio.controller, selectionTag, 'bottom', {left: 0, top: 0});\n        this.controllersOn(contextAudio.controller, selectionTag, this.plugins.audio.onControllerOff.bind(this, selectionTag), 'audio');\n\n        this.util.addClass(selectionTag, 'active');\n        contextAudio._element = selectionTag;\n        contextAudio._cover = this.util.getParentElement(selectionTag, 'FIGURE');\n        contextAudio._container = this.util.getParentElement(selectionTag, this.util.isComponent);\n    },\n\n    /**\n     * @Required @Override fileManager, resizing\n     */\n    openModify: function (notOpen) {\n        if (this.context.audio.audioUrlFile) {\n            const contextAudio = this.context.audio;\n            contextAudio._linkValue = contextAudio.preview.textContent = contextAudio.audioUrlFile.value = contextAudio._element.src;\n        }\n        if (!notOpen) this.plugins.dialog.open.call(this, 'audio', true);\n    },\n\n    onClick_controller: function (e) {\n        e.stopPropagation();\n\n        const command = e.target.getAttribute('data-command');\n        if (!command) return;\n\n        e.preventDefault();\n\n        if (/update/.test(command)) {\n            this.plugins.audio.openModify.call(this, false);\n        }\n        else { /** delete */\n            this.plugins.audio.destroy.call(this, this.context.audio._element);\n        }\n\n        this.controllersOff();\n    },\n\n    onControllerOff: function (selectionTag) {\n        this.util.removeClass(selectionTag, 'active');\n        this.context.audio.controller.style.display = 'none';\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    init: function () {\n        if (this.context.dialog.updateModal) return;\n        const contextAudio = this.context.audio;\n\n        if (contextAudio.audioInputFile) contextAudio.audioInputFile.value = '';\n        if (contextAudio.audioUrlFile) contextAudio._linkValue = contextAudio.preview.textContent = contextAudio.audioUrlFile.value = '';\n        if (contextAudio.audioInputFile && contextAudio.audioUrlFile) {\n            contextAudio.audioUrlFile.removeAttribute('disabled');\n            contextAudio.preview.style.textDecoration = '';\n        }\n\n        contextAudio._element = null;\n    }\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}