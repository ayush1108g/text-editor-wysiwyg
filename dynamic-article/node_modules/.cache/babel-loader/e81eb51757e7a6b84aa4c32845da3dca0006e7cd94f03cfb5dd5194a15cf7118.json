{"ast":null,"code":"/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nimport dialog from '../modules/dialog';\nimport component from '../modules/component';\nimport resizing from '../modules/resizing';\nimport fileManager from '../modules/fileManager';\nexport default {\n  name: 'video',\n  display: 'dialog',\n  add: function (core) {\n    core.addModule([dialog, component, resizing, fileManager]);\n    const options = core.options;\n    const context = core.context;\n    const contextVideo = context.video = {\n      _infoList: [],\n      // @Override fileManager\n      _infoIndex: 0,\n      // @Override fileManager\n      _uploadFileLength: 0,\n      // @Override fileManager\n      focusElement: null,\n      // @Override dialog // This element has focus when the dialog is opened.\n      sizeUnit: options._videoSizeUnit,\n      _align: 'none',\n      _floatClassRegExp: '__se__float\\\\-[a-z]+',\n      _youtubeQuery: options.youtubeQuery,\n      _videoRatio: options.videoRatio * 100 + '%',\n      _defaultRatio: options.videoRatio * 100 + '%',\n      _linkValue: '',\n      // @require @Override component\n      _element: null,\n      _cover: null,\n      _container: null,\n      // @Override resizing properties\n      inputX: null,\n      inputY: null,\n      _element_w: 1,\n      _element_h: 1,\n      _element_l: 0,\n      _element_t: 0,\n      _defaultSizeX: '100%',\n      _defaultSizeY: options.videoRatio * 100 + '%',\n      _origin_w: options.videoWidth === '100%' ? '' : options.videoWidth,\n      _origin_h: options.videoHeight === '56.25%' ? '' : options.videoHeight,\n      _proportionChecked: true,\n      _resizing: options.videoResizing,\n      _resizeDotHide: !options.videoHeightShow,\n      _rotation: options.videoRotation,\n      _alignHide: !options.videoAlignShow,\n      _onlyPercentage: options.videoSizeOnlyPercentage,\n      _ratio: false,\n      _ratioX: 1,\n      _ratioY: 1,\n      _captionShow: false\n    };\n\n    /** video dialog */\n    let video_dialog = this.setDialog(core);\n    contextVideo.modal = video_dialog;\n    contextVideo.videoInputFile = video_dialog.querySelector('._se_video_file');\n    contextVideo.videoUrlFile = video_dialog.querySelector('.se-input-url');\n    contextVideo.focusElement = contextVideo.videoUrlFile || contextVideo.videoInputFile;\n    contextVideo.preview = video_dialog.querySelector('.se-link-preview');\n\n    /** add event listeners */\n    video_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core));\n    if (contextVideo.videoInputFile) video_dialog.querySelector('.se-dialog-files-edge-button').addEventListener('click', this._removeSelectedFiles.bind(contextVideo.videoInputFile, contextVideo.videoUrlFile, contextVideo.preview));\n    if (contextVideo.videoInputFile && contextVideo.videoUrlFile) contextVideo.videoInputFile.addEventListener('change', this._fileInputChange.bind(contextVideo));\n    if (contextVideo.videoUrlFile) contextVideo.videoUrlFile.addEventListener('input', this._onLinkPreview.bind(contextVideo.preview, contextVideo, options.linkProtocol));\n    contextVideo.proportion = {};\n    contextVideo.videoRatioOption = {};\n    contextVideo.inputX = {};\n    contextVideo.inputY = {};\n    if (options.videoResizing) {\n      contextVideo.proportion = video_dialog.querySelector('._se_video_check_proportion');\n      contextVideo.videoRatioOption = video_dialog.querySelector('.se-video-ratio');\n      contextVideo.inputX = video_dialog.querySelector('._se_video_size_x');\n      contextVideo.inputY = video_dialog.querySelector('._se_video_size_y');\n      contextVideo.inputX.value = options.videoWidth;\n      contextVideo.inputY.value = options.videoHeight;\n      contextVideo.inputX.addEventListener('keyup', this.setInputSize.bind(core, 'x'));\n      contextVideo.inputY.addEventListener('keyup', this.setInputSize.bind(core, 'y'));\n      contextVideo.inputX.addEventListener('change', this.setRatio.bind(core));\n      contextVideo.inputY.addEventListener('change', this.setRatio.bind(core));\n      contextVideo.proportion.addEventListener('change', this.setRatio.bind(core));\n      contextVideo.videoRatioOption.addEventListener('change', this.setVideoRatio.bind(core));\n      video_dialog.querySelector('.se-dialog-btn-revert').addEventListener('click', this.sizeRevert.bind(core));\n    }\n\n    /** append html */\n    context.dialog.modal.appendChild(video_dialog);\n\n    /** empty memory */\n    video_dialog = null;\n  },\n  /** dialog */\n  setDialog: function (core) {\n    const option = core.options;\n    const lang = core.lang;\n    const dialog = core.util.createElement('DIV');\n    dialog.className = 'se-dialog-content';\n    dialog.style.display = 'none';\n    let html = '' + '<form method=\"post\" enctype=\"multipart/form-data\">' + '<div class=\"se-dialog-header\">' + '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' + core.icons.cancel + '</button>' + '<span class=\"se-modal-title\">' + lang.dialogBox.videoBox.title + '</span>' + '</div>' + '<div class=\"se-dialog-body\">';\n    if (option.videoFileInput) {\n      html += '' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.videoBox.file + '</label>' + '<div class=\"se-dialog-form-files\">' + '<input class=\"se-input-form _se_video_file\" type=\"file\" accept=\"' + option.videoAccept + '\"' + (option.videoMultipleFile ? ' multiple=\"multiple\"' : '') + '/>' + '<button type=\"button\" data-command=\"filesRemove\" class=\"se-btn se-dialog-files-edge-button se-file-remove\" title=\"' + lang.controller.remove + '\" aria-label=\"' + lang.controller.remove + '\">' + core.icons.cancel + '</button>' + '</div>' + '</div>';\n    }\n    if (option.videoUrlInput) {\n      html += '' + '<div class=\"se-dialog-form\">' + '<label>' + lang.dialogBox.videoBox.url + '</label>' + '<input class=\"se-input-form se-input-url\" type=\"text\" />' + '<pre class=\"se-link-preview\"></pre>' + '</div>';\n    }\n    if (option.videoResizing) {\n      const ratioList = option.videoRatioList || [{\n        name: '16:9',\n        value: 0.5625\n      }, {\n        name: '4:3',\n        value: 0.75\n      }, {\n        name: '21:9',\n        value: 0.4285\n      }];\n      const ratio = option.videoRatio;\n      const onlyPercentage = option.videoSizeOnlyPercentage;\n      const onlyPercentDisplay = onlyPercentage ? ' style=\"display: none !important;\"' : '';\n      const heightDisplay = !option.videoHeightShow ? ' style=\"display: none !important;\"' : '';\n      const ratioDisplay = !option.videoRatioShow ? ' style=\"display: none !important;\"' : '';\n      const onlyWidthDisplay = !onlyPercentage && !option.videoHeightShow && !option.videoRatioShow ? ' style=\"display: none !important;\"' : '';\n      html += '' + '<div class=\"se-dialog-form\">' + '<div class=\"se-dialog-size-text\">' + '<label class=\"size-w\">' + lang.dialogBox.width + '</label>' + '<label class=\"se-dialog-size-x\">&nbsp;</label>' + '<label class=\"size-h\"' + heightDisplay + '>' + lang.dialogBox.height + '</label>' + '<label class=\"size-h\"' + ratioDisplay + '>(' + lang.dialogBox.ratio + ')</label>' + '</div>' + '<input class=\"se-input-control _se_video_size_x\" placeholder=\"100%\"' + (onlyPercentage ? ' type=\"number\" min=\"1\"' : 'type=\"text\"') + (onlyPercentage ? ' max=\"100\"' : '') + '/>' + '<label class=\"se-dialog-size-x\"' + onlyWidthDisplay + '>' + (onlyPercentage ? '%' : 'x') + '</label>' + '<input class=\"se-input-control _se_video_size_y\" placeholder=\"' + option.videoRatio * 100 + '%\"' + (onlyPercentage ? ' type=\"number\" min=\"1\"' : 'type=\"text\"') + (onlyPercentage ? ' max=\"100\"' : '') + heightDisplay + '/>' + '<select class=\"se-input-select se-video-ratio\" title=\"' + lang.dialogBox.ratio + '\" aria-label=\"' + lang.dialogBox.ratio + '\"' + ratioDisplay + '>';\n      if (!heightDisplay) html += '<option value=\"\"> - </option>';\n      for (let i = 0, len = ratioList.length; i < len; i++) {\n        html += '<option value=\"' + ratioList[i].value + '\"' + (ratio.toString() === ratioList[i].value.toString() ? ' selected' : '') + '>' + ratioList[i].name + '</option>';\n      }\n      html += '</select>' + '<button type=\"button\" title=\"' + lang.dialogBox.revertButton + '\" aria-label=\"' + lang.dialogBox.revertButton + '\" class=\"se-btn se-dialog-btn-revert\" style=\"float: right;\">' + core.icons.revert + '</button>' + '</div>' + '<div class=\"se-dialog-form se-dialog-form-footer\"' + onlyPercentDisplay + onlyWidthDisplay + '>' + '<label><input type=\"checkbox\" class=\"se-dialog-btn-check _se_video_check_proportion\" checked/>&nbsp;' + lang.dialogBox.proportion + '</label>' + '</div>';\n    }\n    html += '' + '</div>' + '<div class=\"se-dialog-footer\">' + '<div' + (option.videoAlignShow ? '' : ' style=\"display: none\"') + '>' + '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"none\" checked>' + lang.dialogBox.basic + '</label>' + '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"left\">' + lang.dialogBox.left + '</label>' + '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"center\">' + lang.dialogBox.center + '</label>' + '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"right\">' + lang.dialogBox.right + '</label>' + '</div>' + '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' + '</div>' + '</form>';\n    dialog.innerHTML = html;\n    return dialog;\n  },\n  _fileInputChange: function () {\n    if (!this.videoInputFile.value) {\n      this.videoUrlFile.removeAttribute('disabled');\n      this.preview.style.textDecoration = '';\n    } else {\n      this.videoUrlFile.setAttribute('disabled', true);\n      this.preview.style.textDecoration = 'line-through';\n    }\n  },\n  _removeSelectedFiles: function (urlInput, preview) {\n    this.value = '';\n    if (urlInput) {\n      urlInput.removeAttribute('disabled');\n      preview.style.textDecoration = '';\n    }\n  },\n  _onLinkPreview: function (context, protocol, e) {\n    const value = e.target.value.trim();\n    if (/^<iframe.*\\/iframe>$/.test(value)) {\n      context._linkValue = value;\n      this.textContent = '<IFrame :src=\"..\"></IFrame>';\n    } else {\n      context._linkValue = this.textContent = !value ? '' : protocol && value.indexOf('://') === -1 && value.indexOf('#') !== 0 ? protocol + value : value.indexOf('://') === -1 ? '/' + value : value;\n    }\n  },\n  _setTagAttrs: function (element) {\n    element.setAttribute('controls', true);\n    const attrs = this.options.videoTagAttrs;\n    if (!attrs) return;\n    for (let key in attrs) {\n      if (!this.util.hasOwn(attrs, key)) continue;\n      element.setAttribute(key, attrs[key]);\n    }\n  },\n  createVideoTag: function () {\n    const videoTag = this.util.createElement('VIDEO');\n    this.plugins.video._setTagAttrs.call(this, videoTag);\n    return videoTag;\n  },\n  _setIframeAttrs: function (element) {\n    element.frameBorder = '0';\n    element.allowFullscreen = true;\n    const attrs = this.options.videoIframeAttrs;\n    if (!attrs) return;\n    for (let key in attrs) {\n      if (!this.util.hasOwn(attrs, key)) continue;\n      element.setAttribute(key, attrs[key]);\n    }\n  },\n  createIframeTag: function () {\n    const iframeTag = this.util.createElement('IFRAME');\n    this.plugins.video._setIframeAttrs.call(this, iframeTag);\n    return iframeTag;\n  },\n  /**\n   * @Override @Required fileManager\n   */\n  fileTags: ['iframe', 'video'],\n  /**\n   * @Override core, resizing, fileManager\n   * @description It is called from core.selectComponent.\n   * @param {Element} element Target element\n   */\n  select: function (element) {\n    this.plugins.video.onModifyMode.call(this, element, this.plugins.resizing.call_controller_resize.call(this, element, 'video'));\n  },\n  /**\n   * @Override fileManager, resizing\n   */\n  destroy: function (element) {\n    const frame = element || this.context.video._element;\n    const container = this.context.video._container;\n    const dataIndex = frame.getAttribute('data-index') * 1;\n    let focusEl = container.previousElementSibling || container.nextElementSibling;\n    const emptyDiv = container.parentNode;\n    this.util.removeItem(container);\n    this.plugins.video.init.call(this);\n    this.controllersOff();\n    if (emptyDiv !== this.context.element.wysiwyg) this.util.removeItemAllParents(emptyDiv, function (current) {\n      return current.childNodes.length === 0;\n    }, null);\n\n    // focus\n    this.focusEdge(focusEl);\n\n    // event\n    this.plugins.fileManager.deleteInfo.call(this, 'video', dataIndex, this.functions.onVideoUpload);\n\n    // history stack\n    this.history.push(false);\n  },\n  /**\n   * @Required @Override dialog\n   */\n  on: function (update) {\n    const contextVideo = this.context.video;\n    if (!update) {\n      contextVideo.inputX.value = contextVideo._origin_w = this.options.videoWidth === contextVideo._defaultSizeX ? '' : this.options.videoWidth;\n      contextVideo.inputY.value = contextVideo._origin_h = this.options.videoHeight === contextVideo._defaultSizeY ? '' : this.options.videoHeight;\n      contextVideo.proportion.disabled = true;\n      if (contextVideo.videoInputFile && this.options.videoMultipleFile) contextVideo.videoInputFile.setAttribute('multiple', 'multiple');\n    } else {\n      if (contextVideo.videoInputFile && this.options.videoMultipleFile) contextVideo.videoInputFile.removeAttribute('multiple');\n    }\n    if (contextVideo._resizing) {\n      this.plugins.video.setVideoRatioSelect.call(this, contextVideo._origin_h || contextVideo._defaultRatio);\n    }\n  },\n  /**\n   * @Required @Override dialog\n   */\n  open: function () {\n    this.plugins.dialog.open.call(this, 'video', 'video' === this.currentControllerName);\n  },\n  setVideoRatio: function (e) {\n    const contextVideo = this.context.video;\n    const value = e.target.options[e.target.selectedIndex].value;\n    contextVideo._defaultSizeY = contextVideo._videoRatio = !value ? contextVideo._defaultSizeY : value * 100 + '%';\n    contextVideo.inputY.placeholder = !value ? '' : value * 100 + '%';\n    contextVideo.inputY.value = '';\n  },\n  /**\n   * @Override resizing\n   * @param {String} xy 'x': width, 'y': height\n   * @param {KeyboardEvent} e Event object\n   */\n  setInputSize: function (xy, e) {\n    if (e && e.keyCode === 32) {\n      e.preventDefault();\n      return;\n    }\n    const contextVideo = this.context.video;\n    this.plugins.resizing._module_setInputSize.call(this, contextVideo, xy);\n    if (xy === 'y') {\n      this.plugins.video.setVideoRatioSelect.call(this, e.target.value || contextVideo._defaultRatio);\n    }\n  },\n  /**\n   * @Override resizing\n   */\n  setRatio: function () {\n    this.plugins.resizing._module_setRatio.call(this, this.context.video);\n  },\n  submit: function (e) {\n    const contextVideo = this.context.video;\n    const videoPlugin = this.plugins.video;\n    e.preventDefault();\n    e.stopPropagation();\n    contextVideo._align = contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"]:checked').value;\n    try {\n      if (contextVideo.videoInputFile && contextVideo.videoInputFile.files.length > 0) {\n        this.showLoading();\n        videoPlugin.submitAction.call(this, this.context.video.videoInputFile.files);\n      } else if (contextVideo.videoUrlFile && contextVideo._linkValue.length > 0) {\n        this.showLoading();\n        videoPlugin.setup_url.call(this, contextVideo._linkValue);\n      }\n    } catch (error) {\n      this.closeLoading();\n      throw Error('[SUNEDITOR.video.submit.fail] cause : \"' + error.message + '\"');\n    } finally {\n      this.plugins.dialog.close.call(this);\n    }\n    return false;\n  },\n  submitAction: function (fileList) {\n    if (fileList.length === 0) return;\n    let fileSize = 0;\n    let files = [];\n    for (let i = 0, len = fileList.length; i < len; i++) {\n      if (/video/i.test(fileList[i].type)) {\n        files.push(fileList[i]);\n        fileSize += fileList[i].size;\n      }\n    }\n    const limitSize = this.options.videoUploadSizeLimit;\n    if (limitSize > 0) {\n      let infoSize = 0;\n      const videosInfo = this.context.video._infoList;\n      for (let i = 0, len = videosInfo.length; i < len; i++) {\n        infoSize += videosInfo[i].size * 1;\n      }\n      if (fileSize + infoSize > limitSize) {\n        this.closeLoading();\n        const err = '[SUNEDITOR.videoUpload.fail] Size of uploadable total videos: ' + limitSize / 1000 + 'KB';\n        if (typeof this.functions.onVideoUploadError !== 'function' || this.functions.onVideoUploadError(err, {\n          'limitSize': limitSize,\n          'currentSize': infoSize,\n          'uploadSize': fileSize\n        }, this)) {\n          this.functions.noticeOpen(err);\n        }\n        return;\n      }\n    }\n    const contextVideo = this.context.video;\n    contextVideo._uploadFileLength = files.length;\n    const info = {\n      inputWidth: contextVideo.inputX.value,\n      inputHeight: contextVideo.inputY.value,\n      align: contextVideo._align,\n      isUpdate: this.context.dialog.updateModal,\n      element: contextVideo._element\n    };\n    if (typeof this.functions.onVideoUploadBefore === 'function') {\n      const result = this.functions.onVideoUploadBefore(files, info, this, function (data) {\n        if (data && this._w.Array.isArray(data.result)) {\n          this.plugins.video.register.call(this, info, data);\n        } else {\n          this.plugins.video.upload.call(this, info, data);\n        }\n      }.bind(this));\n      if (typeof result === 'undefined') return;\n      if (!result) {\n        this.closeLoading();\n        return;\n      }\n      if (typeof result === 'object' && result.length > 0) files = result;\n    }\n    this.plugins.video.upload.call(this, info, files);\n  },\n  error: function (message, response) {\n    this.closeLoading();\n    if (typeof this.functions.onVideoUploadError !== 'function' || this.functions.onVideoUploadError(message, response, this)) {\n      this.functions.noticeOpen(message);\n      throw Error('[SUNEDITOR.plugin.video.error] response: ' + message);\n    }\n  },\n  upload: function (info, files) {\n    if (!files) {\n      this.closeLoading();\n      return;\n    }\n    if (typeof files === 'string') {\n      this.plugins.video.error.call(this, files, null);\n      return;\n    }\n    const videoUploadUrl = this.options.videoUploadUrl;\n    const filesLen = this.context.dialog.updateModal ? 1 : files.length;\n\n    // server upload\n    if (typeof videoUploadUrl === 'string' && videoUploadUrl.length > 0) {\n      const formData = new FormData();\n      for (let i = 0; i < filesLen; i++) {\n        formData.append('file-' + i, files[i]);\n      }\n      this.plugins.fileManager.upload.call(this, videoUploadUrl, this.options.videoUploadHeader, formData, this.plugins.video.callBack_videoUpload.bind(this, info), this.functions.onVideoUploadError);\n    } else {\n      throw Error('[SUNEDITOR.videoUpload.fail] cause : There is no \"videoUploadUrl\" option.');\n    }\n  },\n  callBack_videoUpload: function (info, xmlHttp) {\n    if (typeof this.functions.videoUploadHandler === 'function') {\n      this.functions.videoUploadHandler(xmlHttp, info, this);\n    } else {\n      const response = JSON.parse(xmlHttp.responseText);\n      if (response.errorMessage) {\n        this.plugins.video.error.call(this, response.errorMessage, response);\n      } else {\n        this.plugins.video.register.call(this, info, response);\n      }\n    }\n  },\n  register: function (info, response) {\n    const fileList = response.result;\n    const videoTag = this.plugins.video.createVideoTag.call(this);\n    for (let i = 0, len = fileList.length, file; i < len; i++) {\n      file = {\n        name: fileList[i].name,\n        size: fileList[i].size\n      };\n      this.plugins.video.create_video.call(this, info.isUpdate ? info.element : videoTag.cloneNode(false), fileList[i].url, info.inputWidth, info.inputHeight, info.align, file, info.isUpdate);\n    }\n    this.closeLoading();\n  },\n  setup_url: function (url) {\n    try {\n      const contextVideo = this.context.video;\n      if (!url) url = contextVideo._linkValue;\n      if (!url) return false;\n\n      /** iframe source */\n      if (/^<iframe.*\\/iframe>$/.test(url)) {\n        const oIframe = new this._w.DOMParser().parseFromString(url, 'text/html').querySelector('iframe');\n        url = oIframe.src;\n        if (url.length === 0) return false;\n      }\n\n      /** youtube */\n      if (/youtu\\.?be/.test(url)) {\n        if (!/^http/.test(url)) url = 'https://' + url;\n        url = url.replace('watch?v=', '');\n        if (!/^\\/\\/.+\\/embed\\//.test(url)) {\n          url = url.replace(url.match(/\\/\\/.+\\//)[0], '//www.youtube.com/embed/').replace('&', '?&');\n        }\n        if (contextVideo._youtubeQuery.length > 0) {\n          if (/\\?/.test(url)) {\n            const splitUrl = url.split('?');\n            url = splitUrl[0] + '?' + contextVideo._youtubeQuery + '&' + splitUrl[1];\n          } else {\n            url += '?' + contextVideo._youtubeQuery;\n          }\n        }\n      } else if (/vimeo\\.com/.test(url)) {\n        if (url.endsWith('/')) {\n          url = url.slice(0, -1);\n        }\n        url = 'https://player.vimeo.com/video/' + url.slice(url.lastIndexOf('/') + 1);\n      }\n      this.plugins.video.create_video.call(this, this.plugins.video[!/embed|iframe|player|\\/e\\/|\\.php|\\.html?/.test(url) && !/vimeo\\.com/.test(url) ? \"createVideoTag\" : \"createIframeTag\"].call(this), url, contextVideo.inputX.value, contextVideo.inputY.value, contextVideo._align, null, this.context.dialog.updateModal);\n    } catch (error) {\n      throw Error('[SUNEDITOR.video.upload.fail] cause : \"' + error.message + '\"');\n    } finally {\n      this.closeLoading();\n    }\n  },\n  create_video: function (oFrame, src, width, height, align, file, isUpdate) {\n    this.context.resizing._resize_plugin = 'video';\n    const contextVideo = this.context.video;\n    let cover = null;\n    let container = null;\n    let init = false;\n\n    /** update */\n    if (isUpdate) {\n      oFrame = contextVideo._element;\n      if (oFrame.src !== src) {\n        init = true;\n        const isYoutube = /youtu\\.?be/.test(src);\n        const isVimeo = /vimeo\\.com/.test(src);\n        if ((isYoutube || isVimeo) && !/^iframe$/i.test(oFrame.nodeName)) {\n          const newTag = this.plugins.video.createIframeTag.call(this);\n          newTag.src = src;\n          oFrame.parentNode.replaceChild(newTag, oFrame);\n          contextVideo._element = oFrame = newTag;\n        } else if (!isYoutube && !isVimeo && !/^videoo$/i.test(oFrame.nodeName)) {\n          const newTag = this.plugins.video.createVideoTag.call(this);\n          newTag.src = src;\n          oFrame.parentNode.replaceChild(newTag, oFrame);\n          contextVideo._element = oFrame = newTag;\n        } else {\n          oFrame.src = src;\n        }\n      }\n      container = contextVideo._container;\n      cover = this.util.getParentElement(oFrame, 'FIGURE');\n    }\n    /** create */else {\n      init = true;\n      oFrame.src = src;\n      contextVideo._element = oFrame;\n      cover = this.plugins.component.set_cover.call(this, oFrame);\n      container = this.plugins.component.set_container.call(this, cover, 'se-video-container');\n    }\n\n    /** rendering */\n    contextVideo._cover = cover;\n    contextVideo._container = container;\n    const inputUpdate = this.plugins.resizing._module_getSizeX.call(this, contextVideo) !== (width || contextVideo._defaultSizeX) || this.plugins.resizing._module_getSizeY.call(this, contextVideo) !== (height || contextVideo._videoRatio);\n    const changeSize = !isUpdate || inputUpdate;\n    if (contextVideo._resizing) {\n      this.context.video._proportionChecked = contextVideo.proportion.checked;\n      oFrame.setAttribute('data-proportion', contextVideo._proportionChecked);\n    }\n\n    // size\n    let isPercent = false;\n    if (changeSize) {\n      isPercent = this.plugins.video.applySize.call(this);\n    }\n\n    // align\n    if (!(isPercent && align === 'center')) {\n      this.plugins.video.setAlign.call(this, null, oFrame, cover, container);\n    }\n    let changed = true;\n    if (!isUpdate) {\n      changed = this.insertComponent(container, false, true, !this.options.mediaAutoSelect);\n      if (!this.options.mediaAutoSelect) {\n        const line = this.appendFormatTag(container, null);\n        if (line) this.setRange(line, 0, line, 0);\n      }\n    } else if (contextVideo._resizing && this.context.resizing._rotateVertical && changeSize) {\n      this.plugins.resizing.setTransformSize.call(this, oFrame, null, null);\n    }\n    if (changed) {\n      if (init) {\n        this.plugins.fileManager.setInfo.call(this, 'video', oFrame, this.functions.onVideoUpload, file, true);\n      }\n      if (isUpdate) {\n        this.selectComponent(oFrame, 'video');\n        // history stack\n        this.history.push(false);\n      }\n    }\n    this.context.resizing._resize_plugin = '';\n  },\n  _update_videoCover: function (oFrame) {\n    if (!oFrame) return;\n    const contextVideo = this.context.video;\n    if (/^video$/i.test(oFrame.nodeName)) this.plugins.video._setTagAttrs.call(this, oFrame);else this.plugins.video._setIframeAttrs.call(this, oFrame);\n    let existElement = this.util.isRangeFormatElement(oFrame.parentNode) || this.util.isWysiwygDiv(oFrame.parentNode) ? oFrame : this.util.getFormatElement(oFrame) || oFrame;\n    const prevFrame = oFrame;\n    contextVideo._element = oFrame = oFrame.cloneNode(true);\n    const cover = contextVideo._cover = this.plugins.component.set_cover.call(this, oFrame);\n    const container = contextVideo._container = this.plugins.component.set_container.call(this, cover, 'se-video-container');\n    try {\n      const figcaption = existElement.querySelector('figcaption');\n      let caption = null;\n      if (!!figcaption) {\n        caption = this.util.createElement('DIV');\n        caption.innerHTML = figcaption.innerHTML;\n        this.util.removeItem(figcaption);\n      }\n\n      // size\n      const size = (oFrame.getAttribute('data-size') || oFrame.getAttribute('data-origin') || '').split(',');\n      this.plugins.video.applySize.call(this, size[0] || prevFrame.style.width || prevFrame.width || '', size[1] || prevFrame.style.height || prevFrame.height || '');\n\n      // align\n      const format = this.util.getFormatElement(prevFrame);\n      if (format) contextVideo._align = format.style.textAlign || format.style.float;\n      this.plugins.video.setAlign.call(this, null, oFrame, cover, container);\n      if (this.util.getParentElement(prevFrame, this.util.isNotCheckingNode)) {\n        prevFrame.parentNode.replaceChild(container, prevFrame);\n      } else if (this.util.isListCell(existElement)) {\n        const refer = this.util.getParentElement(prevFrame, function (current) {\n          return current.parentNode === existElement;\n        });\n        existElement.insertBefore(container, refer);\n        this.util.removeItem(prevFrame);\n        this.util.removeEmptyNode(refer, null, true);\n      } else if (this.util.isFormatElement(existElement)) {\n        const refer = this.util.getParentElement(prevFrame, function (current) {\n          return current.parentNode === existElement;\n        });\n        existElement = this.util.splitElement(existElement, refer);\n        existElement.parentNode.insertBefore(container, existElement);\n        this.util.removeItem(prevFrame);\n        this.util.removeEmptyNode(existElement, null, true);\n        if (existElement.children.length === 0) existElement.innerHTML = this.util.htmlRemoveWhiteSpace(existElement.innerHTML);\n      } else {\n        existElement.parentNode.replaceChild(container, existElement);\n      }\n      if (!!caption) existElement.parentNode.insertBefore(caption, container.nextElementSibling);\n    } catch (error) {\n      console.warn('[SUNEDITOR.video.error] Maybe the video tag is nested.', error);\n    }\n    this.plugins.fileManager.setInfo.call(this, 'video', oFrame, this.functions.onVideoUpload, null, true);\n    this.plugins.video.init.call(this);\n  },\n  /**\n   * @Required @Override fileManager, resizing\n   */\n  onModifyMode: function (element, size) {\n    const contextVideo = this.context.video;\n    contextVideo._element = element;\n    contextVideo._cover = this.util.getParentElement(element, 'FIGURE');\n    contextVideo._container = this.util.getParentElement(element, this.util.isMediaComponent);\n    contextVideo._align = element.style.float || element.getAttribute('data-align') || 'none';\n    element.style.float = '';\n    if (size) {\n      contextVideo._element_w = size.w;\n      contextVideo._element_h = size.h;\n      contextVideo._element_t = size.t;\n      contextVideo._element_l = size.l;\n    }\n    let origin = contextVideo._element.getAttribute('data-size') || contextVideo._element.getAttribute('data-origin');\n    let w, h;\n    if (origin) {\n      origin = origin.split(',');\n      w = origin[0];\n      h = origin[1];\n    } else if (size) {\n      w = size.w;\n      h = size.h;\n    }\n    contextVideo._origin_w = w || element.style.width || element.width || '';\n    contextVideo._origin_h = h || element.style.height || element.height || '';\n  },\n  /**\n   * @Required @Override fileManager, resizing\n   */\n  openModify: function (notOpen) {\n    const contextVideo = this.context.video;\n    if (contextVideo.videoUrlFile) contextVideo._linkValue = contextVideo.preview.textContent = contextVideo.videoUrlFile.value = contextVideo._element.src || (contextVideo._element.querySelector('source') || '').src || '';\n    (contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"][value=\"' + contextVideo._align + '\"]') || contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"][value=\"none\"]')).checked = true;\n    if (contextVideo._resizing) {\n      this.plugins.resizing._module_setModifyInputSize.call(this, contextVideo, this.plugins.video);\n      const y = contextVideo._videoRatio = this.plugins.resizing._module_getSizeY.call(this, contextVideo);\n      const ratioSelected = this.plugins.video.setVideoRatioSelect.call(this, y);\n      if (!ratioSelected) contextVideo.inputY.value = contextVideo._onlyPercentage ? this.util.getNumber(y, 2) : y;\n    }\n    if (!notOpen) this.plugins.dialog.open.call(this, 'video', true);\n  },\n  setVideoRatioSelect: function (value) {\n    let ratioSelected = false;\n    const contextVideo = this.context.video;\n    const ratioOptions = contextVideo.videoRatioOption.options;\n    if (/%$/.test(value) || contextVideo._onlyPercentage) value = this.util.getNumber(value, 2) / 100 + '';else if (!this.util.isNumber(value) || value * 1 >= 1) value = '';\n    contextVideo.inputY.placeholder = '';\n    for (let i = 0, len = ratioOptions.length; i < len; i++) {\n      if (ratioOptions[i].value === value) {\n        ratioSelected = ratioOptions[i].selected = true;\n        contextVideo.inputY.placeholder = !value ? '' : value * 100 + '%';\n      } else ratioOptions[i].selected = false;\n    }\n    return ratioSelected;\n  },\n  /**\n   * @Override fileManager\n   */\n  checkFileInfo: function () {\n    this.plugins.fileManager.checkInfo.call(this, 'video', ['iframe', 'video'], this.functions.onVideoUpload, this.plugins.video._update_videoCover.bind(this), true);\n  },\n  /**\n   * @Override fileManager\n   */\n  resetFileInfo: function () {\n    this.plugins.fileManager.resetInfo.call(this, 'video', this.functions.onVideoUpload);\n  },\n  /**\n   * @Override fileManager\n   */\n  applySize: function (w, h) {\n    const contextVideo = this.context.video;\n    if (!w) w = contextVideo.inputX.value || this.options.videoWidth;\n    if (!h) h = contextVideo.inputY.value || this.options.videoHeight;\n    if (contextVideo._onlyPercentage || /%$/.test(w) || !w) {\n      this.plugins.video.setPercentSize.call(this, w || '100%', h || (/%$/.test(contextVideo._videoRatio) ? contextVideo._videoRatio : contextVideo._defaultRatio));\n      return true;\n    } else if ((!w || w === 'auto') && (!h || h === 'auto')) {\n      this.plugins.video.setAutoSize.call(this);\n    } else {\n      this.plugins.video.setSize.call(this, w, h || contextVideo._videoRatio || contextVideo._defaultRatio, false);\n    }\n    return false;\n  },\n  /**\n   * @Override resizing\n   */\n  sizeRevert: function () {\n    this.plugins.resizing._module_sizeRevert.call(this, this.context.video);\n  },\n  /**\n   * @Override resizing\n   */\n  setSize: function (w, h, notResetPercentage, direction) {\n    const contextVideo = this.context.video;\n    const onlyW = /^(rw|lw)$/.test(direction);\n    const onlyH = /^(th|bh)$/.test(direction);\n    if (!onlyH) w = this.util.getNumber(w, 0);\n    if (!onlyW) h = this.util.isNumber(h) ? h + contextVideo.sizeUnit : !h ? '' : h;\n    w = w ? w + contextVideo.sizeUnit : '';\n    if (!onlyH) contextVideo._element.style.width = w;\n    if (!onlyW) contextVideo._cover.style.paddingBottom = contextVideo._cover.style.height = h;\n    if (!onlyH && !/%$/.test(w)) {\n      contextVideo._cover.style.width = w;\n      contextVideo._container.style.width = '';\n    }\n    if (!onlyW && !/%$/.test(h)) {\n      contextVideo._element.style.height = h;\n    } else {\n      contextVideo._element.style.height = '';\n    }\n    if (!notResetPercentage) contextVideo._element.removeAttribute('data-percentage');\n\n    // save current size\n    this.plugins.resizing._module_saveCurrentSize.call(this, contextVideo);\n  },\n  /**\n   * @Override resizing\n   */\n  setAutoSize: function () {\n    this.plugins.video.setPercentSize.call(this, 100, this.context.video._defaultRatio);\n  },\n  /**\n   * @Override resizing\n   */\n  setOriginSize: function (dataSize) {\n    const contextVideo = this.context.video;\n    contextVideo._element.removeAttribute('data-percentage');\n    this.plugins.resizing.resetTransform.call(this, contextVideo._element);\n    this.plugins.video.cancelPercentAttr.call(this);\n    const originSize = ((dataSize ? contextVideo._element.getAttribute('data-size') : '') || contextVideo._element.getAttribute('data-origin') || '').split(',');\n    if (originSize) {\n      const w = originSize[0];\n      const h = originSize[1];\n      if (contextVideo._onlyPercentage || /%$/.test(w) && (/%$/.test(h) || !/\\d/.test(h))) {\n        this.plugins.video.setPercentSize.call(this, w, h);\n      } else {\n        this.plugins.video.setSize.call(this, w, h);\n      }\n\n      // save current size\n      this.plugins.resizing._module_saveCurrentSize.call(this, contextVideo);\n    }\n  },\n  /**\n   * @Override resizing\n   */\n  setPercentSize: function (w, h) {\n    const contextVideo = this.context.video;\n    h = !!h && !/%$/.test(h) && !this.util.getNumber(h, 0) ? this.util.isNumber(h) ? h + '%' : h : this.util.isNumber(h) ? h + contextVideo.sizeUnit : h || contextVideo._defaultRatio;\n    contextVideo._container.style.width = this.util.isNumber(w) ? w + '%' : w;\n    contextVideo._container.style.height = '';\n    contextVideo._cover.style.width = '100%';\n    contextVideo._cover.style.height = h;\n    contextVideo._cover.style.paddingBottom = h;\n    contextVideo._element.style.width = '100%';\n    contextVideo._element.style.height = '100%';\n    contextVideo._element.style.maxWidth = '';\n    if (contextVideo._align === 'center') this.plugins.video.setAlign.call(this, null, null, null, null);\n    contextVideo._element.setAttribute('data-percentage', w + ',' + h);\n\n    // save current size\n    this.plugins.resizing._module_saveCurrentSize.call(this, contextVideo);\n  },\n  /**\n   * @Override resizing\n   */\n  cancelPercentAttr: function () {\n    const contextVideo = this.context.video;\n    contextVideo._cover.style.width = '';\n    contextVideo._cover.style.height = '';\n    contextVideo._cover.style.paddingBottom = '';\n    contextVideo._container.style.width = '';\n    contextVideo._container.style.height = '';\n    this.util.removeClass(contextVideo._container, this.context.video._floatClassRegExp);\n    this.util.addClass(contextVideo._container, '__se__float-' + contextVideo._align);\n    if (contextVideo._align === 'center') this.plugins.video.setAlign.call(this, null, null, null, null);\n  },\n  /**\n   * @Override resizing\n   */\n  setAlign: function (align, element, cover, container) {\n    const contextVideo = this.context.video;\n    if (!align) align = contextVideo._align;\n    if (!element) element = contextVideo._element;\n    if (!cover) cover = contextVideo._cover;\n    if (!container) container = contextVideo._container;\n    if (/%$/.test(element.style.width) && align === 'center') {\n      container.style.minWidth = '100%';\n      cover.style.width = container.style.width;\n      cover.style.height = cover.style.height;\n      cover.style.paddingBottom = !/%$/.test(cover.style.height) ? cover.style.height : this.util.getNumber(this.util.getNumber(cover.style.height, 2) / 100 * this.util.getNumber(cover.style.width, 2), 2) + '%';\n    } else {\n      container.style.minWidth = '';\n      cover.style.width = this.context.resizing._rotateVertical ? element.style.height || element.offsetHeight : element.style.width || '100%';\n      cover.style.paddingBottom = cover.style.height;\n    }\n    if (!this.util.hasClass(container, '__se__float-' + align)) {\n      this.util.removeClass(container, contextVideo._floatClassRegExp);\n      this.util.addClass(container, '__se__float-' + align);\n    }\n    element.setAttribute('data-align', align);\n  },\n  /**\n   * @Override dialog\n   */\n  init: function () {\n    const contextVideo = this.context.video;\n    if (contextVideo.videoInputFile) contextVideo.videoInputFile.value = '';\n    if (contextVideo.videoUrlFile) contextVideo._linkValue = contextVideo.preview.textContent = contextVideo.videoUrlFile.value = '';\n    if (contextVideo.videoInputFile && contextVideo.videoUrlFile) {\n      contextVideo.videoUrlFile.removeAttribute('disabled');\n      contextVideo.preview.style.textDecoration = '';\n    }\n    contextVideo._origin_w = this.options.videoWidth;\n    contextVideo._origin_h = this.options.videoHeight;\n    contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"][value=\"none\"]').checked = true;\n    if (contextVideo._resizing) {\n      contextVideo.inputX.value = this.options.videoWidth === contextVideo._defaultSizeX ? '' : this.options.videoWidth;\n      contextVideo.inputY.value = this.options.videoHeight === contextVideo._defaultSizeY ? '' : this.options.videoHeight;\n      contextVideo.proportion.checked = true;\n      contextVideo.proportion.disabled = true;\n      this.plugins.video.setVideoRatioSelect.call(this, contextVideo._defaultRatio);\n    }\n  }\n};","map":{"version":3,"names":["dialog","component","resizing","fileManager","name","display","add","core","addModule","options","context","contextVideo","video","_infoList","_infoIndex","_uploadFileLength","focusElement","sizeUnit","_videoSizeUnit","_align","_floatClassRegExp","_youtubeQuery","youtubeQuery","_videoRatio","videoRatio","_defaultRatio","_linkValue","_element","_cover","_container","inputX","inputY","_element_w","_element_h","_element_l","_element_t","_defaultSizeX","_defaultSizeY","_origin_w","videoWidth","_origin_h","videoHeight","_proportionChecked","_resizing","videoResizing","_resizeDotHide","videoHeightShow","_rotation","videoRotation","_alignHide","videoAlignShow","_onlyPercentage","videoSizeOnlyPercentage","_ratio","_ratioX","_ratioY","_captionShow","video_dialog","setDialog","modal","videoInputFile","querySelector","videoUrlFile","preview","addEventListener","submit","bind","_removeSelectedFiles","_fileInputChange","_onLinkPreview","linkProtocol","proportion","videoRatioOption","value","setInputSize","setRatio","setVideoRatio","sizeRevert","appendChild","option","lang","util","createElement","className","style","html","dialogBox","close","icons","cancel","videoBox","title","videoFileInput","file","videoAccept","videoMultipleFile","controller","remove","videoUrlInput","url","ratioList","videoRatioList","ratio","onlyPercentage","onlyPercentDisplay","heightDisplay","ratioDisplay","videoRatioShow","onlyWidthDisplay","width","height","i","len","length","toString","revertButton","revert","basic","left","center","right","submitButton","innerHTML","removeAttribute","textDecoration","setAttribute","urlInput","protocol","e","target","trim","test","textContent","indexOf","_setTagAttrs","element","attrs","videoTagAttrs","key","hasOwn","createVideoTag","videoTag","plugins","call","_setIframeAttrs","frameBorder","allowFullscreen","videoIframeAttrs","createIframeTag","iframeTag","fileTags","select","onModifyMode","call_controller_resize","destroy","frame","container","dataIndex","getAttribute","focusEl","previousElementSibling","nextElementSibling","emptyDiv","parentNode","removeItem","init","controllersOff","wysiwyg","removeItemAllParents","current","childNodes","focusEdge","deleteInfo","functions","onVideoUpload","history","push","on","update","disabled","setVideoRatioSelect","open","currentControllerName","selectedIndex","placeholder","xy","keyCode","preventDefault","_module_setInputSize","_module_setRatio","videoPlugin","stopPropagation","files","showLoading","submitAction","setup_url","error","closeLoading","Error","message","fileList","fileSize","type","size","limitSize","videoUploadSizeLimit","infoSize","videosInfo","err","onVideoUploadError","noticeOpen","info","inputWidth","inputHeight","align","isUpdate","updateModal","onVideoUploadBefore","result","data","_w","Array","isArray","register","upload","response","videoUploadUrl","filesLen","formData","FormData","append","videoUploadHeader","callBack_videoUpload","xmlHttp","videoUploadHandler","JSON","parse","responseText","errorMessage","create_video","cloneNode","oIframe","DOMParser","parseFromString","src","replace","match","splitUrl","split","endsWith","slice","lastIndexOf","oFrame","_resize_plugin","cover","isYoutube","isVimeo","nodeName","newTag","replaceChild","getParentElement","set_cover","set_container","inputUpdate","_module_getSizeX","_module_getSizeY","changeSize","checked","isPercent","applySize","setAlign","changed","insertComponent","mediaAutoSelect","line","appendFormatTag","setRange","_rotateVertical","setTransformSize","setInfo","selectComponent","_update_videoCover","existElement","isRangeFormatElement","isWysiwygDiv","getFormatElement","prevFrame","figcaption","caption","format","textAlign","float","isNotCheckingNode","isListCell","refer","insertBefore","removeEmptyNode","isFormatElement","splitElement","children","htmlRemoveWhiteSpace","console","warn","isMediaComponent","w","h","t","l","origin","openModify","notOpen","_module_setModifyInputSize","y","ratioSelected","getNumber","ratioOptions","isNumber","selected","checkFileInfo","checkInfo","resetFileInfo","resetInfo","setPercentSize","setAutoSize","setSize","_module_sizeRevert","notResetPercentage","direction","onlyW","onlyH","paddingBottom","_module_saveCurrentSize","setOriginSize","dataSize","resetTransform","cancelPercentAttr","originSize","maxWidth","removeClass","addClass","minWidth","offsetHeight","hasClass"],"sources":["E:/Programming/React/New folder (2)/dynamicArt/dynamic-article/node_modules/suneditor/src/plugins/dialog/video.js"],"sourcesContent":["/*\n * wysiwyg web editor\n *\n * suneditor.js\n * Copyright 2017 JiHong Lee.\n * MIT license.\n */\n'use strict';\n\nimport dialog from '../modules/dialog';\nimport component from '../modules/component';\nimport resizing from '../modules/resizing';\nimport fileManager from '../modules/fileManager';\n\nexport default {\n    name: 'video',\n    display: 'dialog',\n    add: function (core) {\n        core.addModule([dialog, component, resizing, fileManager]);\n\n        const options = core.options;\n        const context = core.context;\n        const contextVideo = context.video = {\n            _infoList: [], // @Override fileManager\n            _infoIndex: 0, // @Override fileManager\n            _uploadFileLength: 0, // @Override fileManager\n            focusElement: null, // @Override dialog // This element has focus when the dialog is opened.\n            sizeUnit: options._videoSizeUnit,\n            _align: 'none',\n            _floatClassRegExp: '__se__float\\\\-[a-z]+',\n            _youtubeQuery: options.youtubeQuery,\n            _videoRatio: (options.videoRatio * 100) + '%',\n            _defaultRatio: (options.videoRatio * 100) + '%',\n            _linkValue: '',\n            // @require @Override component\n            _element: null,\n            _cover: null,\n            _container: null,\n            // @Override resizing properties\n            inputX: null,\n            inputY: null,\n            _element_w: 1,\n            _element_h: 1,\n            _element_l: 0,\n            _element_t: 0,\n            _defaultSizeX: '100%',\n            _defaultSizeY: (options.videoRatio * 100) + '%',\n            _origin_w: options.videoWidth === '100%' ? '' : options.videoWidth,\n            _origin_h: options.videoHeight === '56.25%' ? '' : options.videoHeight,\n            _proportionChecked: true,\n            _resizing: options.videoResizing,\n            _resizeDotHide: !options.videoHeightShow,\n            _rotation: options.videoRotation,\n            _alignHide: !options.videoAlignShow,\n            _onlyPercentage: options.videoSizeOnlyPercentage,\n            _ratio: false,\n            _ratioX: 1,\n            _ratioY: 1,\n            _captionShow: false\n        };\n\n        /** video dialog */\n        let video_dialog = this.setDialog(core);\n        contextVideo.modal = video_dialog;\n        contextVideo.videoInputFile = video_dialog.querySelector('._se_video_file');\n        contextVideo.videoUrlFile = video_dialog.querySelector('.se-input-url');\n        contextVideo.focusElement = contextVideo.videoUrlFile || contextVideo.videoInputFile;\n        contextVideo.preview = video_dialog.querySelector('.se-link-preview');\n\n        /** add event listeners */\n        video_dialog.querySelector('form').addEventListener('submit', this.submit.bind(core));\n        if (contextVideo.videoInputFile) video_dialog.querySelector('.se-dialog-files-edge-button').addEventListener('click', this._removeSelectedFiles.bind(contextVideo.videoInputFile, contextVideo.videoUrlFile, contextVideo.preview));\n        if (contextVideo.videoInputFile && contextVideo.videoUrlFile) contextVideo.videoInputFile.addEventListener('change', this._fileInputChange.bind(contextVideo));\n        if (contextVideo.videoUrlFile) contextVideo.videoUrlFile.addEventListener('input', this._onLinkPreview.bind(contextVideo.preview, contextVideo, options.linkProtocol));\n\n        contextVideo.proportion = {};\n        contextVideo.videoRatioOption = {};\n        contextVideo.inputX = {};\n        contextVideo.inputY = {};\n        if (options.videoResizing) {\n            contextVideo.proportion = video_dialog.querySelector('._se_video_check_proportion');\n            contextVideo.videoRatioOption = video_dialog.querySelector('.se-video-ratio');\n            contextVideo.inputX = video_dialog.querySelector('._se_video_size_x');\n            contextVideo.inputY = video_dialog.querySelector('._se_video_size_y');\n            contextVideo.inputX.value = options.videoWidth;\n            contextVideo.inputY.value = options.videoHeight;\n\n            contextVideo.inputX.addEventListener('keyup', this.setInputSize.bind(core, 'x'));\n            contextVideo.inputY.addEventListener('keyup', this.setInputSize.bind(core, 'y'));\n\n            contextVideo.inputX.addEventListener('change', this.setRatio.bind(core));\n            contextVideo.inputY.addEventListener('change', this.setRatio.bind(core));\n            contextVideo.proportion.addEventListener('change', this.setRatio.bind(core));\n            contextVideo.videoRatioOption.addEventListener('change', this.setVideoRatio.bind(core));\n\n            video_dialog.querySelector('.se-dialog-btn-revert').addEventListener('click', this.sizeRevert.bind(core));\n        }\n\n        /** append html */\n        context.dialog.modal.appendChild(video_dialog);\n\n        /** empty memory */\n        video_dialog = null;\n    },\n\n    /** dialog */\n    setDialog: function (core) {\n        const option = core.options;\n        const lang = core.lang;\n        const dialog = core.util.createElement('DIV');\n\n        dialog.className = 'se-dialog-content';\n        dialog.style.display = 'none';\n        let html = '' +\n            '<form method=\"post\" enctype=\"multipart/form-data\">' +\n                '<div class=\"se-dialog-header\">' +\n                    '<button type=\"button\" data-command=\"close\" class=\"se-btn se-dialog-close\" title=\"' + lang.dialogBox.close + '\" aria-label=\"' + lang.dialogBox.close + '\">' +\n                        core.icons.cancel +\n                    '</button>' +\n                    '<span class=\"se-modal-title\">' + lang.dialogBox.videoBox.title + '</span>' +\n                '</div>' +\n                '<div class=\"se-dialog-body\">';\n\n                if (option.videoFileInput) {\n                    html += '' +\n                        '<div class=\"se-dialog-form\">' +\n                            '<label>' + lang.dialogBox.videoBox.file + '</label>' +\n                            '<div class=\"se-dialog-form-files\">' +\n                                '<input class=\"se-input-form _se_video_file\" type=\"file\" accept=\"' + option.videoAccept + '\"' + (option.videoMultipleFile ? ' multiple=\"multiple\"' : '') + '/>' +\n                                '<button type=\"button\" data-command=\"filesRemove\" class=\"se-btn se-dialog-files-edge-button se-file-remove\" title=\"' + lang.controller.remove + '\" aria-label=\"' + lang.controller.remove + '\">' + core.icons.cancel + '</button>' +\n                            '</div>' +\n                        '</div>' ;\n                }\n    \n                if (option.videoUrlInput) {\n                    html += '' +\n                        '<div class=\"se-dialog-form\">' +\n                            '<label>' + lang.dialogBox.videoBox.url + '</label>' +\n                            '<input class=\"se-input-form se-input-url\" type=\"text\" />' +\n                            '<pre class=\"se-link-preview\"></pre>' +\n                        '</div>';\n                }\n\n            if (option.videoResizing) {\n                const ratioList = option.videoRatioList || [{name: '16:9', value: 0.5625}, {name: '4:3', value: 0.75}, {name: '21:9', value: 0.4285}];\n                const ratio = option.videoRatio;\n                const onlyPercentage = option.videoSizeOnlyPercentage;\n                const onlyPercentDisplay = onlyPercentage ? ' style=\"display: none !important;\"' : '';\n                const heightDisplay = !option.videoHeightShow ? ' style=\"display: none !important;\"' : '';\n                const ratioDisplay = !option.videoRatioShow ? ' style=\"display: none !important;\"' : '';\n                const onlyWidthDisplay = !onlyPercentage && !option.videoHeightShow && !option.videoRatioShow ? ' style=\"display: none !important;\"' : '';\n                html += '' +\n                    '<div class=\"se-dialog-form\">' +\n                        '<div class=\"se-dialog-size-text\">' +\n                            '<label class=\"size-w\">' + lang.dialogBox.width + '</label>' +\n                            '<label class=\"se-dialog-size-x\">&nbsp;</label>' +\n                            '<label class=\"size-h\"' + heightDisplay + '>' + lang.dialogBox.height + '</label>' +\n                            '<label class=\"size-h\"' + ratioDisplay + '>(' + lang.dialogBox.ratio + ')</label>' +\n                        '</div>' +\n                        '<input class=\"se-input-control _se_video_size_x\" placeholder=\"100%\"' + (onlyPercentage ? ' type=\"number\" min=\"1\"' : 'type=\"text\"') + (onlyPercentage ? ' max=\"100\"' : '') + '/>' +\n                        '<label class=\"se-dialog-size-x\"' + onlyWidthDisplay + '>' + (onlyPercentage ? '%' : 'x') + '</label>' +\n                        '<input class=\"se-input-control _se_video_size_y\" placeholder=\"' + (option.videoRatio * 100) + '%\"' + (onlyPercentage ? ' type=\"number\" min=\"1\"' : 'type=\"text\"') + (onlyPercentage ? ' max=\"100\"' : '') + heightDisplay + '/>' +\n                        '<select class=\"se-input-select se-video-ratio\" title=\"' + lang.dialogBox.ratio + '\" aria-label=\"' + lang.dialogBox.ratio + '\"' + ratioDisplay + '>';\n                            if (!heightDisplay) html += '<option value=\"\"> - </option>';\n                            for (let i = 0, len = ratioList.length; i < len; i++) {\n                                html += '<option value=\"' + ratioList[i].value + '\"' + (ratio.toString() === ratioList[i].value.toString() ? ' selected' : '') + '>' + ratioList[i].name + '</option>';\n                            }\n                        html += '</select>' +\n                        '<button type=\"button\" title=\"' + lang.dialogBox.revertButton + '\" aria-label=\"' + lang.dialogBox.revertButton + '\" class=\"se-btn se-dialog-btn-revert\" style=\"float: right;\">' + core.icons.revert + '</button>' +\n                    '</div>' +\n                    '<div class=\"se-dialog-form se-dialog-form-footer\"' + onlyPercentDisplay + onlyWidthDisplay + '>' +\n                        '<label><input type=\"checkbox\" class=\"se-dialog-btn-check _se_video_check_proportion\" checked/>&nbsp;' + lang.dialogBox.proportion + '</label>' +\n                    '</div>';\n            }\n\n            html += '' +\n                '</div>' +\n                '<div class=\"se-dialog-footer\">' +\n                    '<div' + (option.videoAlignShow ? '' : ' style=\"display: none\"') + '>' +\n                        '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"none\" checked>' + lang.dialogBox.basic + '</label>' +\n                        '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"left\">' + lang.dialogBox.left + '</label>' +\n                        '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"center\">' + lang.dialogBox.center + '</label>' +\n                        '<label><input type=\"radio\" name=\"suneditor_video_radio\" class=\"se-dialog-btn-radio\" value=\"right\">' + lang.dialogBox.right + '</label>' +\n                    '</div>' +\n                    '<button type=\"submit\" class=\"se-btn-primary\" title=\"' + lang.dialogBox.submitButton + '\" aria-label=\"' + lang.dialogBox.submitButton + '\"><span>' + lang.dialogBox.submitButton + '</span></button>' +\n                '</div>' +\n            '</form>';\n\n        dialog.innerHTML = html;\n\n        return dialog;\n    },\n\n    _fileInputChange: function () {\n        if (!this.videoInputFile.value) {\n            this.videoUrlFile.removeAttribute('disabled');\n            this.preview.style.textDecoration = '';\n        } else {\n            this.videoUrlFile.setAttribute('disabled', true);\n            this.preview.style.textDecoration = 'line-through';\n        }\n    },\n\n    _removeSelectedFiles: function (urlInput, preview) {\n        this.value = '';\n        if (urlInput) {\n            urlInput.removeAttribute('disabled');\n            preview.style.textDecoration = '';\n        }\n    },\n\n    _onLinkPreview: function (context, protocol, e) {\n        const value = e.target.value.trim();\n        if (/^<iframe.*\\/iframe>$/.test(value)) {\n            context._linkValue = value;\n            this.textContent = '<IFrame :src=\"..\"></IFrame>';\n        } else {\n            context._linkValue = this.textContent = !value ? '' : (protocol && value.indexOf('://') === -1 && value.indexOf('#') !== 0) ? protocol + value : value.indexOf('://') === -1 ? '/' + value : value;\n        }\n    },\n\n    _setTagAttrs: function (element) {\n        element.setAttribute('controls', true);\n\n        const attrs = this.options.videoTagAttrs;\n        if (!attrs) return;\n\n        for (let key in attrs) {\n            if (!this.util.hasOwn(attrs, key)) continue;\n            element.setAttribute(key, attrs[key]);\n        }\n    },\n\n    createVideoTag: function () {\n        const videoTag = this.util.createElement('VIDEO');\n        this.plugins.video._setTagAttrs.call(this, videoTag);\n        return videoTag;\n    },\n\n    _setIframeAttrs: function (element) {\n        element.frameBorder = '0';\n        element.allowFullscreen = true;\n\n        const attrs = this.options.videoIframeAttrs;\n        if (!attrs) return;\n\n        for (let key in attrs) {\n            if (!this.util.hasOwn(attrs, key)) continue;\n            element.setAttribute(key, attrs[key]);\n        }\n    },\n\n    createIframeTag: function () {\n        const iframeTag = this.util.createElement('IFRAME');\n        this.plugins.video._setIframeAttrs.call(this, iframeTag);\n        return iframeTag;\n    },\n\n    /**\n     * @Override @Required fileManager\n     */\n    fileTags: ['iframe', 'video'],\n\n    /**\n     * @Override core, resizing, fileManager\n     * @description It is called from core.selectComponent.\n     * @param {Element} element Target element\n     */\n    select: function (element) {\n        this.plugins.video.onModifyMode.call(this, element, this.plugins.resizing.call_controller_resize.call(this, element, 'video'));\n    },\n\n    /**\n     * @Override fileManager, resizing\n     */\n    destroy: function (element) {\n        const frame = element || this.context.video._element;\n        const container = this.context.video._container;\n        const dataIndex = frame.getAttribute('data-index') * 1;\n        let focusEl = (container.previousElementSibling || container.nextElementSibling);\n\n        const emptyDiv = container.parentNode;\n        this.util.removeItem(container);\n        this.plugins.video.init.call(this);\n        this.controllersOff();\n\n        if (emptyDiv !== this.context.element.wysiwyg) this.util.removeItemAllParents(emptyDiv, function (current) { return current.childNodes.length === 0; }, null);\n\n        // focus\n        this.focusEdge(focusEl);\n\n        // event\n        this.plugins.fileManager.deleteInfo.call(this, 'video', dataIndex, this.functions.onVideoUpload);\n\n        // history stack\n        this.history.push(false);\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    on: function (update) {\n        const contextVideo = this.context.video;\n\n        if (!update) {\n            contextVideo.inputX.value = contextVideo._origin_w = this.options.videoWidth === contextVideo._defaultSizeX ? '' : this.options.videoWidth;\n            contextVideo.inputY.value = contextVideo._origin_h = this.options.videoHeight === contextVideo._defaultSizeY ? '' : this.options.videoHeight;\n            contextVideo.proportion.disabled = true;\n            if (contextVideo.videoInputFile && this.options.videoMultipleFile) contextVideo.videoInputFile.setAttribute('multiple', 'multiple');\n        } else {\n            if (contextVideo.videoInputFile && this.options.videoMultipleFile) contextVideo.videoInputFile.removeAttribute('multiple');\n        }\n\n        if (contextVideo._resizing) {\n            this.plugins.video.setVideoRatioSelect.call(this, contextVideo._origin_h || contextVideo._defaultRatio);\n        }\n    },\n\n    /**\n     * @Required @Override dialog\n     */\n    open: function () {\n        this.plugins.dialog.open.call(this, 'video', 'video' === this.currentControllerName);\n    },\n    \n    setVideoRatio: function (e) {\n        const contextVideo = this.context.video;\n        const value = e.target.options[e.target.selectedIndex].value;\n\n        contextVideo._defaultSizeY = contextVideo._videoRatio = !value ? contextVideo._defaultSizeY : (value * 100) + '%';\n        contextVideo.inputY.placeholder = !value ? '' : (value * 100) + '%';\n        contextVideo.inputY.value = '';\n    },\n\n    /**\n     * @Override resizing\n     * @param {String} xy 'x': width, 'y': height\n     * @param {KeyboardEvent} e Event object\n     */\n    setInputSize: function (xy, e) {\n        if (e && e.keyCode === 32) {\n            e.preventDefault();\n            return;\n        }\n\n        const contextVideo = this.context.video;\n        this.plugins.resizing._module_setInputSize.call(this, contextVideo, xy);\n\n        if (xy === 'y') {\n            this.plugins.video.setVideoRatioSelect.call(this, e.target.value || contextVideo._defaultRatio);\n        }\n    },\n\n    /**\n     * @Override resizing\n     */\n    setRatio: function () {\n        this.plugins.resizing._module_setRatio.call(this, this.context.video);\n    },\n\n    submit: function (e) {\n        const contextVideo = this.context.video;\n        const videoPlugin = this.plugins.video;\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        contextVideo._align = contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"]:checked').value;\n\n        try {\n            if (contextVideo.videoInputFile && contextVideo.videoInputFile.files.length > 0) {\n                this.showLoading();\n                videoPlugin.submitAction.call(this, this.context.video.videoInputFile.files);\n            } else if (contextVideo.videoUrlFile && contextVideo._linkValue.length > 0) {\n                this.showLoading();\n                videoPlugin.setup_url.call(this, contextVideo._linkValue);\n            }\n        } catch (error) {\n            this.closeLoading();\n            throw Error('[SUNEDITOR.video.submit.fail] cause : \"' + error.message + '\"');\n        } finally {\n            this.plugins.dialog.close.call(this);\n        }\n\n        return false;\n    },\n\n    submitAction: function (fileList) {\n        if (fileList.length === 0) return;\n\n        let fileSize = 0;\n        let files = [];\n        for (let i = 0, len = fileList.length; i < len; i++) {\n            if (/video/i.test(fileList[i].type)) {\n                files.push(fileList[i]);\n                fileSize += fileList[i].size;\n            }\n        }\n\n        const limitSize = this.options.videoUploadSizeLimit;\n        if (limitSize > 0) {\n            let infoSize = 0;\n            const videosInfo = this.context.video._infoList;\n            for (let i = 0, len = videosInfo.length; i < len; i++) {\n                infoSize += videosInfo[i].size * 1;\n            }\n\n            if ((fileSize + infoSize) > limitSize) {\n                this.closeLoading();\n                const err = '[SUNEDITOR.videoUpload.fail] Size of uploadable total videos: ' + (limitSize/1000) + 'KB';\n                if (typeof this.functions.onVideoUploadError !== 'function' || this.functions.onVideoUploadError(err, { 'limitSize': limitSize, 'currentSize': infoSize, 'uploadSize': fileSize }, this)) {\n                    this.functions.noticeOpen(err);\n                }\n                return;\n            }\n        }\n\n        const contextVideo = this.context.video;\n        contextVideo._uploadFileLength = files.length;\n\n        const info = {\n            inputWidth: contextVideo.inputX.value,\n            inputHeight: contextVideo.inputY.value,\n            align: contextVideo._align,\n            isUpdate: this.context.dialog.updateModal,\n            element: contextVideo._element\n        };\n\n        if (typeof this.functions.onVideoUploadBefore === 'function') {\n            const result = this.functions.onVideoUploadBefore(files, info, this, function (data) {\n                if (data && this._w.Array.isArray(data.result)) {\n                    this.plugins.video.register.call(this, info, data);\n                } else {\n                    this.plugins.video.upload.call(this, info, data);\n                }\n            }.bind(this));\n\n            if (typeof result === 'undefined') return;\n            if (!result) {\n                this.closeLoading();\n                return;\n            }\n            if (typeof result === 'object' && result.length > 0) files = result;\n        }\n\n        this.plugins.video.upload.call(this, info, files);\n    },\n\n    error: function (message, response) {\n        this.closeLoading();\n        if (typeof this.functions.onVideoUploadError !== 'function' || this.functions.onVideoUploadError(message, response, this)) {\n            this.functions.noticeOpen(message);\n            throw Error('[SUNEDITOR.plugin.video.error] response: ' + message);\n        }\n    },\n\n    upload: function (info, files) {\n        if (!files) {\n            this.closeLoading();\n            return;\n        }\n        if (typeof files === 'string') {\n            this.plugins.video.error.call(this, files, null);\n            return;\n        }\n\n        const videoUploadUrl = this.options.videoUploadUrl;\n        const filesLen = this.context.dialog.updateModal ? 1 : files.length;\n\n        // server upload\n        if (typeof videoUploadUrl === 'string' && videoUploadUrl.length > 0) {\n            const formData = new FormData();\n            for (let i = 0; i < filesLen; i++) {\n                formData.append('file-' + i, files[i]);\n            }\n            this.plugins.fileManager.upload.call(this, videoUploadUrl, this.options.videoUploadHeader, formData, this.plugins.video.callBack_videoUpload.bind(this, info), this.functions.onVideoUploadError);\n        } else {\n            throw Error('[SUNEDITOR.videoUpload.fail] cause : There is no \"videoUploadUrl\" option.');\n        }\n    },\n\n    callBack_videoUpload: function (info, xmlHttp) {\n        if (typeof this.functions.videoUploadHandler === 'function') {\n            this.functions.videoUploadHandler(xmlHttp, info, this);\n        } else {\n            const response = JSON.parse(xmlHttp.responseText);\n            if (response.errorMessage) {\n                this.plugins.video.error.call(this, response.errorMessage, response);\n            } else {\n                this.plugins.video.register.call(this, info, response);\n            }\n        }\n    },\n\n    register: function (info, response) {\n        const fileList = response.result;\n        const videoTag = this.plugins.video.createVideoTag.call(this);\n\n        for (let i = 0, len = fileList.length, file; i < len; i++) {\n            file = { name: fileList[i].name, size: fileList[i].size };\n            this.plugins.video.create_video.call(this, (info.isUpdate ? info.element : videoTag.cloneNode(false)), fileList[i].url, info.inputWidth, info.inputHeight, info.align, file, info.isUpdate);\n        }\n\n        this.closeLoading();\n    },\n\n    setup_url: function (url) {\n        try {\n            const contextVideo = this.context.video;\n            if (!url) url = contextVideo._linkValue;\n            if (!url) return false;\n\n            /** iframe source */\n            if (/^<iframe.*\\/iframe>$/.test(url)) {\n                const oIframe = (new this._w.DOMParser()).parseFromString(url, 'text/html').querySelector('iframe');\n                url = oIframe.src;\n                if (url.length === 0) return false;\n            }\n            \n            /** youtube */\n            if (/youtu\\.?be/.test(url)) {\n                if (!/^http/.test(url)) url = 'https://' + url;\n                url = url.replace('watch?v=', '');\n                if (!/^\\/\\/.+\\/embed\\//.test(url)) {\n                    url = url.replace(url.match(/\\/\\/.+\\//)[0], '//www.youtube.com/embed/').replace('&', '?&');\n                }\n\n                if (contextVideo._youtubeQuery.length > 0) {\n                    if (/\\?/.test(url)) {\n                        const splitUrl = url.split('?');\n                        url = splitUrl[0] + '?' + contextVideo._youtubeQuery + '&' + splitUrl[1];\n                    } else {\n                        url += '?' + contextVideo._youtubeQuery;\n                    }\n                }\n            } else if (/vimeo\\.com/.test(url)) {\n                if (url.endsWith('/')) {\n                    url = url.slice(0, -1);\n                }\n                url = 'https://player.vimeo.com/video/' + url.slice(url.lastIndexOf('/') + 1);\n            }\n\n            this.plugins.video.create_video.call(this, this.plugins.video[(!/embed|iframe|player|\\/e\\/|\\.php|\\.html?/.test(url) && !/vimeo\\.com/.test(url) ? \"createVideoTag\" : \"createIframeTag\")].call(this), url, contextVideo.inputX.value, contextVideo.inputY.value, contextVideo._align, null, this.context.dialog.updateModal);\n        } catch (error) {\n            throw Error('[SUNEDITOR.video.upload.fail] cause : \"' + error.message + '\"');\n        } finally {\n            this.closeLoading();\n        }\n    },\n\n    create_video: function (oFrame, src, width, height, align, file, isUpdate) {\n        this.context.resizing._resize_plugin = 'video';\n        const contextVideo = this.context.video;\n        \n        let cover = null;\n        let container = null;\n        let init = false;\n\n        /** update */\n        if (isUpdate) {\n            oFrame = contextVideo._element;\n            if (oFrame.src !== src) {\n                init = true;\n                const isYoutube = /youtu\\.?be/.test(src);\n                const isVimeo = /vimeo\\.com/.test(src);\n                if ((isYoutube || isVimeo) && !/^iframe$/i.test(oFrame.nodeName)) {\n                    const newTag = this.plugins.video.createIframeTag.call(this);\n                    newTag.src = src;\n                    oFrame.parentNode.replaceChild(newTag, oFrame);\n                    contextVideo._element = oFrame = newTag;\n                } else if (!isYoutube && !isVimeo && !/^videoo$/i.test(oFrame.nodeName)) {\n                    const newTag = this.plugins.video.createVideoTag.call(this);\n                    newTag.src = src;\n                    oFrame.parentNode.replaceChild(newTag, oFrame);\n                    contextVideo._element = oFrame = newTag;\n                } else {\n                    oFrame.src = src;\n                }\n            }\n            container = contextVideo._container;\n            cover = this.util.getParentElement(oFrame, 'FIGURE');\n        }\n        /** create */\n        else {\n            init = true;\n            oFrame.src = src;\n            contextVideo._element = oFrame;\n            cover = this.plugins.component.set_cover.call(this, oFrame);\n            container = this.plugins.component.set_container.call(this, cover, 'se-video-container');\n        }\n\n        /** rendering */\n        contextVideo._cover = cover;\n        contextVideo._container = container;\n\n        const inputUpdate = (this.plugins.resizing._module_getSizeX.call(this, contextVideo) !== (width || contextVideo._defaultSizeX)) || (this.plugins.resizing._module_getSizeY.call(this, contextVideo) !== (height || contextVideo._videoRatio));\n        const changeSize = !isUpdate || inputUpdate;\n\n        if (contextVideo._resizing) {\n            this.context.video._proportionChecked = contextVideo.proportion.checked;\n            oFrame.setAttribute('data-proportion', contextVideo._proportionChecked);\n        }\n\n        // size\n        let isPercent = false;\n        if (changeSize) {\n            isPercent = this.plugins.video.applySize.call(this);\n        }\n\n        // align\n        if (!(isPercent && align === 'center')) {\n            this.plugins.video.setAlign.call(this, null, oFrame, cover, container);\n        }\n\n        let changed = true;\n        if (!isUpdate) {\n            changed = this.insertComponent(container, false, true, !this.options.mediaAutoSelect);\n            if (!this.options.mediaAutoSelect) {\n                const line = this.appendFormatTag(container, null);\n                if (line) this.setRange(line, 0, line, 0);\n            }\n        } else if (contextVideo._resizing && this.context.resizing._rotateVertical && changeSize) {\n            this.plugins.resizing.setTransformSize.call(this, oFrame, null, null);\n        }\n\n        if (changed) {\n            if (init) {\n                this.plugins.fileManager.setInfo.call(this, 'video', oFrame, this.functions.onVideoUpload, file, true);\n            }\n            if (isUpdate) {\n                this.selectComponent(oFrame, 'video');\n                // history stack\n                this.history.push(false);\n            }\n        }\n\n        this.context.resizing._resize_plugin = '';\n    },\n\n    _update_videoCover: function (oFrame) {\n        if (!oFrame) return;\n\n        const contextVideo = this.context.video;\n        \n        if (/^video$/i.test(oFrame.nodeName)) this.plugins.video._setTagAttrs.call(this, oFrame);\n        else this.plugins.video._setIframeAttrs.call(this, oFrame);\n        \n        let existElement = (this.util.isRangeFormatElement(oFrame.parentNode) || this.util.isWysiwygDiv(oFrame.parentNode)) ? \n            oFrame : this.util.getFormatElement(oFrame) || oFrame;\n\n        const prevFrame = oFrame;\n        contextVideo._element = oFrame = oFrame.cloneNode(true);\n        const cover = contextVideo._cover = this.plugins.component.set_cover.call(this, oFrame);\n        const container = contextVideo._container = this.plugins.component.set_container.call(this, cover, 'se-video-container');\n\n        try {\n            const figcaption = existElement.querySelector('figcaption');\n            let caption = null;\n            if (!!figcaption) {\n                caption = this.util.createElement('DIV');\n                caption.innerHTML = figcaption.innerHTML;\n                this.util.removeItem(figcaption);\n            }\n\n            // size\n            const size = (oFrame.getAttribute('data-size') || oFrame.getAttribute('data-origin') || '').split(',');\n            this.plugins.video.applySize.call(this, (size[0] || prevFrame.style.width || prevFrame.width || ''), (size[1] || prevFrame.style.height || prevFrame.height || ''));\n\n            // align\n            const format = this.util.getFormatElement(prevFrame);\n            if (format) contextVideo._align = format.style.textAlign || format.style.float;\n            this.plugins.video.setAlign.call(this, null, oFrame, cover, container);\n\n            if (this.util.getParentElement(prevFrame, this.util.isNotCheckingNode)) {\n                prevFrame.parentNode.replaceChild(container, prevFrame);\n            } else if (this.util.isListCell(existElement)) {\n                const refer = this.util.getParentElement(prevFrame, function (current) { return current.parentNode === existElement; });\n                existElement.insertBefore(container, refer);\n                this.util.removeItem(prevFrame);\n                this.util.removeEmptyNode(refer, null, true);\n            } else if (this.util.isFormatElement(existElement)) {\n                const refer = this.util.getParentElement(prevFrame, function (current) { return current.parentNode === existElement; });\n                existElement = this.util.splitElement(existElement, refer);\n                existElement.parentNode.insertBefore(container, existElement);\n                this.util.removeItem(prevFrame);\n                this.util.removeEmptyNode(existElement, null, true);\n                if (existElement.children.length === 0) existElement.innerHTML = this.util.htmlRemoveWhiteSpace(existElement.innerHTML);\n            } else {\n                existElement.parentNode.replaceChild(container, existElement);\n            }\n\n            if (!!caption) existElement.parentNode.insertBefore(caption, container.nextElementSibling);\n        } catch (error) {\n            console.warn('[SUNEDITOR.video.error] Maybe the video tag is nested.', error);\n        }\n\n        this.plugins.fileManager.setInfo.call(this, 'video', oFrame, this.functions.onVideoUpload, null, true);\n        this.plugins.video.init.call(this);\n    },\n\n    /**\n     * @Required @Override fileManager, resizing\n     */\n    onModifyMode: function (element, size) {\n        const contextVideo = this.context.video;\n        contextVideo._element = element;\n        contextVideo._cover = this.util.getParentElement(element, 'FIGURE');\n        contextVideo._container = this.util.getParentElement(element, this.util.isMediaComponent);\n        contextVideo._align = element.style.float || element.getAttribute('data-align') || 'none';\n        element.style.float = '';\n\n        if (size) {\n            contextVideo._element_w = size.w;\n            contextVideo._element_h = size.h;\n            contextVideo._element_t = size.t;\n            contextVideo._element_l = size.l;\n        }\n\n        let origin = contextVideo._element.getAttribute('data-size') || contextVideo._element.getAttribute('data-origin');\n        let w, h;\n        if (origin) {\n            origin = origin.split(',');\n            w = origin[0];\n            h = origin[1];\n        } else if (size) {\n            w = size.w;\n            h = size.h;\n        }\n\n        contextVideo._origin_w = w || element.style.width || element.width || '';\n        contextVideo._origin_h = h || element.style.height || element.height || '';\n    },\n\n    /**\n     * @Required @Override fileManager, resizing\n     */\n    openModify: function (notOpen) {\n        const contextVideo = this.context.video;\n\n        if (contextVideo.videoUrlFile) contextVideo._linkValue = contextVideo.preview.textContent = contextVideo.videoUrlFile.value = (contextVideo._element.src || (contextVideo._element.querySelector('source') || '').src || '');\n        (contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"][value=\"' + contextVideo._align + '\"]') || contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"][value=\"none\"]')).checked = true;\n\n        if (contextVideo._resizing) {\n            this.plugins.resizing._module_setModifyInputSize.call(this, contextVideo, this.plugins.video);\n            \n            const y = contextVideo._videoRatio = this.plugins.resizing._module_getSizeY.call(this, contextVideo);\n            const ratioSelected = this.plugins.video.setVideoRatioSelect.call(this, y);\n            if (!ratioSelected) contextVideo.inputY.value = contextVideo._onlyPercentage ? this.util.getNumber(y, 2) : y;\n        }\n\n        if (!notOpen) this.plugins.dialog.open.call(this, 'video', true);\n    },\n    \n    setVideoRatioSelect: function (value) {\n        let ratioSelected = false;\n        const contextVideo = this.context.video;\n        const ratioOptions = contextVideo.videoRatioOption.options;\n\n        if (/%$/.test(value) || contextVideo._onlyPercentage) value = (this.util.getNumber(value, 2) / 100) + '';\n        else if (!this.util.isNumber(value) || (value * 1) >= 1) value = '';\n\n        contextVideo.inputY.placeholder = '';\n        for (let i = 0, len = ratioOptions.length; i < len; i++) {\n            if (ratioOptions[i].value === value) {\n                ratioSelected = ratioOptions[i].selected = true;\n                contextVideo.inputY.placeholder = !value ? '' : (value * 100) + '%';\n            }\n            else ratioOptions[i].selected = false;\n        }\n\n        return ratioSelected;\n    },\n\n    /**\n     * @Override fileManager\n     */\n    checkFileInfo: function () {\n        this.plugins.fileManager.checkInfo.call(this, 'video', ['iframe', 'video'], this.functions.onVideoUpload, this.plugins.video._update_videoCover.bind(this), true);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    resetFileInfo: function () {\n        this.plugins.fileManager.resetInfo.call(this, 'video', this.functions.onVideoUpload);\n    },\n\n    /**\n     * @Override fileManager\n     */\n    applySize: function (w, h) {\n        const contextVideo = this.context.video;\n\n        if (!w) w = contextVideo.inputX.value || this.options.videoWidth;\n        if (!h) h = contextVideo.inputY.value || this.options.videoHeight;\n        \n        if (contextVideo._onlyPercentage || /%$/.test(w) || !w) {\n            this.plugins.video.setPercentSize.call(this, (w || '100%'), (h || (/%$/.test(contextVideo._videoRatio) ? contextVideo._videoRatio : contextVideo._defaultRatio)));\n            return true;\n        } else if ((!w || w === 'auto') && (!h || h === 'auto')) {\n            this.plugins.video.setAutoSize.call(this);\n        } else {\n            this.plugins.video.setSize.call(this, w, (h || contextVideo._videoRatio || contextVideo._defaultRatio), false);\n        }\n\n        return false;\n    },\n\n    /**\n     * @Override resizing\n     */\n    sizeRevert: function () {\n        this.plugins.resizing._module_sizeRevert.call(this, this.context.video);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setSize: function (w, h, notResetPercentage, direction) {\n        const contextVideo = this.context.video;\n        const onlyW = /^(rw|lw)$/.test(direction);\n        const onlyH = /^(th|bh)$/.test(direction);\n\n        if (!onlyH) w = this.util.getNumber(w, 0);\n        if (!onlyW) h = this.util.isNumber(h) ? h + contextVideo.sizeUnit : !h ? '' : h;\n        w = w ? w + contextVideo.sizeUnit : '';\n\n        if (!onlyH) contextVideo._element.style.width = w;\n        if (!onlyW) contextVideo._cover.style.paddingBottom = contextVideo._cover.style.height = h;\n\n        if (!onlyH && !/%$/.test(w)) {\n            contextVideo._cover.style.width = w;\n            contextVideo._container.style.width = '';\n        }\n\n        if (!onlyW && !/%$/.test(h)) {\n            contextVideo._element.style.height = h;\n        } else {\n            contextVideo._element.style.height = '';\n        }\n\n        if (!notResetPercentage) contextVideo._element.removeAttribute('data-percentage');\n\n        // save current size\n        this.plugins.resizing._module_saveCurrentSize.call(this, contextVideo);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setAutoSize: function () {\n        this.plugins.video.setPercentSize.call(this, 100, this.context.video._defaultRatio);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setOriginSize: function (dataSize) {\n        const contextVideo = this.context.video;\n        contextVideo._element.removeAttribute('data-percentage');\n\n        this.plugins.resizing.resetTransform.call(this, contextVideo._element);\n        this.plugins.video.cancelPercentAttr.call(this);\n\n        const originSize = ((dataSize ? contextVideo._element.getAttribute('data-size') : '') || contextVideo._element.getAttribute('data-origin') || '').split(',');\n        \n        if (originSize) {\n            const w = originSize[0];\n            const h = originSize[1];\n\n            if (contextVideo._onlyPercentage || (/%$/.test(w) && (/%$/.test(h) || !/\\d/.test(h)))) {\n                this.plugins.video.setPercentSize.call(this, w, h);\n            } else {\n                this.plugins.video.setSize.call(this, w, h);\n            }\n\n            // save current size\n            this.plugins.resizing._module_saveCurrentSize.call(this, contextVideo);\n        }\n    },\n\n    /**\n     * @Override resizing\n     */\n    setPercentSize: function (w, h) {\n        const contextVideo = this.context.video;\n        h = !!h && !/%$/.test(h) && !this.util.getNumber(h, 0) ? this.util.isNumber(h) ? h + '%' : h : this.util.isNumber(h) ? h + contextVideo.sizeUnit : (h || contextVideo._defaultRatio);\n\n        contextVideo._container.style.width = this.util.isNumber(w) ? w + '%' : w;\n        contextVideo._container.style.height = '';\n        contextVideo._cover.style.width = '100%';\n        contextVideo._cover.style.height = h;\n        contextVideo._cover.style.paddingBottom = h;\n        contextVideo._element.style.width = '100%';\n        contextVideo._element.style.height = '100%';\n        contextVideo._element.style.maxWidth = '';\n\n        if (contextVideo._align === 'center') this.plugins.video.setAlign.call(this, null, null, null, null);\n        contextVideo._element.setAttribute('data-percentage', w + ',' + h);\n\n        // save current size\n        this.plugins.resizing._module_saveCurrentSize.call(this, contextVideo);\n    },\n\n    /**\n     * @Override resizing\n     */\n    cancelPercentAttr: function () {\n        const contextVideo = this.context.video;\n        \n        contextVideo._cover.style.width = '';\n        contextVideo._cover.style.height = '';\n        contextVideo._cover.style.paddingBottom = '';\n        contextVideo._container.style.width = '';\n        contextVideo._container.style.height = '';\n\n        this.util.removeClass(contextVideo._container, this.context.video._floatClassRegExp);\n        this.util.addClass(contextVideo._container, '__se__float-' + contextVideo._align);\n\n        if (contextVideo._align === 'center') this.plugins.video.setAlign.call(this, null, null, null, null);\n    },\n\n    /**\n     * @Override resizing\n     */\n    setAlign: function (align, element, cover, container) {\n        const contextVideo = this.context.video;\n        \n        if (!align) align = contextVideo._align;\n        if (!element) element = contextVideo._element;\n        if (!cover) cover = contextVideo._cover;\n        if (!container) container = contextVideo._container;\n\n        if (/%$/.test(element.style.width) && align === 'center') {\n            container.style.minWidth = '100%';\n            cover.style.width = container.style.width;\n            cover.style.height = cover.style.height;\n            cover.style.paddingBottom = !/%$/.test(cover.style.height) ? cover.style.height : this.util.getNumber((this.util.getNumber(cover.style.height, 2) / 100) * this.util.getNumber(cover.style.width, 2), 2) + '%';\n        } else {\n            container.style.minWidth = '';\n            cover.style.width = this.context.resizing._rotateVertical ? (element.style.height || element.offsetHeight) : (element.style.width || '100%');\n            cover.style.paddingBottom = cover.style.height;\n        }\n\n        if (!this.util.hasClass(container, '__se__float-' + align)) {\n            this.util.removeClass(container, contextVideo._floatClassRegExp);\n            this.util.addClass(container, '__se__float-' + align);\n        }\n        \n        element.setAttribute('data-align', align);\n    },\n\n    /**\n     * @Override dialog\n     */\n    init: function () {\n        const contextVideo = this.context.video;\n        if (contextVideo.videoInputFile) contextVideo.videoInputFile.value = '';\n        if (contextVideo.videoUrlFile) contextVideo._linkValue = contextVideo.preview.textContent = contextVideo.videoUrlFile.value = '';\n        if (contextVideo.videoInputFile && contextVideo.videoUrlFile) {\n            contextVideo.videoUrlFile.removeAttribute('disabled');\n            contextVideo.preview.style.textDecoration = '';\n        }\n\n        contextVideo._origin_w = this.options.videoWidth;\n        contextVideo._origin_h = this.options.videoHeight;\n        contextVideo.modal.querySelector('input[name=\"suneditor_video_radio\"][value=\"none\"]').checked = true;\n        \n        if (contextVideo._resizing) {\n            contextVideo.inputX.value = this.options.videoWidth === contextVideo._defaultSizeX ? '' : this.options.videoWidth;\n            contextVideo.inputY.value = this.options.videoHeight === contextVideo._defaultSizeY ? '' : this.options.videoHeight;\n            contextVideo.proportion.checked = true;\n            contextVideo.proportion.disabled = true;\n            this.plugins.video.setVideoRatioSelect.call(this, contextVideo._defaultRatio);\n        }\n    }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}